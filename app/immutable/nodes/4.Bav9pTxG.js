import{s as he,n as Z,d as me,o as pe,f as ge,r as ve}from"../chunks/scheduler.BoReh3vH.js";import{S as ue,i as _e,e as b,s as E,t as D,c as x,a as A,y as V,f as z,b as N,d as w,o as C,g as T,h as p,j as Q,B as W,A as O,n as j,l as F,m as ke,k as $,u as ye,v as Ie,w as we,x as be,q as xe}from"../chunks/index.BklZDJd0.js";import{e as q}from"../chunks/each.D6YF6ztN.js";import{r as J,s as M}from"../chunks/relics.CGlwEWe2.js";import{i as ee,a as te}from"../chunks/store.Cn0GNUQE.js";import{b as Se}from"../chunks/paths.HxaVfqLJ.js";const K=[{id:1,rocks:[{x:1,y:1},{x:3,y:3},{x:0,y:3}],exits:[{x:0,y:0,destGridId:2,spawn:{x:4,y:4}},{x:4,y:2,destGridId:2,spawn:{x:0,y:2}},{x:2,y:4,destGridId:2,spawn:{x:2,y:0}}]},{id:2,rocks:[{x:1,y:3},{x:4,y:1}],exits:[{x:0,y:4,destGridId:1,spawn:{x:4,y:0}},{x:4,y:0,destGridId:1,spawn:{x:0,y:4}},{x:2,y:0,destGridId:1,spawn:{x:2,y:4}}]}];function le(i,e,l){const t=i.slice();return t[6]=e[l],t}function se(i){let e;return{c(){e=D("Active")},l(l){e=N(l,"Active")},m(l,t){T(l,e,t)},d(l){l&&w(e)}}}function ie(i){let e,l="Buy",t,s;function a(){return i[5](i[6])}return{c(){e=b("button"),e.textContent=l,this.h()},l(n){e=x(n,"BUTTON",{class:!0,"data-svelte-h":!0}),V(e)!=="svelte-yl076z"&&(e.textContent=l),this.h()},h(){C(e,"class","svelte-7eusns")},m(n,_){T(n,e,_),t||(s=O(e,"click",a),t=!0)},p(n,_){i=n},d(n){n&&w(e),t=!1,s()}}}function ne(i){let e,l,t,s,a,n=i[6].name+"",_,S,h,u,c,f=i[6].description+"",o,g,R,G,B=i[6].price+"",P,k,m,I,r=i[6].id===i[1].id&&se(),v=i[6].id!==i[1].id&&ie(i);return{c(){e=b("div"),l=b("img"),s=E(),a=b("h3"),_=D(n),S=E(),h=b("p"),r&&r.c(),u=E(),c=b("p"),o=D(f),g=E(),R=b("p"),G=D("Price: "),P=D(B),k=D(" drachmas"),m=E(),v&&v.c(),I=E(),this.h()},l(d){e=x(d,"DIV",{class:!0});var y=A(e);l=x(y,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),s=z(y),a=x(y,"H3",{});var U=A(a);_=N(U,n),U.forEach(w),S=z(y),h=x(y,"P",{class:!0});var X=A(h);r&&r.l(X),X.forEach(w),u=z(y),c=x(y,"P",{});var Y=A(c);o=N(Y,f),Y.forEach(w),g=z(y),R=x(y,"P",{});var H=A(R);G=N(H,"Price: "),P=N(H,B),k=N(H," drachmas"),H.forEach(w),m=z(y),v&&v.l(y),I=z(y),y.forEach(w),this.h()},h(){me(l.src,t=Se+"/"+i[6].img)||C(l,"src",t),C(l,"width","46px"),C(l,"height","46px"),C(l,"alt",i[6].name),C(l,"class","svelte-7eusns"),C(h,"class","active"),C(e,"class","menu-item svelte-7eusns")},m(d,y){T(d,e,y),p(e,l),p(e,s),p(e,a),p(a,_),p(e,S),p(e,h),r&&r.m(h,null),p(e,u),p(e,c),p(c,o),p(e,g),p(e,R),p(R,G),p(R,P),p(R,k),p(e,m),v&&v.m(e,null),p(e,I)},p(d,y){d[6].id===d[1].id?r||(r=se(),r.c(),r.m(h,null)):r&&(r.d(1),r=null),d[6].id!==d[1].id?v?v.p(d,y):(v=ie(d),v.c(),v.m(e,I)):v&&(v.d(1),v=null)},d(d){d&&w(e),r&&r.d(),v&&v.d()}}}function Ce(i){let e,l,t="Relic Store",s,a,n,_,S,h,u=q(i[2]),c=[];for(let f=0;f<u.length;f+=1)c[f]=ne(le(i,u,f));return{c(){e=b("div"),l=b("h2"),l.textContent=t,s=E(),a=b("p"),n=D("Drachmas: "),_=D(i[0]),S=E(),h=b("div");for(let f=0;f<c.length;f+=1)c[f].c();this.h()},l(f){e=x(f,"DIV",{class:!0});var o=A(e);l=x(o,"H2",{"data-svelte-h":!0}),V(l)!=="svelte-6gh0hs"&&(l.textContent=t),s=z(o),a=x(o,"P",{});var g=A(a);n=N(g,"Drachmas: "),_=N(g,i[0]),g.forEach(w),S=z(o),h=x(o,"DIV",{});var R=A(h);for(let G=0;G<c.length;G+=1)c[G].l(R);R.forEach(w),o.forEach(w),this.h()},h(){C(e,"class","menu svelte-7eusns")},m(f,o){T(f,e,o),p(e,l),p(e,s),p(e,a),p(a,n),p(a,_),p(e,S),p(e,h);for(let g=0;g<c.length;g+=1)c[g]&&c[g].m(h,null)},p(f,[o]){if(o&1&&Q(_,f[0]),o&14){u=q(f[2]);let g;for(g=0;g<u.length;g+=1){const R=le(f,u,g);c[g]?c[g].p(R,o):(c[g]=ne(R),c[g].c(),c[g].m(h,null))}for(;g<c.length;g+=1)c[g].d(1);c.length=u.length}},i:Z,o:Z,d(f){f&&w(e),W(c,f)}}}function Re(i,e,l){let{drachmas:t}=e,{chosenRelic:s}=e,{curGridId:a}=e;const n=J.filter(h=>h.stageId===a),_=h=>{if(t>=h.price){l(0,t-=h.price),localStorage.setItem("drachmas",t),l(1,s=h),localStorage.setItem("chosenRelicId",h.id),window.location.reload();return}alert("Not enough drachmas to spend!")},S=h=>_(h);return i.$$set=h=>{"drachmas"in h&&l(0,t=h.drachmas),"chosenRelic"in h&&l(1,s=h.chosenRelic),"curGridId"in h&&l(4,a=h.curGridId)},[t,s,n,_,a,S]}class Ge extends ue{constructor(e){super(),_e(this,e,Re,Ce,he,{drachmas:0,chosenRelic:1,curGridId:4})}}function re(i,e,l){const t=i.slice();return t[16]=e[l],t[18]=l,t}function ce(i,e,l){const t=i.slice();return t[16]=e[l],t[20]=l,t}function oe(i){let e,l,t,s,a,n,_,S="Left",h,u,c="Right",f,o,g="Down",R,G,B="Up",P,k,m=q(Array(L)),I=[];for(let r=0;r<m.length;r+=1)I[r]=fe(re(i,m,r));return{c(){e=b("h2"),l=D(i[2]),t=E(),s=b("div");for(let r=0;r<I.length;r+=1)I[r].c();a=E(),n=b("div"),_=b("button"),_.textContent=S,h=E(),u=b("button"),u.textContent=c,f=E(),o=b("button"),o.textContent=g,R=E(),G=b("button"),G.textContent=B,this.h()},l(r){e=x(r,"H2",{});var v=A(e);l=N(v,i[2]),v.forEach(w),t=z(r),s=x(r,"DIV",{class:!0});var d=A(s);for(let U=0;U<I.length;U+=1)I[U].l(d);d.forEach(w),a=z(r),n=x(r,"DIV",{class:!0});var y=A(n);_=x(y,"BUTTON",{class:!0,"data-svelte-h":!0}),V(_)!=="svelte-b3x30h"&&(_.textContent=S),h=z(y),u=x(y,"BUTTON",{class:!0,"data-svelte-h":!0}),V(u)!=="svelte-du436l"&&(u.textContent=c),f=z(y),o=x(y,"BUTTON",{class:!0,"data-svelte-h":!0}),V(o)!=="svelte-1x8a6xp"&&(o.textContent=g),R=z(y),G=x(y,"BUTTON",{class:!0,"data-svelte-h":!0}),V(G)!=="svelte-zcznvd"&&(G.textContent=B),y.forEach(w),this.h()},h(){C(s,"class","grid svelte-1k77czo"),C(_,"class","svelte-1k77czo"),C(u,"class","svelte-1k77czo"),C(o,"class","svelte-1k77czo"),C(G,"class","svelte-1k77czo"),C(n,"class","controls svelte-1k77czo")},m(r,v){T(r,e,v),p(e,l),T(r,t,v),T(r,s,v);for(let d=0;d<I.length;d+=1)I[d]&&I[d].m(s,null);T(r,a,v),T(r,n,v),p(n,_),p(n,h),p(n,u),p(n,f),p(n,o),p(n,R),p(n,G),P||(k=[O(_,"click",i[8]),O(u,"click",i[9]),O(o,"click",i[10]),O(G,"click",i[11])],P=!0)},p(r,v){if(v&4&&Q(l,r[2]),v&67){m=q(Array(L));let d;for(d=0;d<m.length;d+=1){const y=re(r,m,d);I[d]?I[d].p(y,v):(I[d]=fe(y),I[d].c(),I[d].m(s,null))}for(;d<I.length;d+=1)I[d].d(1);I.length=m.length}},d(r){r&&(w(e),w(t),w(s),w(a),w(n)),W(I,r),P=!1,ve(k)}}}function ae(i){let e,l;return{c(){e=b("div"),this.h()},l(t){e=x(t,"DIV",{class:!0}),A(e).forEach(w),this.h()},h(){C(e,"class",l="cell "+i[6](i[20],i[18],i[0],i[1])+" svelte-1k77czo")},m(t,s){T(t,e,s)},p(t,s){s&3&&l!==(l="cell "+t[6](t[20],t[18],t[0],t[1])+" svelte-1k77czo")&&C(e,"class",l)},d(t){t&&w(e)}}}function fe(i){let e,l=q(Array(L)),t=[];for(let s=0;s<l.length;s+=1)t[s]=ae(ce(i,l,s));return{c(){for(let s=0;s<t.length;s+=1)t[s].c();e=$()},l(s){for(let a=0;a<t.length;a+=1)t[a].l(s);e=$()},m(s,a){for(let n=0;n<t.length;n+=1)t[n]&&t[n].m(s,a);T(s,e,a)},p(s,a){if(a&67){l=q(Array(L));let n;for(n=0;n<l.length;n+=1){const _=ce(s,l,n);t[n]?t[n].p(_,a):(t[n]=ae(_),t[n].c(),t[n].m(e.parentNode,e))}for(;n<t.length;n+=1)t[n].d(1);t.length=l.length}},d(s){s&&w(e),W(t,s)}}}function de(i){let e,l;return e=new Ge({props:{drachmas:i[4],chosenRelic:i[5],curGridId:i[1]}}),{c(){ye(e.$$.fragment)},l(t){Ie(e.$$.fragment,t)},m(t,s){we(e,t,s),l=!0},p(t,s){const a={};s&16&&(a.drachmas=t[4]),s&32&&(a.chosenRelic=t[5]),s&2&&(a.curGridId=t[1]),e.$set(a)},i(t){l||(j(e.$$.fragment,t),l=!0)},o(t){F(e.$$.fragment,t),l=!1},d(t){be(e,t)}}}function Ee(i){let e,l,t,s=i[3]?"Close Relic Store":"Relic Store",a,n,_,S,h,u=!i[3]&&oe(i),c=i[3]&&de(i);return{c(){e=b("div"),u&&u.c(),l=E(),t=b("button"),a=D(s),n=E(),c&&c.c(),this.h()},l(f){e=x(f,"DIV",{class:!0});var o=A(e);u&&u.l(o),l=z(o),t=x(o,"BUTTON",{class:!0});var g=A(t);a=N(g,s),g.forEach(w),n=z(o),c&&c.l(o),o.forEach(w),this.h()},h(){C(t,"class","svelte-1k77czo"),C(e,"class","world svelte-1k77czo")},m(f,o){T(f,e,o),u&&u.m(e,null),p(e,l),p(e,t),p(t,a),p(e,n),c&&c.m(e,null),_=!0,S||(h=O(t,"click",i[12]),S=!0)},p(f,[o]){f[3]?u&&(u.d(1),u=null):u?u.p(f,o):(u=oe(f),u.c(),u.m(e,l)),(!_||o&8)&&s!==(s=f[3]?"Close Relic Store":"Relic Store")&&Q(a,s),f[3]?c?(c.p(f,o),o&8&&j(c,1)):(c=de(f),c.c(),j(c,1),c.m(e,null)):c&&(xe(),F(c,1,1,()=>{c=null}),ke())},i(f){_||(j(c),_=!0)},o(f){F(c),_=!1},d(f){f&&w(e),u&&u.d(),c&&c.d(),S=!1,h()}}}const L=5;function ze(i,e,l){let t={x:2,y:2},s=1,a=M.find(k=>k.id===s).name,n=!1,_=0,S=0,h=J[0];const u=k=>{k.key==="ArrowUp"&&o("up"),k.key==="ArrowDown"&&o("down"),k.key==="ArrowLeft"&&o("left"),k.key==="ArrowRight"&&o("right")},c=(k,m,I,r)=>{if(I.x===k&&I.y===m)return"player";const v=K.find(d=>d.id===r);return v.rocks.find(d=>d.x===k&&d.y===m)?"rock":v.exits.find(d=>d.x===k&&d.y===m)?"exit":""},f=()=>{const k=K.find(m=>m.id===s).exits.find(m=>m.x===t.x&&m.y===t.y);if(_<M.find(m=>m.id===k.destGridId).expReq){alert("Not enough experience to enter!");return}k&&(l(1,s=k.destGridId),localStorage.setItem("curStageId",s),l(2,a=M.find(m=>m.id===s).name),l(0,t=k.spawn))},o=k=>{let m={...t};if(k==="up"&&(m.y-=1),k==="down"&&(m.y+=1),k==="left"&&(m.x-=1),k==="right"&&(m.x+=1),m.x<0||m.x>=L||m.y<0||m.y>=L)return;const I=K.find(r=>r.id===s);I.rocks.find(r=>r.x===m.x&&r.y===m.y)||l(0,t=m),I.exits.find(r=>r.x===t.x&&r.y===t.y)&&f()};return pe(()=>{ee.set(!0),te.set(!0),localStorage.getItem("curStageId")&&(l(1,s=parseInt(localStorage.getItem("curStageId"))),l(2,a=M.find(k=>k.id===s).name)),localStorage.getItem("playerExperience")&&(_=parseInt(localStorage.getItem("playerExperience"))),localStorage.getItem("drachmas")&&l(4,S=parseInt(localStorage.getItem("drachmas"))),localStorage.getItem("chosenRelicId")&&l(5,h=J.find(k=>k.id===parseInt(localStorage.getItem("chosenRelicId")))),typeof window<"u"&&window.addEventListener("keydown",u)}),ge(()=>{ee.set(!1),te.set(!1),typeof window<"u"&&window.removeEventListener("keydown",u)}),[t,s,a,n,S,h,c,o,()=>o("left"),()=>o("right"),()=>o("down"),()=>o("up"),()=>l(3,n=!n)]}class Ue extends ue{constructor(e){super(),_e(this,e,ze,Ee,he,{})}}export{Ue as component};
