import{s as fe,n as X,d as _e,o as ge,f as pe}from"../chunks/scheduler.BoReh3vH.js";import{S as de,i as he,e as k,s as A,t as D,c as w,a as G,y as ue,f as C,b as P,d as p,o as R,g as x,h as _,j as K,B as F,A as me,n as M,l as O,m as ve,k as Y,u as ye,v as Ie,w as ke,x as we,q as be}from"../chunks/index.BklZDJd0.js";import{e as V}from"../chunks/each.D6YF6ztN.js";import{i as Z,a as $}from"../chunks/store.Cn0GNUQE.js";import{r as j,s as z}from"../chunks/relics.CGlwEWe2.js";import{b as Re}from"../chunks/paths.CrWhNARv.js";const L=[{id:1,rocks:[{x:1,y:1},{x:3,y:3},{x:0,y:4}],exits:[{x:0,y:0,destGridId:2,spawn:{x:4,y:4}},{x:4,y:2,destGridId:2,spawn:{x:0,y:2}},{x:2,y:4,destGridId:2,spawn:{x:2,y:0}}]},{id:2,rocks:[{x:1,y:3},{x:4,y:1}],exits:[{x:0,y:4,destGridId:1,spawn:{x:4,y:0}},{x:4,y:0,destGridId:1,spawn:{x:0,y:4}},{x:2,y:0,destGridId:1,spawn:{x:2,y:4}}]}];function ee(n,e,l){const t=n.slice();return t[6]=e[l],t}function te(n){let e;return{c(){e=D("Active")},l(l){e=P(l,"Active")},m(l,t){x(l,e,t)},d(l){l&&p(e)}}}function le(n){let e,l="Buy",t,s;function c(){return n[5](n[6])}return{c(){e=k("button"),e.textContent=l,this.h()},l(i){e=w(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(e)!=="svelte-yl076z"&&(e.textContent=l),this.h()},h(){R(e,"class","svelte-7eusns")},m(i,o){x(i,e,o),t||(s=me(e,"click",c),t=!0)},p(i,o){n=i},d(i){i&&p(e),t=!1,s()}}}function se(n){let e,l,t,s,c,i=n[6].name+"",o,g,r,h,f,d=n[6].description+"",m,a,u,v,T=n[6].price+"",q,E,U,B,b=n[6].id===n[1].id&&te(),I=n[6].id!==n[1].id&&le(n);return{c(){e=k("div"),l=k("img"),s=A(),c=k("h3"),o=D(i),g=A(),r=k("p"),b&&b.c(),h=A(),f=k("p"),m=D(d),a=A(),u=k("p"),v=D("Price: "),q=D(T),E=D(" drachmas"),U=A(),I&&I.c(),B=A(),this.h()},l(S){e=w(S,"DIV",{class:!0});var y=G(e);l=w(y,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),s=C(y),c=w(y,"H3",{});var J=G(c);o=P(J,i),J.forEach(p),g=C(y),r=w(y,"P",{class:!0});var Q=G(r);b&&b.l(Q),Q.forEach(p),h=C(y),f=w(y,"P",{});var W=G(f);m=P(W,d),W.forEach(p),a=C(y),u=w(y,"P",{});var H=G(u);v=P(H,"Price: "),q=P(H,T),E=P(H," drachmas"),H.forEach(p),U=C(y),I&&I.l(y),B=C(y),y.forEach(p),this.h()},h(){_e(l.src,t=Re+"/"+n[6].img)||R(l,"src",t),R(l,"width","46px"),R(l,"height","46px"),R(l,"alt",n[6].name),R(l,"class","svelte-7eusns"),R(r,"class","active"),R(e,"class","menu-item svelte-7eusns")},m(S,y){x(S,e,y),_(e,l),_(e,s),_(e,c),_(c,o),_(e,g),_(e,r),b&&b.m(r,null),_(e,h),_(e,f),_(f,m),_(e,a),_(e,u),_(u,v),_(u,q),_(u,E),_(e,U),I&&I.m(e,null),_(e,B)},p(S,y){S[6].id===S[1].id?b||(b=te(),b.c(),b.m(r,null)):b&&(b.d(1),b=null),S[6].id!==S[1].id?I?I.p(S,y):(I=le(S),I.c(),I.m(e,B)):I&&(I.d(1),I=null)},d(S){S&&p(e),b&&b.d(),I&&I.d()}}}function Ge(n){let e,l,t="Relics",s,c,i,o,g,r,h=V(n[2]),f=[];for(let d=0;d<h.length;d+=1)f[d]=se(ee(n,h,d));return{c(){e=k("div"),l=k("h2"),l.textContent=t,s=A(),c=k("p"),i=D("Drachmas: "),o=D(n[0]),g=A(),r=k("div");for(let d=0;d<f.length;d+=1)f[d].c();this.h()},l(d){e=w(d,"DIV",{class:!0});var m=G(e);l=w(m,"H2",{"data-svelte-h":!0}),ue(l)!=="svelte-2ru1w2"&&(l.textContent=t),s=C(m),c=w(m,"P",{});var a=G(c);i=P(a,"Drachmas: "),o=P(a,n[0]),a.forEach(p),g=C(m),r=w(m,"DIV",{});var u=G(r);for(let v=0;v<f.length;v+=1)f[v].l(u);u.forEach(p),m.forEach(p),this.h()},h(){R(e,"class","menu svelte-7eusns")},m(d,m){x(d,e,m),_(e,l),_(e,s),_(e,c),_(c,i),_(c,o),_(e,g),_(e,r);for(let a=0;a<f.length;a+=1)f[a]&&f[a].m(r,null)},p(d,[m]){if(m&1&&K(o,d[0]),m&14){h=V(d[2]);let a;for(a=0;a<h.length;a+=1){const u=ee(d,h,a);f[a]?f[a].p(u,m):(f[a]=se(u),f[a].c(),f[a].m(r,null))}for(;a<f.length;a+=1)f[a].d(1);f.length=h.length}},i:X,o:X,d(d){d&&p(e),F(f,d)}}}function Se(n,e,l){let{drachmas:t}=e,{chosenRelic:s}=e,{curGridId:c}=e;const i=j.filter(r=>r.stageId===c),o=r=>{if(t>=r.price){l(0,t-=r.price),localStorage.setItem("drachmas",t),l(1,s=r),localStorage.setItem("chosenRelicId",r.id),window.location.reload();return}alert("Not enough drachmas!")},g=r=>o(r);return n.$$set=r=>{"drachmas"in r&&l(0,t=r.drachmas),"chosenRelic"in r&&l(1,s=r.chosenRelic),"curGridId"in r&&l(4,c=r.curGridId)},[t,s,i,o,c,g]}class Ee extends de{constructor(e){super(),he(this,e,Se,Ge,fe,{drachmas:0,chosenRelic:1,curGridId:4})}}function ie(n,e,l){const t=n.slice();return t[11]=e[l],t[13]=l,t}function re(n,e,l){const t=n.slice();return t[11]=e[l],t[15]=l,t}function ne(n){let e,l,t,s,c=V(Array(N)),i=[];for(let o=0;o<c.length;o+=1)i[o]=ce(ie(n,c,o));return{c(){e=k("h2"),l=D(n[2]),t=A(),s=k("div");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=w(o,"H2",{});var g=G(e);l=P(g,n[2]),g.forEach(p),t=C(o),s=w(o,"DIV",{class:!0});var r=G(s);for(let h=0;h<i.length;h+=1)i[h].l(r);r.forEach(p),this.h()},h(){R(s,"class","grid svelte-ed7qbv")},m(o,g){x(o,e,g),_(e,l),x(o,t,g),x(o,s,g);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(s,null)},p(o,g){if(g&4&&K(l,o[2]),g&67){c=V(Array(N));let r;for(r=0;r<c.length;r+=1){const h=ie(o,c,r);i[r]?i[r].p(h,g):(i[r]=ce(h),i[r].c(),i[r].m(s,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=c.length}},d(o){o&&(p(e),p(t),p(s)),F(i,o)}}}function ae(n){let e,l;return{c(){e=k("div"),this.h()},l(t){e=w(t,"DIV",{class:!0}),G(e).forEach(p),this.h()},h(){R(e,"class",l="cell "+n[6](n[15],n[13],n[0],n[1])+" svelte-ed7qbv")},m(t,s){x(t,e,s)},p(t,s){s&3&&l!==(l="cell "+t[6](t[15],t[13],t[0],t[1])+" svelte-ed7qbv")&&R(e,"class",l)},d(t){t&&p(e)}}}function ce(n){let e,l=V(Array(N)),t=[];for(let s=0;s<l.length;s+=1)t[s]=ae(re(n,l,s));return{c(){for(let s=0;s<t.length;s+=1)t[s].c();e=Y()},l(s){for(let c=0;c<t.length;c+=1)t[c].l(s);e=Y()},m(s,c){for(let i=0;i<t.length;i+=1)t[i]&&t[i].m(s,c);x(s,e,c)},p(s,c){if(c&67){l=V(Array(N));let i;for(i=0;i<l.length;i+=1){const o=re(s,l,i);t[i]?t[i].p(o,c):(t[i]=ae(o),t[i].c(),t[i].m(e.parentNode,e))}for(;i<t.length;i+=1)t[i].d(1);t.length=l.length}},d(s){s&&p(e),F(t,s)}}}function oe(n){let e,l;return e=new Ee({props:{drachmas:n[4],chosenRelic:n[5],curGridId:n[1]}}),{c(){ye(e.$$.fragment)},l(t){Ie(e.$$.fragment,t)},m(t,s){ke(e,t,s),l=!0},p(t,s){const c={};s&16&&(c.drachmas=t[4]),s&32&&(c.chosenRelic=t[5]),s&2&&(c.curGridId=t[1]),e.$set(c)},i(t){l||(M(e.$$.fragment,t),l=!0)},o(t){O(e.$$.fragment,t),l=!1},d(t){we(e,t)}}}function Ae(n){let e,l,t,s=n[3]?"Close Relics":"Relics",c,i,o,g,r,h=!n[3]&&ne(n),f=n[3]&&oe(n);return{c(){e=k("div"),h&&h.c(),l=A(),t=k("button"),c=D(s),i=A(),f&&f.c(),this.h()},l(d){e=w(d,"DIV",{class:!0});var m=G(e);h&&h.l(m),l=C(m),t=w(m,"BUTTON",{class:!0});var a=G(t);c=P(a,s),a.forEach(p),i=C(m),f&&f.l(m),m.forEach(p),this.h()},h(){R(t,"class","svelte-ed7qbv"),R(e,"class","world svelte-ed7qbv")},m(d,m){x(d,e,m),h&&h.m(e,null),_(e,l),_(e,t),_(t,c),_(e,i),f&&f.m(e,null),o=!0,g||(r=me(t,"click",n[7]),g=!0)},p(d,[m]){d[3]?h&&(h.d(1),h=null):h?h.p(d,m):(h=ne(d),h.c(),h.m(e,l)),(!o||m&8)&&s!==(s=d[3]?"Close Relics":"Relics")&&K(c,s),d[3]?f?(f.p(d,m),m&8&&M(f,1)):(f=oe(d),f.c(),M(f,1),f.m(e,null)):f&&(be(),O(f,1,1,()=>{f=null}),ve())},i(d){o||(M(f),o=!0)},o(d){O(f),o=!1},d(d){d&&p(e),h&&h.d(),f&&f.d(),g=!1,r()}}}const N=5;function Ce(n,e,l){let t={x:2,y:2},s=1,c=z.find(a=>a.id===s).name,i=!1,o=0,g=j[0];const r=(a,u,v,T)=>{if(v.x===a&&v.y===u)return"player";const q=L.find(E=>E.id===T);return q.rocks.find(E=>E.x===a&&E.y===u)?"rock":q.exits.find(E=>E.x===a&&E.y===u)?"exit":""},h=a=>{a.key==="ArrowUp"&&d("up"),a.key==="ArrowDown"&&d("down"),a.key==="ArrowLeft"&&d("left"),a.key==="ArrowRight"&&d("right")},f=()=>{const a=L.find(u=>u.id===s).exits.find(u=>u.x===t.x&&u.y===t.y);a&&(l(1,s=a.destGridId),localStorage.setItem("curStageId",s),l(2,c=z.find(u=>u.id===s).name),l(0,t=a.spawn))},d=a=>{let u={...t};a==="up"&&(u.y-=1),a==="down"&&(u.y+=1),a==="left"&&(u.x-=1),a==="right"&&(u.x+=1),!(u.x<0||u.x>=N||u.y<0||u.y>=N)&&(L.find(v=>v.id===s).rocks.find(v=>v.x===u.x&&v.y===u.y)||l(0,t=u),L.find(v=>v.id===s).exits.find(v=>v.x===t.x&&v.y===t.y)&&f())};return ge(()=>{Z.set(!0),$.set(!0),localStorage.getItem("curStageId")&&(l(1,s=parseInt(localStorage.getItem("curStageId"))),l(2,c=z.find(a=>a.id===s).name)),localStorage.getItem("drachmas")&&l(4,o=parseInt(localStorage.getItem("drachmas"))),localStorage.getItem("chosenRelicId")&&l(5,g=j.find(a=>a.id===parseInt(localStorage.getItem("chosenRelicId")))),typeof window<"u"&&window.addEventListener("keydown",h)}),pe(()=>{Z.set(!1),$.set(!1),typeof window<"u"&&window.removeEventListener("keydown",h)}),[t,s,c,i,o,g,r,()=>l(3,i=!i)]}class Te extends de{constructor(e){super(),he(this,e,Ce,Ae,fe,{})}}export{Te as component};
