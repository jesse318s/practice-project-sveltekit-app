import{s as he,n as Z,d as pe,o as ve,f as ge,r as ye}from"../chunks/scheduler.BoReh3vH.js";import{S as _e,i as me,e as C,s as G,t as B,c as x,a as j,y as O,f as D,b as P,d as k,o as S,g as T,h as _,j as X,B as Y,A as q,n as F,l as Q,m as ke,k as $,u as Ie,v as be,w as we,x as Ce,q as xe}from"../chunks/index.BklZDJd0.js";import{e as L}from"../chunks/each.D6YF6ztN.js";import{r as W,s as K}from"../chunks/relics.CGlwEWe2.js";import{i as ee,a as te}from"../chunks/store.Cn0GNUQE.js";import{b as Se,g as Ee}from"../chunks/entry.01wdnKDm.js";const J=[{id:1,rocks:[{x:1,y:1},{x:3,y:3},{x:0,y:3}],exits:[{x:0,y:0,destGridId:2,spawn:{x:4,y:4}},{x:4,y:2,destGridId:2,spawn:{x:0,y:2}},{x:2,y:4,destGridId:2,spawn:{x:2,y:0}}]},{id:2,rocks:[{x:1,y:3},{x:4,y:1}],exits:[{x:0,y:4,destGridId:1,spawn:{x:4,y:0}},{x:4,y:0,destGridId:1,spawn:{x:0,y:4}},{x:2,y:0,destGridId:1,spawn:{x:2,y:4}}]}];function le(i,e,l){const t=i.slice();return t[6]=e[l],t}function se(i){let e;return{c(){e=B("Active")},l(l){e=P(l,"Active")},m(l,t){T(l,e,t)},d(l){l&&k(e)}}}function ie(i){let e,l="Buy",t,s;function a(){return i[5](i[6])}return{c(){e=C("button"),e.textContent=l,this.h()},l(n){e=x(n,"BUTTON",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-yl076z"&&(e.textContent=l),this.h()},h(){S(e,"class","svelte-7eusns")},m(n,y){T(n,e,y),t||(s=q(e,"click",a),t=!0)},p(n,y){i=n},d(n){n&&k(e),t=!1,s()}}}function ne(i){let e,l,t,s,a,n=i[6].name+"",y,E,u,b,m,d=i[6].description+"",o,r,v,w,R=i[6].price+"",N,U,g,p,h=i[6].id===i[1].id&&se(),c=i[6].id!==i[1].id&&ie(i);return{c(){e=C("div"),l=C("img"),s=G(),a=C("h3"),y=B(n),E=G(),u=C("p"),h&&h.c(),b=G(),m=C("p"),o=B(d),r=G(),v=C("p"),w=B("Price: "),N=B(R),U=B(" drachmas"),g=G(),c&&c.c(),p=G(),this.h()},l(I){e=x(I,"DIV",{class:!0});var f=j(e);l=x(f,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),s=D(f),a=x(f,"H3",{});var A=j(a);y=P(A,n),A.forEach(k),E=D(f),u=x(f,"P",{class:!0});var V=j(u);h&&h.l(V),V.forEach(k),b=D(f),m=x(f,"P",{});var z=j(m);o=P(z,d),z.forEach(k),r=D(f),v=x(f,"P",{});var M=j(v);w=P(M,"Price: "),N=P(M,R),U=P(M," drachmas"),M.forEach(k),g=D(f),c&&c.l(f),p=D(f),f.forEach(k),this.h()},h(){pe(l.src,t=Se+"/"+i[6].img)||S(l,"src",t),S(l,"width","46px"),S(l,"height","46px"),S(l,"alt",i[6].name),S(l,"class","svelte-7eusns"),S(u,"class","active"),S(e,"class","menu-item svelte-7eusns")},m(I,f){T(I,e,f),_(e,l),_(e,s),_(e,a),_(a,y),_(e,E),_(e,u),h&&h.m(u,null),_(e,b),_(e,m),_(m,o),_(e,r),_(e,v),_(v,w),_(v,N),_(v,U),_(e,g),c&&c.m(e,null),_(e,p)},p(I,f){I[6].id===I[1].id?h||(h=se(),h.c(),h.m(u,null)):h&&(h.d(1),h=null),I[6].id!==I[1].id?c?c.p(I,f):(c=ie(I),c.c(),c.m(e,p)):c&&(c.d(1),c=null)},d(I){I&&k(e),h&&h.d(),c&&c.d()}}}function Re(i){let e,l,t="Relic Store",s,a,n,y,E,u,b=L(i[2]),m=[];for(let d=0;d<b.length;d+=1)m[d]=ne(le(i,b,d));return{c(){e=C("div"),l=C("h2"),l.textContent=t,s=G(),a=C("p"),n=B("Drachmas: "),y=B(i[0]),E=G(),u=C("div");for(let d=0;d<m.length;d+=1)m[d].c();this.h()},l(d){e=x(d,"DIV",{class:!0});var o=j(e);l=x(o,"H2",{"data-svelte-h":!0}),O(l)!=="svelte-6gh0hs"&&(l.textContent=t),s=D(o),a=x(o,"P",{});var r=j(a);n=P(r,"Drachmas: "),y=P(r,i[0]),r.forEach(k),E=D(o),u=x(o,"DIV",{});var v=j(u);for(let w=0;w<m.length;w+=1)m[w].l(v);v.forEach(k),o.forEach(k),this.h()},h(){S(e,"class","menu svelte-7eusns")},m(d,o){T(d,e,o),_(e,l),_(e,s),_(e,a),_(a,n),_(a,y),_(e,E),_(e,u);for(let r=0;r<m.length;r+=1)m[r]&&m[r].m(u,null)},p(d,[o]){if(o&1&&X(y,d[0]),o&14){b=L(d[2]);let r;for(r=0;r<b.length;r+=1){const v=le(d,b,r);m[r]?m[r].p(v,o):(m[r]=ne(v),m[r].c(),m[r].m(u,null))}for(;r<m.length;r+=1)m[r].d(1);m.length=b.length}},i:Z,o:Z,d(d){d&&k(e),Y(m,d)}}}function Ge(i,e,l){let{drachmas:t}=e,{chosenRelic:s}=e,{curGridId:a}=e;const n=W.filter(u=>u.stageId===a),y=u=>{if(t>=u.price){l(0,t-=u.price),localStorage.setItem("drachmas",t),l(1,s=u),localStorage.setItem("chosenRelicId",u.id),window.location.reload();return}alert("Not enough drachmas to spend!")},E=u=>y(u);return i.$$set=u=>{"drachmas"in u&&l(0,t=u.drachmas),"chosenRelic"in u&&l(1,s=u.chosenRelic),"curGridId"in u&&l(4,a=u.curGridId)},[t,s,n,y,a,E]}class De extends _e{constructor(e){super(),me(this,e,Ge,Re,he,{drachmas:0,chosenRelic:1,curGridId:4})}}function re(i,e,l){const t=i.slice();return t[17]=e[l],t[19]=l,t}function ae(i,e,l){const t=i.slice();return t[17]=e[l],t[21]=l,t}function ce(i){let e,l,t,s,a,n,y,E="Left",u,b,m,d="Up",o,r,v="Down",w,R,N="Right",U,g,p=L(Array(H)),h=[];for(let c=0;c<p.length;c+=1)h[c]=fe(re(i,p,c));return{c(){e=C("h2"),l=B(i[2]),t=G(),s=C("div");for(let c=0;c<h.length;c+=1)h[c].c();a=G(),n=C("div"),y=C("button"),y.textContent=E,u=G(),b=C("div"),m=C("button"),m.textContent=d,o=G(),r=C("button"),r.textContent=v,w=G(),R=C("button"),R.textContent=N,this.h()},l(c){e=x(c,"H2",{});var I=j(e);l=P(I,i[2]),I.forEach(k),t=D(c),s=x(c,"DIV",{class:!0});var f=j(s);for(let z=0;z<h.length;z+=1)h[z].l(f);f.forEach(k),a=D(c),n=x(c,"DIV",{class:!0});var A=j(n);y=x(A,"BUTTON",{class:!0,"data-svelte-h":!0}),O(y)!=="svelte-b3x30h"&&(y.textContent=E),u=D(A),b=x(A,"DIV",{class:!0});var V=j(b);m=x(V,"BUTTON",{class:!0,"data-svelte-h":!0}),O(m)!=="svelte-zcznvd"&&(m.textContent=d),o=D(V),r=x(V,"BUTTON",{class:!0,"data-svelte-h":!0}),O(r)!=="svelte-1x8a6xp"&&(r.textContent=v),V.forEach(k),w=D(A),R=x(A,"BUTTON",{class:!0,"data-svelte-h":!0}),O(R)!=="svelte-du436l"&&(R.textContent=N),A.forEach(k),this.h()},h(){S(s,"class","grid svelte-1tfpji3"),S(y,"class","svelte-1tfpji3"),S(m,"class","svelte-1tfpji3"),S(r,"class","svelte-1tfpji3"),S(b,"class","svelte-1tfpji3"),S(R,"class","svelte-1tfpji3"),S(n,"class","button-row svelte-1tfpji3")},m(c,I){T(c,e,I),_(e,l),T(c,t,I),T(c,s,I);for(let f=0;f<h.length;f+=1)h[f]&&h[f].m(s,null);T(c,a,I),T(c,n,I),_(n,y),_(n,u),_(n,b),_(b,m),_(b,o),_(b,r),_(n,w),_(n,R),U||(g=[q(y,"click",i[8]),q(m,"click",i[9]),q(r,"click",i[10]),q(R,"click",i[11])],U=!0)},p(c,I){if(I&4&&X(l,c[2]),I&67){p=L(Array(H));let f;for(f=0;f<p.length;f+=1){const A=re(c,p,f);h[f]?h[f].p(A,I):(h[f]=fe(A),h[f].c(),h[f].m(s,null))}for(;f<h.length;f+=1)h[f].d(1);h.length=p.length}},d(c){c&&(k(e),k(t),k(s),k(a),k(n)),Y(h,c),U=!1,ye(g)}}}function oe(i){let e,l;return{c(){e=C("div"),this.h()},l(t){e=x(t,"DIV",{class:!0}),j(e).forEach(k),this.h()},h(){S(e,"class",l="cell "+i[6](i[21],i[19],i[0],i[1])+" svelte-1tfpji3")},m(t,s){T(t,e,s)},p(t,s){s&3&&l!==(l="cell "+t[6](t[21],t[19],t[0],t[1])+" svelte-1tfpji3")&&S(e,"class",l)},d(t){t&&k(e)}}}function fe(i){let e,l=L(Array(H)),t=[];for(let s=0;s<l.length;s+=1)t[s]=oe(ae(i,l,s));return{c(){for(let s=0;s<t.length;s+=1)t[s].c();e=$()},l(s){for(let a=0;a<t.length;a+=1)t[a].l(s);e=$()},m(s,a){for(let n=0;n<t.length;n+=1)t[n]&&t[n].m(s,a);T(s,e,a)},p(s,a){if(a&67){l=L(Array(H));let n;for(n=0;n<l.length;n+=1){const y=ae(s,l,n);t[n]?t[n].p(y,a):(t[n]=oe(y),t[n].c(),t[n].m(e.parentNode,e))}for(;n<t.length;n+=1)t[n].d(1);t.length=l.length}},d(s){s&&k(e),Y(t,s)}}}function de(i){let e,l="Battle",t,s;return{c(){e=C("button"),e.textContent=l,this.h()},l(a){e=x(a,"BUTTON",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-17w86ff"&&(e.textContent=l),this.h()},h(){S(e,"class","svelte-1tfpji3")},m(a,n){T(a,e,n),t||(s=q(e,"click",i[13]),t=!0)},d(a){a&&k(e),t=!1,s()}}}function ue(i){let e,l;return e=new De({props:{drachmas:i[4],chosenRelic:i[5],curGridId:i[1]}}),{c(){Ie(e.$$.fragment)},l(t){be(e.$$.fragment,t)},m(t,s){we(e,t,s),l=!0},p(t,s){const a={};s&16&&(a.drachmas=t[4]),s&32&&(a.chosenRelic=t[5]),s&2&&(a.curGridId=t[1]),e.$set(a)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Q(e.$$.fragment,t),l=!1},d(t){Ce(e,t)}}}function je(i){let e,l,t,s,a=i[3]?"Close Relic Store":"Relic Store",n,y,E,u,b,m,d=!i[3]&&ce(i),o=!i[3]&&de(i),r=i[3]&&ue(i);return{c(){e=C("div"),d&&d.c(),l=G(),t=C("div"),s=C("button"),n=B(a),y=G(),o&&o.c(),E=G(),r&&r.c(),this.h()},l(v){e=x(v,"DIV",{class:!0});var w=j(e);d&&d.l(w),l=D(w),t=x(w,"DIV",{class:!0});var R=j(t);s=x(R,"BUTTON",{class:!0});var N=j(s);n=P(N,a),N.forEach(k),y=D(R),o&&o.l(R),R.forEach(k),E=D(w),r&&r.l(w),w.forEach(k),this.h()},h(){S(s,"class","svelte-1tfpji3"),S(t,"class","button-row svelte-1tfpji3"),S(e,"class","world svelte-1tfpji3")},m(v,w){T(v,e,w),d&&d.m(e,null),_(e,l),_(e,t),_(t,s),_(s,n),_(t,y),o&&o.m(t,null),_(e,E),r&&r.m(e,null),u=!0,b||(m=q(s,"click",i[12]),b=!0)},p(v,[w]){v[3]?d&&(d.d(1),d=null):d?d.p(v,w):(d=ce(v),d.c(),d.m(e,l)),(!u||w&8)&&a!==(a=v[3]?"Close Relic Store":"Relic Store")&&X(n,a),v[3]?o&&(o.d(1),o=null):o||(o=de(v),o.c(),o.m(t,null)),v[3]?r?(r.p(v,w),w&8&&F(r,1)):(r=ue(v),r.c(),F(r,1),r.m(e,null)):r&&(xe(),Q(r,1,1,()=>{r=null}),ke())},i(v){u||(F(r),u=!0)},o(v){Q(r),u=!1},d(v){v&&k(e),d&&d.d(),o&&o.d(),r&&r.d(),b=!1,m()}}}const H=5;function Te(i,e,l){let t={x:2,y:2},s=1,a=K.find(g=>g.id===s).name,n=!1,y=0,E=0,u=W[0];const b=g=>{g.key==="ArrowUp"&&(g.preventDefault(),o("up")),g.key==="ArrowDown"&&(g.preventDefault(),o("down")),g.key==="ArrowLeft"&&(g.preventDefault(),o("left")),g.key==="ArrowRight"&&(g.preventDefault(),o("right"))},m=(g,p,h,c)=>{if(h.x===g&&h.y===p)return"player";const I=J.find(f=>f.id===c);return I.rocks.find(f=>f.x===g&&f.y===p)?"rock":I.exits.find(f=>f.x===g&&f.y===p)?"exit":""},d=()=>{const g=J.find(p=>p.id===s).exits.find(p=>p.x===t.x&&p.y===t.y);if(y<K.find(p=>p.id===g.destGridId).expReq){alert("Not enough experience to enter!");return}g&&(l(1,s=g.destGridId),localStorage.setItem("curStageId",s),l(2,a=K.find(p=>p.id===s).name),l(0,t=g.spawn))},o=g=>{let p={...t};if(g==="up"&&(p.y-=1),g==="down"&&(p.y+=1),g==="left"&&(p.x-=1),g==="right"&&(p.x+=1),p.x<0||p.x>=H||p.y<0||p.y>=H)return;const h=J.find(c=>c.id===s);h.rocks.find(c=>c.x===p.x&&c.y===p.y)||l(0,t=p),h.exits.find(c=>c.x===t.x&&c.y===t.y)&&d()};return ve(()=>{ee.set(!0),te.set(!0),localStorage.getItem("curStageId")&&(l(1,s=parseInt(localStorage.getItem("curStageId"))),l(2,a=K.find(g=>g.id===s).name)),localStorage.getItem("playerExperience")&&(y=parseInt(localStorage.getItem("playerExperience"))),localStorage.getItem("drachmas")&&l(4,E=parseInt(localStorage.getItem("drachmas"))),localStorage.getItem("chosenRelicId")&&l(5,u=W.find(g=>g.id===parseInt(localStorage.getItem("chosenRelicId")))),typeof window<"u"&&window.addEventListener("keydown",b)}),ge(()=>{ee.set(!1),te.set(!1),typeof window<"u"&&window.removeEventListener("keydown",b)}),[t,s,a,n,E,u,m,o,()=>o("left"),()=>o("up"),()=>o("down"),()=>o("right"),()=>l(3,n=!n),()=>Ee("/practice-project-sveltekit-app/game")]}class Oe extends _e{constructor(e){super(),me(this,e,Te,je,he,{})}}export{Oe as component};
