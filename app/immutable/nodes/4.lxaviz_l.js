import{s as he,n as Z,d as pe,o as ge,f as ve,r as ye}from"../chunks/scheduler.BoReh3vH.js";import{S as _e,i as me,e as x,s as E,t as P,c as C,a as D,y as O,f as R,b as U,d as k,o as T,g as A,h as m,j as X,B as Y,A as z,n as F,l as Q,m as Ie,k as $,u as ke,v as we,w as be,x as xe,q as Ce}from"../chunks/index.BklZDJd0.js";import{e as j}from"../chunks/each.D6YF6ztN.js";import{s as J,r as W}from"../chunks/relics.CGlwEWe2.js";import{i as ee,a as te}from"../chunks/store.Cn0GNUQE.js";import{b as Se,g as Ge}from"../chunks/entry.BpoSql9k.js";const H=[{id:1,stageId:1,rocks:[{x:1,y:1},{x:3,y:3},{x:0,y:3}],exits:[{x:0,y:0,destGridId:2,spawn:{x:4,y:4}},{x:4,y:2,destGridId:2,spawn:{x:0,y:2}},{x:2,y:4,destGridId:2,spawn:{x:2,y:0}}]},{id:2,stageId:1,rocks:[{x:3,y:1}],exits:[{x:1,y:0,destGridId:1,spawn:{x:3,y:4}},{x:4,y:3,destGridId:3,spawn:{x:0,y:1}}]},{id:3,stageId:2,rocks:[{x:1,y:3},{x:4,y:1}],exits:[{x:0,y:4,destGridId:2,spawn:{x:4,y:0}},{x:4,y:0,destGridId:4,spawn:{x:0,y:4}},{x:2,y:0,destGridId:4,spawn:{x:2,y:4}}]},{id:4,stageId:2,rocks:[{x:0,y:2},{x:2,y:3}],exits:[{x:1,y:4,destGridId:3,spawn:{x:3,y:0}},{x:3,y:0,destGridId:3,spawn:{x:1,y:4}}]}];function le(n,e,l){const t=n.slice();return t[7]=e[l],t}function ie(n){let e;return{c(){e=P("Active")},l(l){e=U(l,"Active")},m(l,t){A(l,e,t)},d(l){l&&k(e)}}}function ne(n){let e,l="Buy",t,i;function o(){return n[5](n[7])}return{c(){e=x("button"),e.textContent=l},l(s){e=C(s,"BUTTON",{"data-svelte-h":!0}),O(e)!=="svelte-yl076z"&&(e.textContent=l)},m(s,y){A(s,e,y),t||(i=z(e,"click",o),t=!0)},p(s,y){n=s},d(s){s&&k(e),t=!1,i()}}}function se(n){let e,l,t,i,o,s=n[7].name+"",y,S,I,u,_,h=n[7].description+"",d,r,p,b,G=n[7].price+"",B,V,g,v,c=n[7].id===n[1].id&&ie(),a=n[7].id!==n[1].id&&ne(n);return{c(){e=x("div"),l=x("img"),i=E(),o=x("h3"),y=P(s),S=E(),I=x("p"),c&&c.c(),u=E(),_=x("p"),d=P(h),r=E(),p=x("p"),b=P("Price: "),B=P(G),V=P(" drachmas"),g=E(),a&&a.c(),v=E(),this.h()},l(w){e=C(w,"DIV",{class:!0});var f=D(e);l=C(f,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),i=R(f),o=C(f,"H3",{});var N=D(o);y=U(N,s),N.forEach(k),S=R(f),I=C(f,"P",{class:!0});var q=D(I);c&&c.l(q),q.forEach(k),u=R(f),_=C(f,"P",{});var L=D(_);d=U(L,h),L.forEach(k),r=R(f),p=C(f,"P",{});var K=D(p);b=U(K,"Price: "),B=U(K,G),V=U(K," drachmas"),K.forEach(k),g=R(f),a&&a.l(f),v=R(f),f.forEach(k),this.h()},h(){pe(l.src,t=Se+"/"+n[7].img)||T(l,"src",t),T(l,"width","46px"),T(l,"height","46px"),T(l,"alt",n[7].name),T(l,"class","svelte-d2hwqd"),T(I,"class","active"),T(e,"class","menu-item svelte-d2hwqd")},m(w,f){A(w,e,f),m(e,l),m(e,i),m(e,o),m(o,y),m(e,S),m(e,I),c&&c.m(I,null),m(e,u),m(e,_),m(_,d),m(e,r),m(e,p),m(p,b),m(p,B),m(p,V),m(e,g),a&&a.m(e,null),m(e,v)},p(w,f){w[7].id===w[1].id?c||(c=ie(),c.c(),c.m(I,null)):c&&(c.d(1),c=null),w[7].id!==w[1].id?a?a.p(w,f):(a=ne(w),a.c(),a.m(e,v)):a&&(a.d(1),a=null)},d(w){w&&k(e),c&&c.d(),a&&a.d()}}}function Ee(n){let e,l,t="Relic Store",i,o,s,y,S,I,u=j(n[2]),_=[];for(let h=0;h<u.length;h+=1)_[h]=se(le(n,u,h));return{c(){e=x("div"),l=x("h2"),l.textContent=t,i=E(),o=x("p"),s=P("Drachmas: "),y=P(n[0]),S=E(),I=x("div");for(let h=0;h<_.length;h+=1)_[h].c();this.h()},l(h){e=C(h,"DIV",{class:!0});var d=D(e);l=C(d,"H2",{"data-svelte-h":!0}),O(l)!=="svelte-6gh0hs"&&(l.textContent=t),i=R(d),o=C(d,"P",{});var r=D(o);s=U(r,"Drachmas: "),y=U(r,n[0]),r.forEach(k),S=R(d),I=C(d,"DIV",{});var p=D(I);for(let b=0;b<_.length;b+=1)_[b].l(p);p.forEach(k),d.forEach(k),this.h()},h(){T(e,"class","menu svelte-d2hwqd")},m(h,d){A(h,e,d),m(e,l),m(e,i),m(e,o),m(o,s),m(o,y),m(e,S),m(e,I);for(let r=0;r<_.length;r+=1)_[r]&&_[r].m(I,null)},p(h,[d]){if(d&1&&X(y,h[0]),d&14){u=j(h[2]);let r;for(r=0;r<u.length;r+=1){const p=le(h,u,r);_[r]?_[r].p(p,d):(_[r]=se(p),_[r].c(),_[r].m(I,null))}for(;r<_.length;r+=1)_[r].d(1);_.length=u.length}},i:Z,o:Z,d(h){h&&k(e),Y(_,h)}}}function Re(n,e,l){let{drachmas:t}=e,{chosenRelic:i}=e,{curGridId:o}=e;const s=J.find(u=>u.id===H.find(_=>_.id===o).stageId),y=W.filter(u=>u.stageId===s.id),S=u=>{if(t>=u.price){l(0,t-=u.price),localStorage.setItem("drachmas",t),l(1,i=u),localStorage.setItem("chosenRelicId",u.id),window.location.reload();return}alert("Not enough drachmas to spend!")},I=u=>S(u);return n.$$set=u=>{"drachmas"in u&&l(0,t=u.drachmas),"chosenRelic"in u&&l(1,i=u.chosenRelic),"curGridId"in u&&l(4,o=u.curGridId)},[t,i,y,S,o,I]}class De extends _e{constructor(e){super(),me(this,e,Re,Ee,he,{drachmas:0,chosenRelic:1,curGridId:4})}}function re(n,e,l){const t=n.slice();return t[17]=e[l],t[19]=l,t}function ae(n,e,l){const t=n.slice();return t[17]=e[l],t[21]=l,t}function oe(n){let e,l,t,i,o,s,y,S="Left",I,u,_,h="Up",d,r,p="Down",b,G,B="Right",V,g,v=j(Array(M)),c=[];for(let a=0;a<v.length;a+=1)c[a]=de(re(n,v,a));return{c(){e=x("h2"),l=P(n[2]),t=E(),i=x("div");for(let a=0;a<c.length;a+=1)c[a].c();o=E(),s=x("div"),y=x("button"),y.textContent=S,I=E(),u=x("div"),_=x("button"),_.textContent=h,d=E(),r=x("button"),r.textContent=p,b=E(),G=x("button"),G.textContent=B,this.h()},l(a){e=C(a,"H2",{});var w=D(e);l=U(w,n[2]),w.forEach(k),t=R(a),i=C(a,"DIV",{class:!0});var f=D(i);for(let L=0;L<c.length;L+=1)c[L].l(f);f.forEach(k),o=R(a),s=C(a,"DIV",{class:!0});var N=D(s);y=C(N,"BUTTON",{"data-svelte-h":!0}),O(y)!=="svelte-b3x30h"&&(y.textContent=S),I=R(N),u=C(N,"DIV",{class:!0});var q=D(u);_=C(q,"BUTTON",{"data-svelte-h":!0}),O(_)!=="svelte-zcznvd"&&(_.textContent=h),d=R(q),r=C(q,"BUTTON",{"data-svelte-h":!0}),O(r)!=="svelte-1x8a6xp"&&(r.textContent=p),q.forEach(k),b=R(N),G=C(N,"BUTTON",{"data-svelte-h":!0}),O(G)!=="svelte-du436l"&&(G.textContent=B),N.forEach(k),this.h()},h(){T(i,"class","grid svelte-lcty9u"),T(u,"class","svelte-lcty9u"),T(s,"class","button-row svelte-lcty9u")},m(a,w){A(a,e,w),m(e,l),A(a,t,w),A(a,i,w);for(let f=0;f<c.length;f+=1)c[f]&&c[f].m(i,null);A(a,o,w),A(a,s,w),m(s,y),m(s,I),m(s,u),m(u,_),m(u,d),m(u,r),m(s,b),m(s,G),V||(g=[z(y,"click",n[8]),z(_,"click",n[9]),z(r,"click",n[10]),z(G,"click",n[11])],V=!0)},p(a,w){if(w&4&&X(l,a[2]),w&67){v=j(Array(M));let f;for(f=0;f<v.length;f+=1){const N=re(a,v,f);c[f]?c[f].p(N,w):(c[f]=de(N),c[f].c(),c[f].m(i,null))}for(;f<c.length;f+=1)c[f].d(1);c.length=v.length}},d(a){a&&(k(e),k(t),k(i),k(o),k(s)),Y(c,a),V=!1,ye(g)}}}function ce(n){let e,l;return{c(){e=x("div"),this.h()},l(t){e=C(t,"DIV",{class:!0}),D(e).forEach(k),this.h()},h(){T(e,"class",l="cell "+n[6](n[21],n[19],n[0],n[1])+" svelte-lcty9u")},m(t,i){A(t,e,i)},p(t,i){i&3&&l!==(l="cell "+t[6](t[21],t[19],t[0],t[1])+" svelte-lcty9u")&&T(e,"class",l)},d(t){t&&k(e)}}}function de(n){let e,l=j(Array(M)),t=[];for(let i=0;i<l.length;i+=1)t[i]=ce(ae(n,l,i));return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=$()},l(i){for(let o=0;o<t.length;o+=1)t[o].l(i);e=$()},m(i,o){for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(i,o);A(i,e,o)},p(i,o){if(o&67){l=j(Array(M));let s;for(s=0;s<l.length;s+=1){const y=ae(i,l,s);t[s]?t[s].p(y,o):(t[s]=ce(y),t[s].c(),t[s].m(e.parentNode,e))}for(;s<t.length;s+=1)t[s].d(1);t.length=l.length}},d(i){i&&k(e),Y(t,i)}}}function fe(n){let e,l="Battle",t,i;return{c(){e=x("button"),e.textContent=l},l(o){e=C(o,"BUTTON",{"data-svelte-h":!0}),O(e)!=="svelte-17w86ff"&&(e.textContent=l)},m(o,s){A(o,e,s),t||(i=z(e,"click",n[13]),t=!0)},d(o){o&&k(e),t=!1,i()}}}function ue(n){let e,l;return e=new De({props:{drachmas:n[4],chosenRelic:n[5],curGridId:n[1]}}),{c(){ke(e.$$.fragment)},l(t){we(e.$$.fragment,t)},m(t,i){be(e,t,i),l=!0},p(t,i){const o={};i&16&&(o.drachmas=t[4]),i&32&&(o.chosenRelic=t[5]),i&2&&(o.curGridId=t[1]),e.$set(o)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Q(e.$$.fragment,t),l=!1},d(t){xe(e,t)}}}function Te(n){let e,l,t,i,o=n[3]?"Close Relic Store":"Relic Store",s,y,S,I,u,_,h=!n[3]&&oe(n),d=!n[3]&&fe(n),r=n[3]&&ue(n);return{c(){e=x("div"),h&&h.c(),l=E(),t=x("div"),i=x("button"),s=P(o),y=E(),d&&d.c(),S=E(),r&&r.c(),this.h()},l(p){e=C(p,"DIV",{class:!0});var b=D(e);h&&h.l(b),l=R(b),t=C(b,"DIV",{class:!0});var G=D(t);i=C(G,"BUTTON",{});var B=D(i);s=U(B,o),B.forEach(k),y=R(G),d&&d.l(G),G.forEach(k),S=R(b),r&&r.l(b),b.forEach(k),this.h()},h(){T(t,"class","button-row svelte-lcty9u"),T(e,"class","game-container svelte-lcty9u")},m(p,b){A(p,e,b),h&&h.m(e,null),m(e,l),m(e,t),m(t,i),m(i,s),m(t,y),d&&d.m(t,null),m(e,S),r&&r.m(e,null),I=!0,u||(_=z(i,"click",n[12]),u=!0)},p(p,[b]){p[3]?h&&(h.d(1),h=null):h?h.p(p,b):(h=oe(p),h.c(),h.m(e,l)),(!I||b&8)&&o!==(o=p[3]?"Close Relic Store":"Relic Store")&&X(s,o),p[3]?d&&(d.d(1),d=null):d||(d=fe(p),d.c(),d.m(t,null)),p[3]?r?(r.p(p,b),b&8&&F(r,1)):(r=ue(p),r.c(),F(r,1),r.m(e,null)):r&&(Ce(),Q(r,1,1,()=>{r=null}),Ie())},i(p){I||(F(r),I=!0)},o(p){Q(r),I=!1},d(p){p&&k(e),h&&h.d(),d&&d.d(),r&&r.d(),u=!1,_()}}}const M=5;function Ae(n,e,l){let t={x:2,y:2},i=1,o=J[0].name,s=!1,y=0,S=0,I=W[0];const u=g=>{g.key==="ArrowUp"&&(g.preventDefault(),d("up")),g.key==="ArrowDown"&&(g.preventDefault(),d("down")),g.key==="ArrowLeft"&&(g.preventDefault(),d("left")),g.key==="ArrowRight"&&(g.preventDefault(),d("right"))},_=(g,v,c,a)=>{if(c.x===g&&c.y===v)return"player";const w=H.find(f=>f.id===a);return w.rocks.find(f=>f.x===g&&f.y===v)?"rock":w.exits.find(f=>f.x===g&&f.y===v)?"exit":""},h=()=>{const g=H.find(c=>c.id===i).exits.find(c=>c.x===t.x&&c.y===t.y),v=J.find(c=>c.id===H.find(a=>a.id===g.destGridId).stageId);if(y<v.expReq){alert("Not enough experience to use portal!");return}g&&(l(1,i=g.destGridId),localStorage.setItem("curStageId",i),l(2,o=v.name),l(0,t=g.spawn))},d=g=>{let v={...t};if(g==="up"&&(v.y-=1),g==="down"&&(v.y+=1),g==="left"&&(v.x-=1),g==="right"&&(v.x+=1),v.x<0||v.x>=M||v.y<0||v.y>=M)return;const c=H.find(a=>a.id===i);c.rocks.find(a=>a.x===v.x&&a.y===v.y)||l(0,t=v),c.exits.find(a=>a.x===t.x&&a.y===t.y)&&h()};return ge(()=>{if(ee.set(!0),te.set(!0),localStorage.getItem("curStageId")){l(1,i=parseInt(localStorage.getItem("curStageId")));const g=J.find(v=>v.id===H.find(c=>c.id===i).stageId);l(2,o=g.name)}localStorage.getItem("playerExperience")&&(y=parseInt(localStorage.getItem("playerExperience"))),localStorage.getItem("drachmas")&&l(4,S=parseInt(localStorage.getItem("drachmas"))),localStorage.getItem("chosenRelicId")&&l(5,I=W.find(g=>g.id===parseInt(localStorage.getItem("chosenRelicId")))),typeof window<"u"&&window.addEventListener("keydown",u)}),ve(()=>{ee.set(!1),te.set(!1),typeof window<"u"&&window.removeEventListener("keydown",u)}),[t,i,o,s,S,I,_,d,()=>d("left"),()=>d("up"),()=>d("down"),()=>d("right"),()=>l(3,s=!s),()=>Ge("/practice-project-sveltekit-app/game")]}class Oe extends _e{constructor(e){super(),me(this,e,Ae,Te,he,{})}}export{Oe as component};
