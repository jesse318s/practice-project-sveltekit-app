import{s as fe,n as X,d as _e,o as ge,f as pe}from"../chunks/scheduler.BoReh3vH.js";import{S as de,i as he,e as I,s as A,t as D,c as w,a as G,y as ue,f as C,b as P,d as p,o as b,g as V,h as _,j as K,B as F,A as me,n as L,l as O,m as ve,k as Y,u as ye,v as Ie,w as we,x as ke,q as be}from"../chunks/index.BklZDJd0.js";import{e as T}from"../chunks/each.D6YF6ztN.js";import{i as Z,a as $}from"../chunks/store.Cn0GNUQE.js";import{r as j,s as z}from"../chunks/relics.CGlwEWe2.js";import{b as Se}from"../chunks/paths.a0lQSYY7.js";const M=[{id:1,rocks:[{x:1,y:1},{x:3,y:3},{x:0,y:3}],exits:[{x:0,y:0,destGridId:2,spawn:{x:4,y:4}},{x:4,y:2,destGridId:2,spawn:{x:0,y:2}},{x:2,y:4,destGridId:2,spawn:{x:2,y:0}}]},{id:2,rocks:[{x:1,y:3},{x:4,y:1}],exits:[{x:0,y:4,destGridId:1,spawn:{x:4,y:0}},{x:4,y:0,destGridId:1,spawn:{x:0,y:4}},{x:2,y:0,destGridId:1,spawn:{x:2,y:4}}]}];function ee(n,e,l){const t=n.slice();return t[6]=e[l],t}function te(n){let e;return{c(){e=D("Active")},l(l){e=P(l,"Active")},m(l,t){V(l,e,t)},d(l){l&&p(e)}}}function le(n){let e,l="Buy",t,s;function o(){return n[5](n[6])}return{c(){e=I("button"),e.textContent=l,this.h()},l(i){e=w(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(e)!=="svelte-yl076z"&&(e.textContent=l),this.h()},h(){b(e,"class","svelte-7eusns")},m(i,c){V(i,e,c),t||(s=me(e,"click",o),t=!0)},p(i,c){n=i},d(i){i&&p(e),t=!1,s()}}}function se(n){let e,l,t,s,o,i=n[6].name+"",c,g,r,h,f,d=n[6].description+"",m,a,u,S,R=n[6].price+"",N,x,U,q,k=n[6].id===n[1].id&&te(),y=n[6].id!==n[1].id&&le(n);return{c(){e=I("div"),l=I("img"),s=A(),o=I("h3"),c=D(i),g=A(),r=I("p"),k&&k.c(),h=A(),f=I("p"),m=D(d),a=A(),u=I("p"),S=D("Price: "),N=D(R),x=D(" drachmas"),U=A(),y&&y.c(),q=A(),this.h()},l(E){e=w(E,"DIV",{class:!0});var v=G(e);l=w(v,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),s=C(v),o=w(v,"H3",{});var J=G(o);c=P(J,i),J.forEach(p),g=C(v),r=w(v,"P",{class:!0});var Q=G(r);k&&k.l(Q),Q.forEach(p),h=C(v),f=w(v,"P",{});var W=G(f);m=P(W,d),W.forEach(p),a=C(v),u=w(v,"P",{});var H=G(u);S=P(H,"Price: "),N=P(H,R),x=P(H," drachmas"),H.forEach(p),U=C(v),y&&y.l(v),q=C(v),v.forEach(p),this.h()},h(){_e(l.src,t=Se+"/"+n[6].img)||b(l,"src",t),b(l,"width","46px"),b(l,"height","46px"),b(l,"alt",n[6].name),b(l,"class","svelte-7eusns"),b(r,"class","active"),b(e,"class","menu-item svelte-7eusns")},m(E,v){V(E,e,v),_(e,l),_(e,s),_(e,o),_(o,c),_(e,g),_(e,r),k&&k.m(r,null),_(e,h),_(e,f),_(f,m),_(e,a),_(e,u),_(u,S),_(u,N),_(u,x),_(e,U),y&&y.m(e,null),_(e,q)},p(E,v){E[6].id===E[1].id?k||(k=te(),k.c(),k.m(r,null)):k&&(k.d(1),k=null),E[6].id!==E[1].id?y?y.p(E,v):(y=le(E),y.c(),y.m(e,q)):y&&(y.d(1),y=null)},d(E){E&&p(e),k&&k.d(),y&&y.d()}}}function Ge(n){let e,l,t="Relic Store",s,o,i,c,g,r,h=T(n[2]),f=[];for(let d=0;d<h.length;d+=1)f[d]=se(ee(n,h,d));return{c(){e=I("div"),l=I("h2"),l.textContent=t,s=A(),o=I("p"),i=D("Drachmas: "),c=D(n[0]),g=A(),r=I("div");for(let d=0;d<f.length;d+=1)f[d].c();this.h()},l(d){e=w(d,"DIV",{class:!0});var m=G(e);l=w(m,"H2",{"data-svelte-h":!0}),ue(l)!=="svelte-6gh0hs"&&(l.textContent=t),s=C(m),o=w(m,"P",{});var a=G(o);i=P(a,"Drachmas: "),c=P(a,n[0]),a.forEach(p),g=C(m),r=w(m,"DIV",{});var u=G(r);for(let S=0;S<f.length;S+=1)f[S].l(u);u.forEach(p),m.forEach(p),this.h()},h(){b(e,"class","menu svelte-7eusns")},m(d,m){V(d,e,m),_(e,l),_(e,s),_(e,o),_(o,i),_(o,c),_(e,g),_(e,r);for(let a=0;a<f.length;a+=1)f[a]&&f[a].m(r,null)},p(d,[m]){if(m&1&&K(c,d[0]),m&14){h=T(d[2]);let a;for(a=0;a<h.length;a+=1){const u=ee(d,h,a);f[a]?f[a].p(u,m):(f[a]=se(u),f[a].c(),f[a].m(r,null))}for(;a<f.length;a+=1)f[a].d(1);f.length=h.length}},i:X,o:X,d(d){d&&p(e),F(f,d)}}}function Re(n,e,l){let{drachmas:t}=e,{chosenRelic:s}=e,{curGridId:o}=e;const i=j.filter(r=>r.stageId===o),c=r=>{if(t>=r.price){l(0,t-=r.price),localStorage.setItem("drachmas",t),l(1,s=r),localStorage.setItem("chosenRelicId",r.id),window.location.reload();return}alert("Not enough drachmas!")},g=r=>c(r);return n.$$set=r=>{"drachmas"in r&&l(0,t=r.drachmas),"chosenRelic"in r&&l(1,s=r.chosenRelic),"curGridId"in r&&l(4,o=r.curGridId)},[t,s,i,c,o,g]}class Ee extends de{constructor(e){super(),he(this,e,Re,Ge,fe,{drachmas:0,chosenRelic:1,curGridId:4})}}function ie(n,e,l){const t=n.slice();return t[11]=e[l],t[13]=l,t}function re(n,e,l){const t=n.slice();return t[11]=e[l],t[15]=l,t}function ne(n){let e,l,t,s,o=T(Array(B)),i=[];for(let c=0;c<o.length;c+=1)i[c]=oe(ie(n,o,c));return{c(){e=I("h2"),l=D(n[2]),t=A(),s=I("div");for(let c=0;c<i.length;c+=1)i[c].c();this.h()},l(c){e=w(c,"H2",{});var g=G(e);l=P(g,n[2]),g.forEach(p),t=C(c),s=w(c,"DIV",{class:!0});var r=G(s);for(let h=0;h<i.length;h+=1)i[h].l(r);r.forEach(p),this.h()},h(){b(s,"class","grid svelte-d1xwe6")},m(c,g){V(c,e,g),_(e,l),V(c,t,g),V(c,s,g);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(s,null)},p(c,g){if(g&4&&K(l,c[2]),g&67){o=T(Array(B));let r;for(r=0;r<o.length;r+=1){const h=ie(c,o,r);i[r]?i[r].p(h,g):(i[r]=oe(h),i[r].c(),i[r].m(s,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=o.length}},d(c){c&&(p(e),p(t),p(s)),F(i,c)}}}function ae(n){let e,l;return{c(){e=I("div"),this.h()},l(t){e=w(t,"DIV",{class:!0}),G(e).forEach(p),this.h()},h(){b(e,"class",l="cell "+n[6](n[15],n[13],n[0],n[1])+" svelte-d1xwe6")},m(t,s){V(t,e,s)},p(t,s){s&3&&l!==(l="cell "+t[6](t[15],t[13],t[0],t[1])+" svelte-d1xwe6")&&b(e,"class",l)},d(t){t&&p(e)}}}function oe(n){let e,l=T(Array(B)),t=[];for(let s=0;s<l.length;s+=1)t[s]=ae(re(n,l,s));return{c(){for(let s=0;s<t.length;s+=1)t[s].c();e=Y()},l(s){for(let o=0;o<t.length;o+=1)t[o].l(s);e=Y()},m(s,o){for(let i=0;i<t.length;i+=1)t[i]&&t[i].m(s,o);V(s,e,o)},p(s,o){if(o&67){l=T(Array(B));let i;for(i=0;i<l.length;i+=1){const c=re(s,l,i);t[i]?t[i].p(c,o):(t[i]=ae(c),t[i].c(),t[i].m(e.parentNode,e))}for(;i<t.length;i+=1)t[i].d(1);t.length=l.length}},d(s){s&&p(e),F(t,s)}}}function ce(n){let e,l;return e=new Ee({props:{drachmas:n[4],chosenRelic:n[5],curGridId:n[1]}}),{c(){ye(e.$$.fragment)},l(t){Ie(e.$$.fragment,t)},m(t,s){we(e,t,s),l=!0},p(t,s){const o={};s&16&&(o.drachmas=t[4]),s&32&&(o.chosenRelic=t[5]),s&2&&(o.curGridId=t[1]),e.$set(o)},i(t){l||(L(e.$$.fragment,t),l=!0)},o(t){O(e.$$.fragment,t),l=!1},d(t){ke(e,t)}}}function xe(n){let e,l,t,s=n[3]?"Close Relic Store":"Relic Store",o,i,c,g,r,h=!n[3]&&ne(n),f=n[3]&&ce(n);return{c(){e=I("div"),h&&h.c(),l=A(),t=I("button"),o=D(s),i=A(),f&&f.c(),this.h()},l(d){e=w(d,"DIV",{class:!0});var m=G(e);h&&h.l(m),l=C(m),t=w(m,"BUTTON",{class:!0});var a=G(t);o=P(a,s),a.forEach(p),i=C(m),f&&f.l(m),m.forEach(p),this.h()},h(){b(t,"class","svelte-d1xwe6"),b(e,"class","world svelte-d1xwe6")},m(d,m){V(d,e,m),h&&h.m(e,null),_(e,l),_(e,t),_(t,o),_(e,i),f&&f.m(e,null),c=!0,g||(r=me(t,"click",n[7]),g=!0)},p(d,[m]){d[3]?h&&(h.d(1),h=null):h?h.p(d,m):(h=ne(d),h.c(),h.m(e,l)),(!c||m&8)&&s!==(s=d[3]?"Close Relic Store":"Relic Store")&&K(o,s),d[3]?f?(f.p(d,m),m&8&&L(f,1)):(f=ce(d),f.c(),L(f,1),f.m(e,null)):f&&(be(),O(f,1,1,()=>{f=null}),ve())},i(d){c||(L(f),c=!0)},o(d){O(f),c=!1},d(d){d&&p(e),h&&h.d(),f&&f.d(),g=!1,r()}}}const B=5;function Ae(n,e,l){let t={x:2,y:2},s=1,o=z.find(a=>a.id===s).name,i=!1,c=0,g=j[0];const r=a=>{a.key==="ArrowUp"&&d("up"),a.key==="ArrowDown"&&d("down"),a.key==="ArrowLeft"&&d("left"),a.key==="ArrowRight"&&d("right")},h=(a,u,S,R)=>{if(S.x===a&&S.y===u)return"player";const N=M.find(x=>x.id===R);return N.rocks.find(x=>x.x===a&&x.y===u)?"rock":N.exits.find(x=>x.x===a&&x.y===u)?"exit":""},f=()=>{const a=M.find(u=>u.id===s).exits.find(u=>u.x===t.x&&u.y===t.y);a&&(l(1,s=a.destGridId),localStorage.setItem("curStageId",s),l(2,o=z.find(u=>u.id===s).name),l(0,t=a.spawn))},d=a=>{let u={...t};if(a==="up"&&(u.y-=1),a==="down"&&(u.y+=1),a==="left"&&(u.x-=1),a==="right"&&(u.x+=1),u.x<0||u.x>=B||u.y<0||u.y>=B)return;const S=M.find(R=>R.id===s);S.rocks.find(R=>R.x===u.x&&R.y===u.y)||l(0,t=u),S.exits.find(R=>R.x===t.x&&R.y===t.y)&&f()};return ge(()=>{Z.set(!0),$.set(!0),localStorage.getItem("curStageId")&&(l(1,s=parseInt(localStorage.getItem("curStageId"))),l(2,o=z.find(a=>a.id===s).name)),localStorage.getItem("drachmas")&&l(4,c=parseInt(localStorage.getItem("drachmas"))),localStorage.getItem("chosenRelicId")&&l(5,g=j.find(a=>a.id===parseInt(localStorage.getItem("chosenRelicId")))),typeof window<"u"&&window.addEventListener("keydown",r)}),pe(()=>{Z.set(!1),$.set(!1),typeof window<"u"&&window.removeEventListener("keydown",r)}),[t,s,o,i,c,g,h,()=>l(3,i=!i)]}class Be extends de{constructor(e){super(),he(this,e,Ae,xe,fe,{})}}export{Be as component};
