import{s as he,n as Z,d as ve,o as pe,f as ge,r as ye}from"../chunks/scheduler.BoReh3vH.js";import{S as _e,i as me,e as C,s as G,t as B,c as x,a as D,y as O,f as z,b as P,d as k,o as S,g as T,h as _,j as X,B as Y,A as q,n as F,l as Q,m as ke,k as $,u as we,v as Ie,w as be,x as Ce,q as xe}from"../chunks/index.BklZDJd0.js";import{e as H}from"../chunks/each.D6YF6ztN.js";import{r as W,s as K}from"../chunks/relics.CGlwEWe2.js";import{i as ee,a as te}from"../chunks/store.Cn0GNUQE.js";import{b as Se,g as Ee}from"../chunks/entry.C9EUO1Hv.js";const J=[{id:1,rocks:[{x:1,y:1},{x:3,y:3},{x:0,y:3}],exits:[{x:0,y:0,destGridId:2,spawn:{x:4,y:4}},{x:4,y:2,destGridId:2,spawn:{x:0,y:2}},{x:2,y:4,destGridId:2,spawn:{x:2,y:0}}]},{id:2,rocks:[{x:1,y:3},{x:4,y:1}],exits:[{x:0,y:4,destGridId:1,spawn:{x:4,y:0}},{x:4,y:0,destGridId:1,spawn:{x:0,y:4}},{x:2,y:0,destGridId:1,spawn:{x:2,y:4}}]}];function le(i,e,l){const t=i.slice();return t[6]=e[l],t}function se(i){let e;return{c(){e=B("Active")},l(l){e=P(l,"Active")},m(l,t){T(l,e,t)},d(l){l&&k(e)}}}function ie(i){let e,l="Buy",t,s;function c(){return i[5](i[6])}return{c(){e=C("button"),e.textContent=l,this.h()},l(r){e=x(r,"BUTTON",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-yl076z"&&(e.textContent=l),this.h()},h(){S(e,"class","svelte-7eusns")},m(r,g){T(r,e,g),t||(s=q(e,"click",c),t=!0)},p(r,g){i=r},d(r){r&&k(e),t=!1,s()}}}function re(i){let e,l,t,s,c,r=i[6].name+"",g,E,u,I,m,d=i[6].description+"",a,n,p,b,R=i[6].price+"",N,U,y,v,h=i[6].id===i[1].id&&se(),o=i[6].id!==i[1].id&&ie(i);return{c(){e=C("div"),l=C("img"),s=G(),c=C("h3"),g=B(r),E=G(),u=C("p"),h&&h.c(),I=G(),m=C("p"),a=B(d),n=G(),p=C("p"),b=B("Price: "),N=B(R),U=B(" drachmas"),y=G(),o&&o.c(),v=G(),this.h()},l(w){e=x(w,"DIV",{class:!0});var f=D(e);l=x(f,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),s=z(f),c=x(f,"H3",{});var A=D(c);g=P(A,r),A.forEach(k),E=z(f),u=x(f,"P",{class:!0});var V=D(u);h&&h.l(V),V.forEach(k),I=z(f),m=x(f,"P",{});var L=D(m);a=P(L,d),L.forEach(k),n=z(f),p=x(f,"P",{});var M=D(p);b=P(M,"Price: "),N=P(M,R),U=P(M," drachmas"),M.forEach(k),y=z(f),o&&o.l(f),v=z(f),f.forEach(k),this.h()},h(){ve(l.src,t=Se+"/"+i[6].img)||S(l,"src",t),S(l,"width","46px"),S(l,"height","46px"),S(l,"alt",i[6].name),S(l,"class","svelte-7eusns"),S(u,"class","active"),S(e,"class","menu-item svelte-7eusns")},m(w,f){T(w,e,f),_(e,l),_(e,s),_(e,c),_(c,g),_(e,E),_(e,u),h&&h.m(u,null),_(e,I),_(e,m),_(m,a),_(e,n),_(e,p),_(p,b),_(p,N),_(p,U),_(e,y),o&&o.m(e,null),_(e,v)},p(w,f){w[6].id===w[1].id?h||(h=se(),h.c(),h.m(u,null)):h&&(h.d(1),h=null),w[6].id!==w[1].id?o?o.p(w,f):(o=ie(w),o.c(),o.m(e,v)):o&&(o.d(1),o=null)},d(w){w&&k(e),h&&h.d(),o&&o.d()}}}function Re(i){let e,l,t="Relic Store",s,c,r,g,E,u,I=H(i[2]),m=[];for(let d=0;d<I.length;d+=1)m[d]=re(le(i,I,d));return{c(){e=C("div"),l=C("h2"),l.textContent=t,s=G(),c=C("p"),r=B("Drachmas: "),g=B(i[0]),E=G(),u=C("div");for(let d=0;d<m.length;d+=1)m[d].c();this.h()},l(d){e=x(d,"DIV",{class:!0});var a=D(e);l=x(a,"H2",{"data-svelte-h":!0}),O(l)!=="svelte-6gh0hs"&&(l.textContent=t),s=z(a),c=x(a,"P",{});var n=D(c);r=P(n,"Drachmas: "),g=P(n,i[0]),n.forEach(k),E=z(a),u=x(a,"DIV",{});var p=D(u);for(let b=0;b<m.length;b+=1)m[b].l(p);p.forEach(k),a.forEach(k),this.h()},h(){S(e,"class","menu svelte-7eusns")},m(d,a){T(d,e,a),_(e,l),_(e,s),_(e,c),_(c,r),_(c,g),_(e,E),_(e,u);for(let n=0;n<m.length;n+=1)m[n]&&m[n].m(u,null)},p(d,[a]){if(a&1&&X(g,d[0]),a&14){I=H(d[2]);let n;for(n=0;n<I.length;n+=1){const p=le(d,I,n);m[n]?m[n].p(p,a):(m[n]=re(p),m[n].c(),m[n].m(u,null))}for(;n<m.length;n+=1)m[n].d(1);m.length=I.length}},i:Z,o:Z,d(d){d&&k(e),Y(m,d)}}}function Ge(i,e,l){let{drachmas:t}=e,{chosenRelic:s}=e,{curGridId:c}=e;const r=W.filter(u=>u.stageId===c),g=u=>{if(t>=u.price){l(0,t-=u.price),localStorage.setItem("drachmas",t),l(1,s=u),localStorage.setItem("chosenRelicId",u.id),window.location.reload();return}alert("Not enough drachmas to spend!")},E=u=>g(u);return i.$$set=u=>{"drachmas"in u&&l(0,t=u.drachmas),"chosenRelic"in u&&l(1,s=u.chosenRelic),"curGridId"in u&&l(4,c=u.curGridId)},[t,s,r,g,c,E]}class ze extends _e{constructor(e){super(),me(this,e,Ge,Re,he,{drachmas:0,chosenRelic:1,curGridId:4})}}function ne(i,e,l){const t=i.slice();return t[17]=e[l],t[19]=l,t}function ce(i,e,l){const t=i.slice();return t[17]=e[l],t[21]=l,t}function oe(i){let e,l,t,s,c,r,g,E="Left",u,I,m,d="Up",a,n,p="Down",b,R,N="Right",U,y,v=H(Array(j)),h=[];for(let o=0;o<v.length;o+=1)h[o]=fe(ne(i,v,o));return{c(){e=C("h2"),l=B(i[2]),t=G(),s=C("div");for(let o=0;o<h.length;o+=1)h[o].c();c=G(),r=C("div"),g=C("button"),g.textContent=E,u=G(),I=C("div"),m=C("button"),m.textContent=d,a=G(),n=C("button"),n.textContent=p,b=G(),R=C("button"),R.textContent=N,this.h()},l(o){e=x(o,"H2",{});var w=D(e);l=P(w,i[2]),w.forEach(k),t=z(o),s=x(o,"DIV",{class:!0});var f=D(s);for(let L=0;L<h.length;L+=1)h[L].l(f);f.forEach(k),c=z(o),r=x(o,"DIV",{class:!0});var A=D(r);g=x(A,"BUTTON",{class:!0,"data-svelte-h":!0}),O(g)!=="svelte-b3x30h"&&(g.textContent=E),u=z(A),I=x(A,"DIV",{class:!0});var V=D(I);m=x(V,"BUTTON",{class:!0,"data-svelte-h":!0}),O(m)!=="svelte-zcznvd"&&(m.textContent=d),a=z(V),n=x(V,"BUTTON",{class:!0,"data-svelte-h":!0}),O(n)!=="svelte-1x8a6xp"&&(n.textContent=p),V.forEach(k),b=z(A),R=x(A,"BUTTON",{class:!0,"data-svelte-h":!0}),O(R)!=="svelte-du436l"&&(R.textContent=N),A.forEach(k),this.h()},h(){S(s,"class","grid svelte-ocrwz8"),S(g,"class","svelte-ocrwz8"),S(m,"class","svelte-ocrwz8"),S(n,"class","svelte-ocrwz8"),S(I,"class","svelte-ocrwz8"),S(R,"class","svelte-ocrwz8"),S(r,"class","button-row svelte-ocrwz8")},m(o,w){T(o,e,w),_(e,l),T(o,t,w),T(o,s,w);for(let f=0;f<h.length;f+=1)h[f]&&h[f].m(s,null);T(o,c,w),T(o,r,w),_(r,g),_(r,u),_(r,I),_(I,m),_(I,a),_(I,n),_(r,b),_(r,R),U||(y=[q(g,"click",i[8]),q(m,"click",i[9]),q(n,"click",i[10]),q(R,"click",i[11])],U=!0)},p(o,w){if(w&4&&X(l,o[2]),w&67){v=H(Array(j));let f;for(f=0;f<v.length;f+=1){const A=ne(o,v,f);h[f]?h[f].p(A,w):(h[f]=fe(A),h[f].c(),h[f].m(s,null))}for(;f<h.length;f+=1)h[f].d(1);h.length=v.length}},d(o){o&&(k(e),k(t),k(s),k(c),k(r)),Y(h,o),U=!1,ye(y)}}}function ae(i){let e,l;return{c(){e=C("div"),this.h()},l(t){e=x(t,"DIV",{class:!0}),D(e).forEach(k),this.h()},h(){S(e,"class",l="cell "+i[6](i[21],i[19],i[0],i[1])+" svelte-ocrwz8")},m(t,s){T(t,e,s)},p(t,s){s&3&&l!==(l="cell "+t[6](t[21],t[19],t[0],t[1])+" svelte-ocrwz8")&&S(e,"class",l)},d(t){t&&k(e)}}}function fe(i){let e,l=H(Array(j)),t=[];for(let s=0;s<l.length;s+=1)t[s]=ae(ce(i,l,s));return{c(){for(let s=0;s<t.length;s+=1)t[s].c();e=$()},l(s){for(let c=0;c<t.length;c+=1)t[c].l(s);e=$()},m(s,c){for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(s,c);T(s,e,c)},p(s,c){if(c&67){l=H(Array(j));let r;for(r=0;r<l.length;r+=1){const g=ce(s,l,r);t[r]?t[r].p(g,c):(t[r]=ae(g),t[r].c(),t[r].m(e.parentNode,e))}for(;r<t.length;r+=1)t[r].d(1);t.length=l.length}},d(s){s&&k(e),Y(t,s)}}}function de(i){let e,l="Battle",t,s;return{c(){e=C("button"),e.textContent=l,this.h()},l(c){e=x(c,"BUTTON",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-17w86ff"&&(e.textContent=l),this.h()},h(){S(e,"class","svelte-ocrwz8")},m(c,r){T(c,e,r),t||(s=q(e,"click",i[13]),t=!0)},d(c){c&&k(e),t=!1,s()}}}function ue(i){let e,l;return e=new ze({props:{drachmas:i[4],chosenRelic:i[5],curGridId:i[1]}}),{c(){we(e.$$.fragment)},l(t){Ie(e.$$.fragment,t)},m(t,s){be(e,t,s),l=!0},p(t,s){const c={};s&16&&(c.drachmas=t[4]),s&32&&(c.chosenRelic=t[5]),s&2&&(c.curGridId=t[1]),e.$set(c)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Q(e.$$.fragment,t),l=!1},d(t){Ce(e,t)}}}function De(i){let e,l,t,s,c=i[3]?"Close Relic Store":"Relic Store",r,g,E,u,I,m,d=!i[3]&&oe(i),a=!i[3]&&de(i),n=i[3]&&ue(i);return{c(){e=C("div"),d&&d.c(),l=G(),t=C("div"),s=C("button"),r=B(c),g=G(),a&&a.c(),E=G(),n&&n.c(),this.h()},l(p){e=x(p,"DIV",{class:!0});var b=D(e);d&&d.l(b),l=z(b),t=x(b,"DIV",{class:!0});var R=D(t);s=x(R,"BUTTON",{class:!0});var N=D(s);r=P(N,c),N.forEach(k),g=z(R),a&&a.l(R),R.forEach(k),E=z(b),n&&n.l(b),b.forEach(k),this.h()},h(){S(s,"class","svelte-ocrwz8"),S(t,"class","button-row svelte-ocrwz8"),S(e,"class","world svelte-ocrwz8")},m(p,b){T(p,e,b),d&&d.m(e,null),_(e,l),_(e,t),_(t,s),_(s,r),_(t,g),a&&a.m(t,null),_(e,E),n&&n.m(e,null),u=!0,I||(m=q(s,"click",i[12]),I=!0)},p(p,[b]){p[3]?d&&(d.d(1),d=null):d?d.p(p,b):(d=oe(p),d.c(),d.m(e,l)),(!u||b&8)&&c!==(c=p[3]?"Close Relic Store":"Relic Store")&&X(r,c),p[3]?a&&(a.d(1),a=null):a||(a=de(p),a.c(),a.m(t,null)),p[3]?n?(n.p(p,b),b&8&&F(n,1)):(n=ue(p),n.c(),F(n,1),n.m(e,null)):n&&(xe(),Q(n,1,1,()=>{n=null}),ke())},i(p){u||(F(n),u=!0)},o(p){Q(n),u=!1},d(p){p&&k(e),d&&d.d(),a&&a.d(),n&&n.d(),I=!1,m()}}}const j=5;function Te(i,e,l){let t={x:2,y:2},s=1,c=K.find(y=>y.id===s).name,r=!1,g=0,E=0,u=W[0];const I=y=>{y.preventDefault(),y.key==="ArrowUp"&&a("up"),y.key==="ArrowDown"&&a("down"),y.key==="ArrowLeft"&&a("left"),y.key==="ArrowRight"&&a("right")},m=(y,v,h,o)=>{if(h.x===y&&h.y===v)return"player";const w=J.find(f=>f.id===o);return w.rocks.find(f=>f.x===y&&f.y===v)?"rock":w.exits.find(f=>f.x===y&&f.y===v)?"exit":""},d=()=>{const y=J.find(v=>v.id===s).exits.find(v=>v.x===t.x&&v.y===t.y);if(g<K.find(v=>v.id===y.destGridId).expReq){alert("Not enough experience to enter!");return}y&&(l(1,s=y.destGridId),localStorage.setItem("curStageId",s),l(2,c=K.find(v=>v.id===s).name),l(0,t=y.spawn))},a=y=>{let v={...t};if(y==="up"&&(v.y-=1),y==="down"&&(v.y+=1),y==="left"&&(v.x-=1),y==="right"&&(v.x+=1),v.x<0||v.x>=j||v.y<0||v.y>=j)return;const h=J.find(o=>o.id===s);h.rocks.find(o=>o.x===v.x&&o.y===v.y)||l(0,t=v),h.exits.find(o=>o.x===t.x&&o.y===t.y)&&d()};return pe(()=>{ee.set(!0),te.set(!0),localStorage.getItem("curStageId")&&(l(1,s=parseInt(localStorage.getItem("curStageId"))),l(2,c=K.find(y=>y.id===s).name)),localStorage.getItem("playerExperience")&&(g=parseInt(localStorage.getItem("playerExperience"))),localStorage.getItem("drachmas")&&l(4,E=parseInt(localStorage.getItem("drachmas"))),localStorage.getItem("chosenRelicId")&&l(5,u=W.find(y=>y.id===parseInt(localStorage.getItem("chosenRelicId")))),typeof window<"u"&&window.addEventListener("keydown",I)}),ge(()=>{ee.set(!1),te.set(!1),typeof window<"u"&&window.removeEventListener("keydown",I)}),[t,s,c,r,E,u,m,a,()=>a("left"),()=>a("up"),()=>a("down"),()=>a("right"),()=>l(3,r=!r),()=>Ee("/practice-project-sveltekit-app/game")]}class Oe extends _e{constructor(e){super(),me(this,e,Te,De,he,{})}}export{Oe as component};
