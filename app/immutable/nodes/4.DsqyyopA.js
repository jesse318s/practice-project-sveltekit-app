import{s as fe,n as Y,d as _e,o as ge,f as pe}from"../chunks/scheduler.BoReh3vH.js";import{S as de,i as ue,e as w,s as C,t as P,c as S,a as E,y as he,f as D,b as V,d as v,o as R,g as N,h as _,j as z,B as F,A as me,n as U,l as K,m as ve,k as Z,u as ye,v as be,w as Ie,x as ke,q as we}from"../chunks/index.BklZDJd0.js";import{e as O}from"../chunks/each.D6YF6ztN.js";import{i as x,a as $}from"../chunks/store.Cn0GNUQE.js";import{r as X,s as j}from"../chunks/relics.CGlwEWe2.js";import{b as Se}from"../chunks/paths.Di3XXMne.js";const H=[{id:1,rocks:[{x:1,y:1},{x:3,y:3},{x:0,y:4}],exits:[{x:0,y:0,destGridId:2,spawn:{x:4,y:4}},{x:4,y:2,destGridId:2,spawn:{x:0,y:2}},{x:2,y:4,destGridId:2,spawn:{x:2,y:0}}]},{id:2,rocks:[{x:1,y:3},{x:4,y:1}],exits:[{x:0,y:4,destGridId:1,spawn:{x:4,y:0}},{x:4,y:0,destGridId:1,spawn:{x:0,y:4}},{x:2,y:0,destGridId:1,spawn:{x:2,y:4}}]}];function ee(r,e,l){const t=r.slice();return t[6]=e[l],t}function te(r){let e;return{c(){e=P("Active")},l(l){e=V(l,"Active")},m(l,t){N(l,e,t)},d(l){l&&v(e)}}}function le(r){let e,l="Buy",t,i;function o(){return r[5](r[6])}return{c(){e=w("button"),e.textContent=l,this.h()},l(s){e=S(s,"BUTTON",{class:!0,"data-svelte-h":!0}),he(e)!=="svelte-yl076z"&&(e.textContent=l),this.h()},h(){R(e,"class","svelte-7eusns")},m(s,n){N(s,e,n),t||(i=me(e,"click",o),t=!0)},p(s,n){r=s},d(s){s&&v(e),t=!1,i()}}}function se(r){let e,l,t,i,o,s=r[6].name+"",n,p,a,u,c,d=r[6].description+"",h,g,f,m,b=r[6].price+"",B,T,y,L,G=r[6].id===r[1].id&&te(),k=r[6].id!==r[1].id&&le(r);return{c(){e=w("div"),l=w("img"),i=C(),o=w("h3"),n=P(s),p=C(),a=w("p"),G&&G.c(),u=C(),c=w("p"),h=P(d),g=C(),f=w("p"),m=P("Price: "),B=P(b),T=P(" drachmas"),y=C(),k&&k.c(),L=C(),this.h()},l(A){e=S(A,"DIV",{class:!0});var I=E(e);l=S(I,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),i=D(I),o=S(I,"H3",{});var J=E(o);n=V(J,s),J.forEach(v),p=D(I),a=S(I,"P",{class:!0});var Q=E(a);G&&G.l(Q),Q.forEach(v),u=D(I),c=S(I,"P",{});var W=E(c);h=V(W,d),W.forEach(v),g=D(I),f=S(I,"P",{});var M=E(f);m=V(M,"Price: "),B=V(M,b),T=V(M," drachmas"),M.forEach(v),y=D(I),k&&k.l(I),L=D(I),I.forEach(v),this.h()},h(){_e(l.src,t=Se+"/"+r[6].img)||R(l,"src",t),R(l,"width","46px"),R(l,"height","46px"),R(l,"alt",r[6].name),R(l,"class","svelte-7eusns"),R(a,"class","active"),R(e,"class","menu-item svelte-7eusns")},m(A,I){N(A,e,I),_(e,l),_(e,i),_(e,o),_(o,n),_(e,p),_(e,a),G&&G.m(a,null),_(e,u),_(e,c),_(c,h),_(e,g),_(e,f),_(f,m),_(f,B),_(f,T),_(e,y),k&&k.m(e,null),_(e,L)},p(A,I){A[6].id===A[1].id?G||(G=te(),G.c(),G.m(a,null)):G&&(G.d(1),G=null),A[6].id!==A[1].id?k?k.p(A,I):(k=le(A),k.c(),k.m(e,L)):k&&(k.d(1),k=null)},d(A){A&&v(e),G&&G.d(),k&&k.d()}}}function Ge(r){let e,l,t="Relics",i,o,s,n,p,a,u=O(r[2]),c=[];for(let d=0;d<u.length;d+=1)c[d]=se(ee(r,u,d));return{c(){e=w("div"),l=w("h2"),l.textContent=t,i=C(),o=w("p"),s=P("Drachmas: "),n=P(r[0]),p=C(),a=w("div");for(let d=0;d<c.length;d+=1)c[d].c();this.h()},l(d){e=S(d,"DIV",{class:!0});var h=E(e);l=S(h,"H2",{"data-svelte-h":!0}),he(l)!=="svelte-2ru1w2"&&(l.textContent=t),i=D(h),o=S(h,"P",{});var g=E(o);s=V(g,"Drachmas: "),n=V(g,r[0]),g.forEach(v),p=D(h),a=S(h,"DIV",{});var f=E(a);for(let m=0;m<c.length;m+=1)c[m].l(f);f.forEach(v),h.forEach(v),this.h()},h(){R(e,"class","menu svelte-7eusns")},m(d,h){N(d,e,h),_(e,l),_(e,i),_(e,o),_(o,s),_(o,n),_(e,p),_(e,a);for(let g=0;g<c.length;g+=1)c[g]&&c[g].m(a,null)},p(d,[h]){if(h&1&&z(n,d[0]),h&14){u=O(d[2]);let g;for(g=0;g<u.length;g+=1){const f=ee(d,u,g);c[g]?c[g].p(f,h):(c[g]=se(f),c[g].c(),c[g].m(a,null))}for(;g<c.length;g+=1)c[g].d(1);c.length=u.length}},i:Y,o:Y,d(d){d&&v(e),F(c,d)}}}function Re(r,e,l){let{drachmas:t}=e,{chosenRelic:i}=e,{curGridId:o}=e;const s=X.filter(a=>a.stageId===o),n=a=>{if(t>=a.price){l(0,t-=a.price),localStorage.setItem("drachmas",t),l(1,i=a),localStorage.setItem("chosenRelicId",a.id),window.location.reload();return}alert("Not enough drachmas!")},p=a=>n(a);return r.$$set=a=>{"drachmas"in a&&l(0,t=a.drachmas),"chosenRelic"in a&&l(1,i=a.chosenRelic),"curGridId"in a&&l(4,o=a.curGridId)},[t,i,s,n,o,p]}class Ee extends de{constructor(e){super(),ue(this,e,Re,Ge,fe,{drachmas:0,chosenRelic:1,curGridId:4})}}function ie(r,e,l){const t=r.slice();return t[12]=e[l],t[14]=l,t}function re(r,e,l){const t=r.slice();return t[12]=e[l],t[16]=l,t}function ne(r){let e,l,t,i,o=O(Array(q)),s=[];for(let n=0;n<o.length;n+=1)s[n]=oe(ie(r,o,n));return{c(){e=w("h2"),l=P(r[2]),t=C(),i=w("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=S(n,"H2",{});var p=E(e);l=V(p,r[2]),p.forEach(v),t=D(n),i=S(n,"DIV",{class:!0});var a=E(i);for(let u=0;u<s.length;u+=1)s[u].l(a);a.forEach(v),this.h()},h(){R(i,"class","grid svelte-1abb3l8")},m(n,p){N(n,e,p),_(e,l),N(n,t,p),N(n,i,p);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(i,null)},p(n,p){if(p&4&&z(l,n[2]),p&195){o=O(Array(q));let a;for(a=0;a<o.length;a+=1){const u=ie(n,o,a);s[a]?s[a].p(u,p):(s[a]=oe(u),s[a].c(),s[a].m(i,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=o.length}},d(n){n&&(v(e),v(t),v(i)),F(s,n)}}}function ae(r){let e,l=r[7](r[16],r[14],r[0],r[1])+"",t,i,o;return{c(){e=w("div"),t=P(l),i=C(),this.h()},l(s){e=S(s,"DIV",{class:!0});var n=E(e);t=V(n,l),i=D(n),n.forEach(v),this.h()},h(){R(e,"class",o="cell "+r[6](r[16],r[14],r[0],r[1])+" svelte-1abb3l8")},m(s,n){N(s,e,n),_(e,t),_(e,i)},p(s,n){n&3&&l!==(l=s[7](s[16],s[14],s[0],s[1])+"")&&z(t,l),n&3&&o!==(o="cell "+s[6](s[16],s[14],s[0],s[1])+" svelte-1abb3l8")&&R(e,"class",o)},d(s){s&&v(e)}}}function oe(r){let e,l=O(Array(q)),t=[];for(let i=0;i<l.length;i+=1)t[i]=ae(re(r,l,i));return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=Z()},l(i){for(let o=0;o<t.length;o+=1)t[o].l(i);e=Z()},m(i,o){for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(i,o);N(i,e,o)},p(i,o){if(o&195){l=O(Array(q));let s;for(s=0;s<l.length;s+=1){const n=re(i,l,s);t[s]?t[s].p(n,o):(t[s]=ae(n),t[s].c(),t[s].m(e.parentNode,e))}for(;s<t.length;s+=1)t[s].d(1);t.length=l.length}},d(i){i&&v(e),F(t,i)}}}function ce(r){let e,l;return e=new Ee({props:{drachmas:r[4],chosenRelic:r[5],curGridId:r[1]}}),{c(){ye(e.$$.fragment)},l(t){be(e.$$.fragment,t)},m(t,i){Ie(e,t,i),l=!0},p(t,i){const o={};i&16&&(o.drachmas=t[4]),i&32&&(o.chosenRelic=t[5]),i&2&&(o.curGridId=t[1]),e.$set(o)},i(t){l||(U(e.$$.fragment,t),l=!0)},o(t){K(e.$$.fragment,t),l=!1},d(t){ke(e,t)}}}function Ae(r){let e,l,t,i=r[3]?"Close Relic Store":"Open Relic Store",o,s,n,p,a,u=!r[3]&&ne(r),c=r[3]&&ce(r);return{c(){e=w("div"),u&&u.c(),l=C(),t=w("button"),o=P(i),s=C(),c&&c.c(),this.h()},l(d){e=S(d,"DIV",{class:!0});var h=E(e);u&&u.l(h),l=D(h),t=S(h,"BUTTON",{class:!0});var g=E(t);o=V(g,i),g.forEach(v),s=D(h),c&&c.l(h),h.forEach(v),this.h()},h(){R(t,"class","svelte-1abb3l8"),R(e,"class","world svelte-1abb3l8")},m(d,h){N(d,e,h),u&&u.m(e,null),_(e,l),_(e,t),_(t,o),_(e,s),c&&c.m(e,null),n=!0,p||(a=me(t,"click",r[8]),p=!0)},p(d,[h]){d[3]?u&&(u.d(1),u=null):u?u.p(d,h):(u=ne(d),u.c(),u.m(e,l)),(!n||h&8)&&i!==(i=d[3]?"Close Relic Store":"Open Relic Store")&&z(o,i),d[3]?c?(c.p(d,h),h&8&&U(c,1)):(c=ce(d),c.c(),U(c,1),c.m(e,null)):c&&(we(),K(c,1,1,()=>{c=null}),ve())},i(d){n||(U(c),n=!0)},o(d){K(c),n=!1},d(d){d&&v(e),u&&u.d(),c&&c.d(),p=!1,a()}}}const q=5;function Ce(r,e,l){let t={x:2,y:2},i=1,o=j.find(f=>f.id===i).name,s=!1,n=0,p=X[0];const a=(f,m,b,B)=>{if(b.x===f&&b.y===m)return"player";const T=H.find(y=>y.id===B);return T.rocks.find(y=>y.x===f&&y.y===m)?"rock":T.exits.find(y=>y.x===f&&y.y===m)?"exit":""},u=(f,m,b,B)=>{if(b.x===f&&b.y===m)return"P";const T=H.find(y=>y.id===B);return T.rocks.find(y=>y.x===f&&y.y===m)?"":T.exits.find(y=>y.x===f&&y.y===m)?"X":""},c=f=>{f.key==="ArrowUp"&&h("up"),f.key==="ArrowDown"&&h("down"),f.key==="ArrowLeft"&&h("left"),f.key==="ArrowRight"&&h("right")},d=()=>{const f=H.find(m=>m.id===i).exits.find(m=>m.x===t.x&&m.y===t.y);f&&(l(1,i=f.destGridId),localStorage.setItem("curStageId",i),l(2,o=j.find(m=>m.id===i).name),l(0,t=f.spawn))},h=f=>{let m={...t};f==="up"&&(m.y-=1),f==="down"&&(m.y+=1),f==="left"&&(m.x-=1),f==="right"&&(m.x+=1),!(m.x<0||m.x>=q||m.y<0||m.y>=q)&&(H.find(b=>b.id===i).rocks.find(b=>b.x===m.x&&b.y===m.y)||l(0,t=m),H.find(b=>b.id===i).exits.find(b=>b.x===t.x&&b.y===t.y)&&d())};return ge(()=>{x.set(!0),$.set(!0),localStorage.getItem("curStageId")&&(l(1,i=parseInt(localStorage.getItem("curStageId"))),l(2,o=j.find(f=>f.id===i).name)),localStorage.getItem("drachmas")&&l(4,n=parseInt(localStorage.getItem("drachmas"))),localStorage.getItem("chosenRelicId")&&l(5,p=X.find(f=>f.id===parseInt(localStorage.getItem("chosenRelicId")))),typeof window<"u"&&window.addEventListener("keydown",c)}),pe(()=>{x.set(!1),$.set(!1),typeof window<"u"&&window.removeEventListener("keydown",c)}),[t,i,o,s,n,p,a,u,()=>l(3,s=!s)]}class Oe extends de{constructor(e){super(),ue(this,e,Ce,Ae,fe,{})}}export{Oe as component};
