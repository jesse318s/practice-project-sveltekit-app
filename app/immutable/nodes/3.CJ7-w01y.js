import{t as ee,a as te,e as $,s as P}from"../chunks/B_G1IST3.js";import{i as ae}from"../chunks/MmwkNIPH.js";import{ab as ie,ad as Me,ae as se,ah as _,af as g,ag as f,at as Ue,d as e,au as b,aq as Be,av as Ge,aw as Ve,ax as je,Y as t,e as fe}from"../chunks/BUi6LC3r.js";import{s as ve,r as ke}from"../chunks/Bej4_qsT.js";import{s as X,a as B,t as C,i as he}from"../chunks/CzMQxofJ.js";import{b as w,g as qe}from"../chunks/WAHIxFiR.js";import{p as A}from"../chunks/NCp_TbZO.js";import{c as ye}from"../chunks/Jce5emvo.js";const Z=[{id:1,stageId:1,name:"Demon",img:"demon_creature.png",hp:60,attack:50,attackName:"Slash",attackType:"Normal",speed:60,defense:20,critical:25,mp:100,mpRegen:25,special:75,specialCost:100,specialName:"Harvest",specialType:"Lifesteal",specialEffect:"special-effect-1"},{id:2,stageId:1,name:"Lizard",img:"lizard_creature.png",hp:110,attack:30,attackName:"Impale",attackType:"Normal",speed:30,defense:15,critical:15,mp:100,mpRegen:25,special:75,specialCost:100,specialName:"Inject",specialType:"Poison",specialEffect:"special-effect-2"},{id:3,stageId:2,name:"Medusa",img:"medusa_creature.png",hp:110,attack:30,attackName:"Gaze",attackType:"Magic",speed:30,defense:15,critical:15,mp:100,mpRegen:25,special:75,specialCost:100,specialName:"Petrify",specialType:"Magic",specialEffect:"special-effect-3"},{id:4,stageId:2,name:"Baby Dragon",img:"small_dragon_creature.png",hp:60,attack:50,attackName:"Exhale",attackType:"Magic",speed:60,defense:20,critical:25,mp:100,mpRegen:25,special:75,specialCost:100,specialName:"Fireball",specialType:"Magic",specialEffect:"special-effect-4"},{id:5,stageId:3,name:"Skeleton",img:"skeleton_creature.png",hp:125,attack:50,attackName:"Strike",attackType:"Normal",speed:30,defense:30,critical:10,mp:100,mpRegen:25,special:75,specialCost:100,specialName:"Scorch",specialType:"Magic",specialEffect:"special-effect-4"},{id:6,stageId:3,name:"Skeleton",img:"skeleton_creature_spear.png",hp:100,attack:50,attackName:"Stab",attackType:"Normal",speed:40,defense:20,critical:50,mp:100,mpRegen:25,special:75,specialCost:100,specialName:"Ruin",specialType:"Magic",specialEffect:"special-effect-2"}],_e=[{id:1,stageId:1,name:"Demon",img:"demon_creature.png",reward:3,hp:60,attack:50,attackType:"Normal",speed:60,defense:20,critical:25},{id:2,stageId:1,name:"Lizard",img:"lizard_creature.png",reward:3,hp:110,attack:30,attackType:"Normal",speed:30,defense:15,critical:15},{id:3,stageId:2,name:"Medusa",img:"medusa_creature.png",reward:5,hp:110,attack:30,attackType:"Magic",speed:30,defense:15,critical:15},{id:4,stageId:2,name:"Baby Dragon",img:"small_dragon_creature.png",reward:5,hp:60,attack:50,attackType:"Magic",speed:60,defense:20,critical:25},{id:5,stageId:3,name:"Skeleton",img:"skeleton_creature.png",reward:12,hp:125,attack:50,attackType:"Normal",speed:30,defense:30,critical:10},{id:6,stageId:3,name:"Skeleton",img:"skeleton_creature_spear.png",reward:12,hp:100,attack:50,attackType:"Normal",speed:40,defense:20,critical:50}];var Ye=ee('<section><div class="battlefield svelte-5kiki6"><div class="creatures-container svelte-5kiki6"><div class="creature player-creature svelte-5kiki6"><img width="128px" height="128px" class="svelte-5kiki6"> <div class="shadow svelte-5kiki6"></div> <div></div></div> <div class="creature enemy-creature svelte-5kiki6"><img width="128px" height="128px" class="svelte-5kiki6"> <div class="shadow svelte-5kiki6"></div> <div class="enemy-spawn-container svelte-5kiki6"><div></div></div></div></div> <div class="floor svelte-5kiki6"></div></div></section>');function Fe(m,o){ie(o,!1);let v=A(o,"stageId",8),l=A(o,"playerState",8),p=A(o,"enemyState",8);ae();var x=Ye(),a=g(x),s=g(a),E=g(s),c=g(E),k=_(c,4);f(E);var S=_(E,2),i=g(S),h=_(i,4),I=g(h);f(h),f(S),f(s),Ue(2),f(a),f(x),Me(()=>{X(x,`battle-container ${`battle-bg-${v()}`??""} svelte-5kiki6`),B(c,"src",w+"/game/"+l().creature.img),B(c,"alt",l().creature.name),C(c,"attack",l().isAttacking),C(c,"hurt",p().isAttacking),C(c,"aura",!l().isUsingSpecial),C(c,"player-using-special",l().isUsingSpecial),X(k,ye(l().isUsingSpecial?l().creature.specialEffect:""),"svelte-5kiki6"),B(i,"src",w+"/game/"+p().creature.img),B(i,"alt",p().creature.name),C(i,"enemy-attack",p().isAttacking),C(i,"enemy-hurt",l().isAttacking),C(i,"enemy-spawning",p().isSpawning),X(I,ye(p().isSpawning?"enemy-spawn":""),"svelte-5kiki6")}),te(m,x),se()}const Oe=(m,o)=>{try{const l=[{label:"Name",value:m.name},{label:"HP",value:m.hp+o.hpMod},{label:"Speed",value:m.speed+o.speedMod},{label:"Defense",value:m.defense+o.defenseMod},{label:"Critical",value:m.critical+o.criticalMod},{label:"MP",value:m.mp+o.mpMod},{label:"MP Regen",value:m.mpRegen+o.mpRegenMod},{label:`
Attack Name`,value:m.attackName},{label:"Attack",value:m.attack+o.attackMod},{label:"Attack Type",value:m.attackType},{label:`
Special Name`,value:m.specialName},{label:"Special",value:m.special+o.specialMod},{label:"Special Cost",value:m.specialCost},{label:"Special Type",value:m.specialType}].map(p=>`${p.label}: ${p.value}`).join(`
`);alert(l)}catch(v){console.error(v)}};var Je=ee("<section><button>Attack</button> <button>Special</button> <button>Mimic Summon</button> <button>View Stats</button> <button>Travel</button></section>");function Ke(m,o){ie(o,!1);let v=A(o,"battleEnemy",8),l=A(o,"playerCreature",8),p=A(o,"swapCreature",8),x=A(o,"chosenRelic",8);ae();var a=Je(),s=g(a),E=_(s,2),c=_(E,2),k=_(c,2),S=_(k,2);f(a),$("click",s,()=>v()(l().attackName,l().attackType)),$("contextmenu",s,i=>{i.preventDefault(),v()(l().specialName,l().specialType)}),$("click",E,()=>v()(l().specialName,l().specialType)),$("click",c,function(...i){var h;(h=p())==null||h.apply(this,i)}),$("click",k,()=>Oe(l(),x())),$("click",S,()=>{qe(w+"/game/world")}),te(m,a),se()}var Qe=ee('<main class="game-container svelte-ku2xkl"><section><h2> </h2> <div class="info svelte-ku2xkl"><div class="info-item svelte-ku2xkl"><div class="experience"> </div> <div class="drachmas"> </div></div> <div class="info-item svelte-ku2xkl"><div> </div> <div> </div> <div> </div></div> <div> </div></div></section> <!> <!></main>');function rt(m,o){ie(o,!1);let v=b(0),l=b(0),p=b(ve[0]),x=Z.filter(r=>r.stageId===e(p).id),a=b(x[0]),s=b(ke[0]),E=!1,c=b(e(a).hp+e(s).hpMod),k=b(e(a).mp+e(s).mpMod),S=_e.filter(r=>r.stageId===e(p).id),i=b(S[Math.floor(Math.random()*S.length)]),h=b(e(i).hp),I=b(""),re=0,N=b(!1),L=b(!1),G=b(!1),U=b(!1),z=null,V=null,ce=null,le=null;const be=()=>{if(e(k)!==e(a).mp+e(s).mpMod&&e(k)+e(a).mpRegen+e(s).mpRegenMod<=e(a).mp+e(s).mpMod){t(k,e(k)+e(a).mpRegen+e(s).mpRegenMod);return}t(k,e(a).mp+e(s).mpMod)},Se=(r,n)=>{if(e(c)-(e(i).attack-e(i).attack*r)*n<=0){t(I,"Defeat!"),t(c,0);return}t(c,e(c)-(e(i).attack-e(i).attack*r)*n)},j=(r,n,u)=>{try{const y=e(a).speed+e(s).speedMod;let d=(e(a).defense+e(s).defenseMod)/100,R=e(i).critical/100,T=1,M=!1;if(e(i).attackType==="Magic"&&(d=0),e(i).speed<y?M=Math.random()>=.5:M=Math.random()>=.8,re>1&&!M&&!r&&(M=!0),!M&&r&&t(I,"Enemy was too slow!"),!M&&!r){t(k,e(a).mp+e(s).mpMod),re+=1,oe(n,u);return}n===e(a).attackName&&be(),M&&r&&t(I,"Both abilities succeeded."),M&&!r&&t(I,"Your summon was too slow!"),M&&(Math.random()<=R&&(T=1.5),e(i).attackType==="Poison"&&T===1&&(T=1.5),Se(d,T),t(G,!0),ce=setTimeout(()=>t(G,!1),500))}catch(y){console.error(y)}},Ie=(r,n,u,y,d)=>{d==="Lifesteal"&&u&&(e(c)+r*n*.2>e(a).hp+e(s).hpMod?t(c,e(a).hp+e(s).hpMod):t(c,e(c)+r*n*.2)),j(u,y,d)},Te=(r,n,u,y,d)=>{r&&(e(c)+n*u>e(a).hp+e(s).hpMod?t(c,e(a).hp+e(s).hpMod):t(c,e(c)+n*u)),j(r,y,d)},we=(r,n,u,y,d,R,T)=>{if(t(k,e(k)-u),T!=="Heal"){if(e(h)-(n-n*d)*y<=0&&r){t(h,0),t(I,"Victory!"),t(v,e(v)+e(i).reward*2),t(l,e(l)+e(i).reward),t(N,!0),z=setTimeout(()=>t(N,!1),500),t(L,!0),V=setTimeout(()=>t(L,!1),500);return}r&&(t(h,e(h)-(n-n*d)*y),t(N,!0),z=setTimeout(()=>t(N,!1),500),t(L,!0),V=setTimeout(()=>t(L,!1),500)),Ie(n,y,r,R,T);return}Te(r,n,y,R,T)},ne=()=>{(e(c)<=0||e(h)<=0)&&(t(c,e(a).hp+e(s).hpMod),t(k,e(a).mp+e(s).mpMod),t(U,!0),le=setTimeout(()=>t(U,!1),500),t(i,S[Math.floor(Math.random()*S.length)]),document.documentElement.style.setProperty("--enemy-creature-img-hurt",`url(${w+"/game/"+e(i).img.slice(0,-4)+"_hurt.png"})`),document.documentElement.style.setProperty("--enemy-creature-img-attack",`url(${w+"/game/"+e(i).img.slice(0,-4)+"_attack.png"})`),t(h,e(i).hp),t(I,""))},oe=(r,n)=>{try{const u=e(a).attack+e(s).attackMod,y=e(a).speed+e(s).speedMod,d=(e(a).critical+e(s).criticalMod)/100;let R=e(a).special+e(s).specialMod,T=e(a).specialCost,M=e(i).defense/100,D=!1,H=1;if(e(U))return;if(ne(),n==="Magic"&&(M=0),y<e(i).speed?D=Math.random()>=.5:D=Math.random()>=.8,Math.random()<=d&&(H=1.5),n==="Poison"&&H===1&&(H=1.5),r===e(a).attackName){if(e(h)-(u-u*M)*H<=0&&D){t(h,0),t(I,"Victory!"),t(v,e(v)+e(i).reward*2),t(l,e(l)+e(i).reward),t(N,!0),z=setTimeout(()=>t(N,!1),500);return}D&&(t(h,e(h)-(u-u*M)*H),t(N,!0),z=setTimeout(()=>t(N,!1),500)),j(D,r,n);return}e(k)>=T?we(D,R,T,H,M,r,n):t(I,"Not enough MP!")}catch(u){console.error(u)}},xe=()=>{try{const r=e(i);t(c,0),ne(),t(a,Z.find(n=>n.id===r.id)),t(c,e(a).hp+e(s).hpMod),t(k,e(a).mp+e(s).mpMod),document.documentElement.style.setProperty("--player-creature-img-attack",`url(${w+"/game/"+e(a).img.slice(0,-4)+"_attack.png"})`),document.documentElement.style.setProperty("--player-creature-img-hurt",`url(${w+"/game/"+e(a).img.slice(0,-4)+"_hurt.png"})`)}catch(r){console.error(r)}},Ee=()=>{E&&(localStorage.setItem("drachmas",e(l)),localStorage.setItem("playerExperience",e(v)),localStorage.setItem("chosenRelicId",e(s).id))};Be(()=>{try{const r=localStorage.getItem("drachmas"),n=localStorage.getItem("playerExperience"),u=localStorage.getItem("chosenRelicId"),y=localStorage.getItem("curStageId");he.set(!0),r&&t(l,parseInt(r)),n&&t(v,parseInt(n)),u&&t(s,ke.find(d=>d.id===parseInt(u))),y&&t(p,ve.find(d=>d.id===parseInt(y))),x=Z.filter(d=>d.stageId===e(p).id),t(a,x[0]),t(c,e(a).hp+e(s).hpMod),t(k,e(a).mp+e(s).mpMod),document.documentElement.style.setProperty("--player-creature-img-attack",`url(${w+"/game/"+e(a).img.slice(0,-4)+"_attack.png"})`),document.documentElement.style.setProperty("--player-creature-img-hurt",`url(${w+"/game/"+e(a).img.slice(0,-4)+"_hurt.png"})`),S=_e.filter(d=>d.stageId===e(p).id),t(i,S[Math.floor(Math.random()*S.length)]),t(h,e(i).hp),document.documentElement.style.setProperty("--enemy-creature-img-hurt",`url(${w+"/game/"+e(i).img.slice(0,-4)+"_hurt.png"})`),document.documentElement.style.setProperty("--enemy-creature-img-attack",`url(${w+"/game/"+e(i).img.slice(0,-4)+"_attack.png"})`),E=!0}catch(r){console.error(r)}}),Ge(()=>{he.set(!1),clearTimeout(z),clearTimeout(V),clearTimeout(ce),clearTimeout(le)}),Ve(()=>(e(l),e(v),e(s)),()=>{e(l),e(v),e(s),Ee()}),je(),ae();var q=Qe(),Y=g(q),F=g(Y),Ne=g(F,!0);f(F);var me=_(F,2),O=g(me),J=g(O),Pe=g(J);f(J);var de=_(J,2),Ce=g(de);f(de),f(O);var K=_(O,2),Q=g(K),Ae=g(Q);f(Q);var W=_(Q,2),Re=g(W);f(W);var pe=_(W,2),De=g(pe);f(pe),f(K);var ue=_(K,2),He=g(ue,!0);f(ue),f(me),f(Y);var ge=_(Y,2);const $e=fe(()=>({creature:e(a),isAttacking:e(N),isUsingSpecial:e(L)})),Le=fe(()=>({creature:e(i),isAttacking:e(G),isSpawning:e(U)}));Fe(ge,{get stageId(){return e(p).id},get playerState(){return e($e)},get enemyState(){return e(Le)}});var ze=_(ge,2);Ke(ze,{battleEnemy:oe,get playerCreature(){return e(a)},swapCreature:xe,get chosenRelic(){return e(s)}}),f(q),Me(()=>{P(Ne,e(p).name),P(Pe,`Experience: ${e(v)??""}`),P(Ce,`Drachmas: ${e(l)??""}`),P(Ae,`Player HP: ${e(c)??""}/${e(a).hp??""}`),P(Re,`Player MP: ${e(k)??""}/${e(a).mp??""}`),P(De,`Enemy HP: ${e(h)??""}/${e(i).hp??""}`),P(He,e(I)||"The battle begins...")}),te(m,q),se()}export{rt as component};
