import{s as te,n as Q,d as Se,o as Re,f as Te,r as we}from"../chunks/scheduler.BoReh3vH.js";import{S as le,i as se,e as k,s as R,t as U,c as b,a as A,y as H,f as T,b as V,d as p,o as G,g as D,h as _,j as $,B as Z,A as L,p as X,z as De,n as j,l as F,m as ie,k as ne,u as xe,v as Ce,w as Ge,x as qe,q as re}from"../chunks/index.BklZDJd0.js";import{e as W}from"../chunks/each.D6YF6ztN.js";import{s as z,r as ee}from"../chunks/relics.Bej4_qsT.js";import{i as ae,a as oe}from"../chunks/store.Cn0GNUQE.js";import{b as Ee,g as Ae}from"../chunks/entry.kU9mRJgk.js";const J=[{id:1,stageId:1,rocks:[{x:1,y:1,type:"plain"},{x:0,y:3,type:"plain"}],exits:[{x:0,y:0,destGridId:2,spawn:{x:4,y:4}},{x:4,y:2,destGridId:2,spawn:{x:0,y:2}},{x:2,y:4,destGridId:2,spawn:{x:2,y:0}}]},{id:2,stageId:1,rocks:[{x:3,y:1,type:"smooth"}],exits:[{x:1,y:0,destGridId:1,spawn:{x:3,y:4}},{x:4,y:3,destGridId:3,spawn:{x:0,y:1}}]},{id:3,stageId:2,rocks:[{x:1,y:3,type:"smooth"},{x:4,y:1,type:"smooth"}],exits:[{x:0,y:4,destGridId:2,spawn:{x:4,y:0}},{x:4,y:0,destGridId:4,spawn:{x:0,y:4}},{x:2,y:0,destGridId:4,spawn:{x:2,y:4}}]},{id:4,stageId:2,rocks:[{x:0,y:2,type:"smooth"},{x:2,y:3,type:"plain"}],exits:[{x:1,y:4,destGridId:3,spawn:{x:3,y:0}},{x:3,y:0,destGridId:5,spawn:{x:1,y:4}}]},{id:5,stageId:3,rocks:[{x:3,y:4,type:"plain"},{x:1,y:2,type:"plain"}],exits:[{x:0,y:4,destGridId:4,spawn:{x:3,y:0}},{x:1,y:0,destGridId:6,spawn:{x:3,y:0}}]},{id:6,stageId:3,rocks:[{x:0,y:3,type:"smooth"},{x:4,y:3,type:"smooth"}],exits:[{x:0,y:0,destGridId:5,spawn:{x:3,y:0}}]}];function ce(i,e,s){const t=i.slice();return t[8]=e[s],t}function de(i){let e;return{c(){e=U("Active")},l(s){e=V(s,"Active")},m(s,t){D(s,e,t)},d(s){s&&p(e)}}}function fe(i){let e,s="Buy",t,l;function c(){return i[6](i[8])}return{c(){e=k("button"),e.textContent=s,this.h()},l(n){e=b(n,"BUTTON",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-yl076z"&&(e.textContent=s),this.h()},h(){G(e,"class","svelte-bvbif0")},m(n,o){D(n,e,o),t||(l=L(e,"click",c),t=!0)},p(n,o){i=n},d(n){n&&p(e),t=!1,l()}}}function ue(i){let e,s,t,l,c,n=i[8].name+"",o,r,f,u,a,m=i[8].description+"",N,q,C,g,w=i[8].price+"",I,x,B,M,E=i[8].id===i[1].id&&de(),y=i[8].id!==i[1].id&&fe(i);return{c(){e=k("div"),s=k("img"),l=R(),c=k("h4"),o=U(n),r=R(),f=k("p"),E&&E.c(),u=R(),a=k("p"),N=U(m),q=R(),C=k("p"),g=U("Price: "),I=U(w),x=U(" drachmas"),B=R(),y&&y.c(),M=R(),this.h()},l(d){e=b(d,"DIV",{class:!0});var h=A(e);s=b(h,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),l=T(h),c=b(h,"H4",{});var v=A(c);o=V(v,n),v.forEach(p),r=T(h),f=b(h,"P",{class:!0});var S=A(f);E&&E.l(S),S.forEach(p),u=T(h),a=b(h,"P",{});var O=A(a);N=V(O,m),O.forEach(p),q=T(h),C=b(h,"P",{});var P=A(C);g=V(P,"Price: "),I=V(P,w),x=V(P," drachmas"),P.forEach(p),B=T(h),y&&y.l(h),M=T(h),h.forEach(p),this.h()},h(){Se(s.src,t=Ee+"/game/"+i[8].img)||G(s,"src",t),G(s,"width","46px"),G(s,"height","46px"),G(s,"alt",i[8].name),G(s,"class","svelte-bvbif0"),G(f,"class","active"),G(e,"class","menu-item svelte-bvbif0")},m(d,h){D(d,e,h),_(e,s),_(e,l),_(e,c),_(c,o),_(e,r),_(e,f),E&&E.m(f,null),_(e,u),_(e,a),_(a,N),_(e,q),_(e,C),_(C,g),_(C,I),_(C,x),_(e,B),y&&y.m(e,null),_(e,M)},p(d,h){d[8].id===d[1].id?E||(E=de(),E.c(),E.m(f,null)):E&&(E.d(1),E=null),d[8].id!==d[1].id?y?y.p(d,h):(y=fe(d),y.c(),y.m(e,M)):y&&(y.d(1),y=null)},d(d){d&&p(e),E&&E.d(),y&&y.d()}}}function Ne(i){let e,s,t="Relic Store",l,c,n,o=`${i[1].name}
    (${z.find(i[5]).name})`,r,f,u,a,m,N,q,C=W(i[2]),g=[];for(let w=0;w<C.length;w+=1)g[w]=ue(ce(i,C,w));return{c(){e=k("div"),s=k("h2"),s.textContent=t,l=R(),c=k("h4"),n=U("Chosen Relic: "),r=U(o),f=R(),u=k("h4"),a=U("Drachmas: "),m=U(i[0]),N=R(),q=k("div");for(let w=0;w<g.length;w+=1)g[w].c();this.h()},l(w){e=b(w,"DIV",{class:!0});var I=A(e);s=b(I,"H2",{"data-svelte-h":!0}),H(s)!=="svelte-6gh0hs"&&(s.textContent=t),l=T(I),c=b(I,"H4",{});var x=A(c);n=V(x,"Chosen Relic: "),r=V(x,o),x.forEach(p),f=T(I),u=b(I,"H4",{});var B=A(u);a=V(B,"Drachmas: "),m=V(B,i[0]),B.forEach(p),N=T(I),q=b(I,"DIV",{});var M=A(q);for(let E=0;E<g.length;E+=1)g[E].l(M);M.forEach(p),I.forEach(p),this.h()},h(){G(e,"class","menu svelte-bvbif0")},m(w,I){D(w,e,I),_(e,s),_(e,l),_(e,c),_(c,n),_(c,r),_(e,f),_(e,u),_(u,a),_(u,m),_(e,N),_(e,q);for(let x=0;x<g.length;x+=1)g[x]&&g[x].m(q,null)},p(w,[I]){if(I&2&&o!==(o=`${w[1].name}
    (${z.find(w[5]).name})`)&&$(r,o),I&1&&$(m,w[0]),I&14){C=W(w[2]);let x;for(x=0;x<C.length;x+=1){const B=ce(w,C,x);g[x]?g[x].p(B,I):(g[x]=ue(B),g[x].c(),g[x].m(q,null))}for(;x<g.length;x+=1)g[x].d(1);g.length=C.length}},i:Q,o:Q,d(w){w&&p(e),Z(g,w)}}}function Be(i,e,s){let{drachmas:t}=e,{chosenRelic:l}=e,{curGridId:c}=e;const n=z.find(a=>a.id===J.find(m=>m.id===c).stageId),o=ee.filter(a=>a.stageId===n.id),r=a=>{try{if(t>=a.price){s(0,t-=a.price),localStorage.setItem("drachmas",t),s(1,l=a),localStorage.setItem("chosenRelicId",a.id),window.location.reload();return}alert("Not enough drachmas to spend!")}catch(m){console.error(m)}},f=a=>a.id===l.stageId,u=a=>r(a);return i.$$set=a=>{"drachmas"in a&&s(0,t=a.drachmas),"chosenRelic"in a&&s(1,l=a.chosenRelic),"curGridId"in a&&s(4,c=a.curGridId)},[t,l,o,r,c,f,u]}class Pe extends le{constructor(e){super(),se(this,e,Be,Ne,te,{drachmas:0,chosenRelic:1,curGridId:4})}}function he(i,e,s){const t=i.slice();return t[4]=e[s],t}function _e(i){let e,s,t=i[4].name+"",l,c,n,o,r=i[4].expReq+"",f,u,a,m=i[4].id===i[0].id?"(Current Stage)":"",N,q;return{c(){e=k("div"),s=k("h3"),l=U(t),c=R(),n=k("p"),o=U("Experience Requirement: "),f=U(r),u=R(),a=k("p"),N=U(m),q=R(),this.h()},l(C){e=b(C,"DIV",{class:!0,style:!0});var g=A(e);s=b(g,"H3",{class:!0});var w=A(s);l=V(w,t),w.forEach(p),c=T(g),n=b(g,"P",{class:!0});var I=A(n);o=V(I,"Experience Requirement: "),f=V(I,r),I.forEach(p),u=T(g),a=b(g,"P",{class:!0});var x=A(a);N=V(x,m),x.forEach(p),q=T(g),g.forEach(p),this.h()},h(){G(s,"class","svelte-1uosqoe"),G(n,"class","svelte-1uosqoe"),G(a,"class","svelte-1uosqoe"),G(e,"class","stage svelte-1uosqoe"),X(e,"grid-column",i[4].col),X(e,"grid-row",i[4].row),De(e,"selected",i[4].id===i[0].id)},m(C,g){D(C,e,g),_(e,s),_(s,l),_(e,c),_(e,n),_(n,o),_(n,f),_(e,u),_(e,a),_(a,N),_(e,q)},p:Q,d(C){C&&p(e)}}}function Ue(i){let e,s=W(z),t=[];for(let l=0;l<s.length;l+=1)t[l]=_e(he(i,s,l));return{c(){e=k("div");for(let l=0;l<t.length;l+=1)t[l].c();this.h()},l(l){e=b(l,"DIV",{class:!0,style:!0});var c=A(e);for(let n=0;n<t.length;n+=1)t[n].l(c);c.forEach(p),this.h()},h(){G(e,"class","world-map svelte-1uosqoe"),X(e,"grid-template-columns","repeat("+i[1]+", 1fr)"),X(e,"grid-template-rows","repeat("+i[2]+", 1fr)")},m(l,c){D(l,e,c);for(let n=0;n<t.length;n+=1)t[n]&&t[n].m(e,null)},p(l,[c]){if(c&1){s=W(z);let n;for(n=0;n<s.length;n+=1){const o=he(l,s,n);t[n]?t[n].p(o,c):(t[n]=_e(o),t[n].c(),t[n].m(e,null))}for(;n<t.length;n+=1)t[n].d(1);t.length=s.length}},i:Q,o:Q,d(l){l&&p(e),Z(t,l)}}}function Ve(i,e,s){let{curGridId:t}=e;const l=z.find(o=>o.id===J.find(r=>r.id===t).stageId);let c=Math.max(...z.map(o=>o.col)),n=Math.max(...z.map(o=>o.row));return i.$$set=o=>{"curGridId"in o&&s(3,t=o.curGridId)},[l,c,n,t]}class Oe extends le{constructor(e){super(),se(this,e,Ve,Ue,te,{curGridId:3})}}function me(i,e,s){const t=i.slice();return t[21]=e[s],t[23]=s,t}function pe(i,e,s){const t=i.slice();return t[21]=e[s],t[25]=s,t}function ve(i){let e,s,t,l,c,n,o,r,f="←",u,a,m,N="↑",q,C,g="↓",w,I,x="→",B,M,E=W(Array(Y)),y=[];for(let d=0;d<E.length;d+=1)y[d]=ye(me(i,E,d));return{c(){e=k("h2"),s=U(i[2]),t=R(),l=k("div");for(let d=0;d<y.length;d+=1)y[d].c();n=R(),o=k("div"),r=k("button"),r.textContent=f,u=R(),a=k("div"),m=k("button"),m.textContent=N,q=R(),C=k("button"),C.textContent=g,w=R(),I=k("button"),I.textContent=x,this.h()},l(d){e=b(d,"H2",{});var h=A(e);s=V(h,i[2]),h.forEach(p),t=T(d),l=b(d,"DIV",{class:!0});var v=A(l);for(let P=0;P<y.length;P+=1)y[P].l(v);v.forEach(p),n=T(d),o=b(d,"DIV",{class:!0});var S=A(o);r=b(S,"BUTTON",{class:!0,"data-svelte-h":!0}),H(r)!=="svelte-1h6m8u8"&&(r.textContent=f),u=T(S),a=b(S,"DIV",{});var O=A(a);m=b(O,"BUTTON",{class:!0,"data-svelte-h":!0}),H(m)!=="svelte-1un4tkd"&&(m.textContent=N),q=T(O),C=b(O,"BUTTON",{class:!0,"data-svelte-h":!0}),H(C)!=="svelte-16pn8vi"&&(C.textContent=g),O.forEach(p),w=T(S),I=b(S,"BUTTON",{class:!0,"data-svelte-h":!0}),H(I)!=="svelte-87vidd"&&(I.textContent=x),S.forEach(p),this.h()},h(){G(l,"class",c="grid grid-bg-"+i[1]+" svelte-sxq188"),G(r,"class","svelte-sxq188"),G(m,"class","svelte-sxq188"),G(C,"class","svelte-sxq188"),G(I,"class","svelte-sxq188"),G(o,"class","button-row")},m(d,h){D(d,e,h),_(e,s),D(d,t,h),D(d,l,h);for(let v=0;v<y.length;v+=1)y[v]&&y[v].m(l,null);D(d,n,h),D(d,o,h),_(o,r),_(o,u),_(o,a),_(a,m),_(a,q),_(a,C),_(o,w),_(o,I),B||(M=[L(r,"click",i[9]),L(m,"click",i[10]),L(C,"click",i[11]),L(I,"click",i[12])],B=!0)},p(d,h){if(h&4&&$(s,d[2]),h&195){E=W(Array(Y));let v;for(v=0;v<E.length;v+=1){const S=me(d,E,v);y[v]?y[v].p(S,h):(y[v]=ye(S),y[v].c(),y[v].m(l,null))}for(;v<y.length;v+=1)y[v].d(1);y.length=E.length}h&2&&c!==(c="grid grid-bg-"+d[1]+" svelte-sxq188")&&G(l,"class",c)},d(d){d&&(p(e),p(t),p(l),p(n),p(o)),Z(y,d),B=!1,we(M)}}}function ge(i){let e,s;return{c(){e=k("div"),this.h()},l(t){e=b(t,"DIV",{class:!0,style:!0}),A(e).forEach(p),this.h()},h(){G(e,"class",s="cell "+i[7](i[25],i[23],i[0],i[1])+" svelte-sxq188"),X(e,"background",i[7](i[25],i[23],i[0],i[1])==="player"?i[6].style:"")},m(t,l){D(t,e,l)},p(t,l){l&3&&s!==(s="cell "+t[7](t[25],t[23],t[0],t[1])+" svelte-sxq188")&&G(e,"class",s),l&67&&X(e,"background",t[7](t[25],t[23],t[0],t[1])==="player"?t[6].style:"")},d(t){t&&p(e)}}}function ye(i){let e,s=W(Array(Y)),t=[];for(let l=0;l<s.length;l+=1)t[l]=ge(pe(i,s,l));return{c(){for(let l=0;l<t.length;l+=1)t[l].c();e=ne()},l(l){for(let c=0;c<t.length;c+=1)t[c].l(l);e=ne()},m(l,c){for(let n=0;n<t.length;n+=1)t[n]&&t[n].m(l,c);D(l,e,c)},p(l,c){if(c&195){s=W(Array(Y));let n;for(n=0;n<s.length;n+=1){const o=pe(l,s,n);t[n]?t[n].p(o,c):(t[n]=ge(o),t[n].c(),t[n].m(e.parentNode,e))}for(;n<t.length;n+=1)t[n].d(1);t.length=s.length}},d(l){l&&p(e),Z(t,l)}}}function Ie(i){let e,s="Relic Store",t,l,c="World Map",n,o,r="Battle",f,u;return{c(){e=k("button"),e.textContent=s,t=R(),l=k("button"),l.textContent=c,n=R(),o=k("button"),o.textContent=r,this.h()},l(a){e=b(a,"BUTTON",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-15z0tww"&&(e.textContent=s),t=T(a),l=b(a,"BUTTON",{class:!0,"data-svelte-h":!0}),H(l)!=="svelte-c1pyeu"&&(l.textContent=c),n=T(a),o=b(a,"BUTTON",{class:!0,"data-svelte-h":!0}),H(o)!=="svelte-1th9psb"&&(o.textContent=r),this.h()},h(){G(e,"class","svelte-sxq188"),G(l,"class","svelte-sxq188"),G(o,"class","svelte-sxq188")},m(a,m){D(a,e,m),D(a,t,m),D(a,l,m),D(a,n,m),D(a,o,m),f||(u=[L(e,"click",i[13]),L(l,"click",i[14]),L(o,"click",i[15])],f=!0)},p:Q,d(a){a&&(p(e),p(t),p(l),p(n),p(o)),f=!1,we(u)}}}function ke(i){let e,s="Travel",t,l,c,n,o;return l=new Pe({props:{drachmas:i[5],chosenRelic:i[6],curGridId:i[1]}}),{c(){e=k("button"),e.textContent=s,t=R(),xe(l.$$.fragment),this.h()},l(r){e=b(r,"BUTTON",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-wcjflf"&&(e.textContent=s),t=T(r),Ce(l.$$.fragment,r),this.h()},h(){G(e,"class","svelte-sxq188")},m(r,f){D(r,e,f),D(r,t,f),Ge(l,r,f),c=!0,n||(o=L(e,"click",i[16]),n=!0)},p(r,f){const u={};f&32&&(u.drachmas=r[5]),f&64&&(u.chosenRelic=r[6]),f&2&&(u.curGridId=r[1]),l.$set(u)},i(r){c||(j(l.$$.fragment,r),c=!0)},o(r){F(l.$$.fragment,r),c=!1},d(r){r&&(p(e),p(t)),qe(l,r),n=!1,o()}}}function be(i){let e,s="Travel",t,l,c,n,o;return l=new Oe({props:{curGridId:i[1]}}),{c(){e=k("button"),e.textContent=s,t=R(),xe(l.$$.fragment),this.h()},l(r){e=b(r,"BUTTON",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-15ex2c5"&&(e.textContent=s),t=T(r),Ce(l.$$.fragment,r),this.h()},h(){G(e,"class","svelte-sxq188")},m(r,f){D(r,e,f),D(r,t,f),Ge(l,r,f),c=!0,n||(o=L(e,"click",i[17]),n=!0)},p(r,f){const u={};f&2&&(u.curGridId=r[1]),l.$set(u)},i(r){c||(j(l.$$.fragment,r),c=!0)},o(r){F(l.$$.fragment,r),c=!1},d(r){r&&(p(e),p(t)),qe(l,r),n=!1,o()}}}function Me(i){let e,s,t,l,c,n,o=!i[3]&&!i[4]&&ve(i),r=!i[3]&&!i[4]&&Ie(i),f=i[3]&&ke(i),u=i[4]&&be(i);return{c(){e=k("div"),o&&o.c(),s=R(),t=k("div"),r&&r.c(),l=R(),f&&f.c(),c=R(),u&&u.c(),this.h()},l(a){e=b(a,"DIV",{class:!0});var m=A(e);o&&o.l(m),s=T(m),t=b(m,"DIV",{class:!0});var N=A(t);r&&r.l(N),N.forEach(p),l=T(m),f&&f.l(m),c=T(m),u&&u.l(m),m.forEach(p),this.h()},h(){G(t,"class","button-row"),G(e,"class","game-container svelte-sxq188")},m(a,m){D(a,e,m),o&&o.m(e,null),_(e,s),_(e,t),r&&r.m(t,null),_(e,l),f&&f.m(e,null),_(e,c),u&&u.m(e,null),n=!0},p(a,[m]){!a[3]&&!a[4]?o?o.p(a,m):(o=ve(a),o.c(),o.m(e,s)):o&&(o.d(1),o=null),!a[3]&&!a[4]?r?r.p(a,m):(r=Ie(a),r.c(),r.m(t,null)):r&&(r.d(1),r=null),a[3]?f?(f.p(a,m),m&8&&j(f,1)):(f=ke(a),f.c(),j(f,1),f.m(e,c)):f&&(re(),F(f,1,1,()=>{f=null}),ie()),a[4]?u?(u.p(a,m),m&16&&j(u,1)):(u=be(a),u.c(),j(u,1),u.m(e,null)):u&&(re(),F(u,1,1,()=>{u=null}),ie())},i(a){n||(j(f),j(u),n=!0)},o(a){F(f),F(u),n=!1},d(a){a&&p(e),o&&o.d(),r&&r.d(),f&&f.d(),u&&u.d()}}}const Y=5;function He(i,e,s){let t={x:2,y:2},l=1,c=z[0].name,n=!1,o=!1,r=0,f=0,u=ee[0];const a=d=>{d.key==="ArrowUp"&&(d.preventDefault(),q("up")),d.key==="ArrowDown"&&(d.preventDefault(),q("down")),d.key==="ArrowLeft"&&(d.preventDefault(),q("left")),d.key==="ArrowRight"&&(d.preventDefault(),q("right"))},m=(d,h,v,S)=>{try{if(v.x===d&&v.y===h)return"player";const O=J.find(K=>K.id===S),P=O.rocks.find(K=>K.x===d&&K.y===h);return(P==null?void 0:P.type)==="plain"?"rock-plain":(P==null?void 0:P.type)==="smooth"?"rock-smooth":O.exits.find(K=>K.x===d&&K.y===h)?"exit":""}catch(O){console.error(O)}},N=()=>{const d=J.find(v=>v.id===l).exits.find(v=>v.x===t.x&&v.y===t.y),h=z.find(v=>v.id===J.find(S=>S.id===d.destGridId).stageId);if(r<h.expReq){alert("Not enough experience to use portal! (Requires "+h.expReq+" experience)");return}d&&(s(1,l=d.destGridId),localStorage.setItem("curStageId",h.id),localStorage.setItem("gridId",l),s(2,c=h.name),s(0,t=d.spawn))},q=d=>{try{let h={...t};if(d==="up"&&(h.y-=1),d==="down"&&(h.y+=1),d==="left"&&(h.x-=1),d==="right"&&(h.x+=1),h.x<0||h.x>=Y||h.y<0||h.y>=Y)return;const v=J.find(S=>S.id===l);v.rocks.find(S=>S.x===h.x&&S.y===h.y)||s(0,t=h),v.exits.find(S=>S.x===t.x&&S.y===t.y)&&N()}catch(h){console.error(h)}};return Re(()=>{ae.set(!0),oe.set(!0),localStorage.getItem("curStageId")&&s(2,c=z.find(d=>d.id===parseInt(localStorage.getItem("curStageId"))).name),localStorage.getItem("gridId")&&s(1,l=parseInt(localStorage.getItem("gridId"))),localStorage.getItem("playerExperience")&&(r=parseInt(localStorage.getItem("playerExperience"))),localStorage.getItem("drachmas")&&s(5,f=parseInt(localStorage.getItem("drachmas"))),localStorage.getItem("chosenRelicId")&&s(6,u=ee.find(d=>d.id===parseInt(localStorage.getItem("chosenRelicId")))),typeof window<"u"&&window.addEventListener("keydown",a)}),Te(()=>{ae.set(!1),oe.set(!1),typeof window<"u"&&window.removeEventListener("keydown",a)}),[t,l,c,n,o,f,u,m,q,()=>q("left"),()=>q("up"),()=>q("down"),()=>q("right"),()=>s(3,n=!0),()=>s(4,o=!0),()=>Ae(Ee+"/game"),()=>s(3,n=!1),()=>s(4,o=!1)]}class Je extends le{constructor(e){super(),se(this,e,He,Me,te,{})}}export{Je as component};
