import{s as fe,n as X,d as _e,o as ge,f as pe}from"../chunks/scheduler.BoReh3vH.js";import{S as de,i as he,e as k,s as A,t as P,c as w,a as R,y as ue,f as C,b as V,d as v,o as G,g as N,h as _,j as z,B as F,A as me,n as U,l as K,m as ve,k as Y,u as ye,v as Ie,w as be,x as ke,q as we}from"../chunks/index.BklZDJd0.js";import{e as O}from"../chunks/each.D6YF6ztN.js";import{i as Z,a as $}from"../chunks/store.Cn0GNUQE.js";import{r as x,s as j}from"../chunks/relics.CGlwEWe2.js";import{b as Se}from"../chunks/paths.B_u_6uSR.js";const M=[{id:1,rocks:[{x:1,y:1},{x:3,y:3},{x:0,y:4}],exits:[{x:0,y:0,destGridId:2,spawn:{x:4,y:4}},{x:4,y:2,destGridId:2,spawn:{x:0,y:2}},{x:2,y:4,destGridId:2,spawn:{x:2,y:0}}]},{id:2,rocks:[{x:1,y:3},{x:4,y:1}],exits:[{x:0,y:4,destGridId:1,spawn:{x:4,y:0}},{x:4,y:0,destGridId:1,spawn:{x:0,y:4}},{x:2,y:0,destGridId:1,spawn:{x:2,y:4}}]}];function ee(r,e,l){const t=r.slice();return t[6]=e[l],t}function te(r){let e;return{c(){e=P("Active")},l(l){e=V(l,"Active")},m(l,t){N(l,e,t)},d(l){l&&v(e)}}}function le(r){let e,l="Buy",t,i;function o(){return r[5](r[6])}return{c(){e=k("button"),e.textContent=l,this.h()},l(s){e=w(s,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(e)!=="svelte-yl076z"&&(e.textContent=l),this.h()},h(){G(e,"class","svelte-7eusns")},m(s,n){N(s,e,n),t||(i=me(e,"click",o),t=!0)},p(s,n){r=s},d(s){s&&v(e),t=!1,i()}}}function se(r){let e,l,t,i,o,s=r[6].name+"",n,p,a,h,c,f=r[6].description+"",u,g,d,m,y=r[6].price+"",T,B,D,H,S=r[6].id===r[1].id&&te(),b=r[6].id!==r[1].id&&le(r);return{c(){e=k("div"),l=k("img"),i=A(),o=k("h3"),n=P(s),p=A(),a=k("p"),S&&S.c(),h=A(),c=k("p"),u=P(f),g=A(),d=k("p"),m=P("Price: "),T=P(y),B=P(" drachmas"),D=A(),b&&b.c(),H=A(),this.h()},l(E){e=w(E,"DIV",{class:!0});var I=R(e);l=w(I,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),i=C(I),o=w(I,"H3",{});var J=R(o);n=V(J,s),J.forEach(v),p=C(I),a=w(I,"P",{class:!0});var Q=R(a);S&&S.l(Q),Q.forEach(v),h=C(I),c=w(I,"P",{});var W=R(c);u=V(W,f),W.forEach(v),g=C(I),d=w(I,"P",{});var L=R(d);m=V(L,"Price: "),T=V(L,y),B=V(L," drachmas"),L.forEach(v),D=C(I),b&&b.l(I),H=C(I),I.forEach(v),this.h()},h(){_e(l.src,t=Se+"/"+r[6].img)||G(l,"src",t),G(l,"width","46px"),G(l,"height","46px"),G(l,"alt",r[6].name),G(l,"class","svelte-7eusns"),G(a,"class","active"),G(e,"class","menu-item svelte-7eusns")},m(E,I){N(E,e,I),_(e,l),_(e,i),_(e,o),_(o,n),_(e,p),_(e,a),S&&S.m(a,null),_(e,h),_(e,c),_(c,u),_(e,g),_(e,d),_(d,m),_(d,T),_(d,B),_(e,D),b&&b.m(e,null),_(e,H)},p(E,I){E[6].id===E[1].id?S||(S=te(),S.c(),S.m(a,null)):S&&(S.d(1),S=null),E[6].id!==E[1].id?b?b.p(E,I):(b=le(E),b.c(),b.m(e,H)):b&&(b.d(1),b=null)},d(E){E&&v(e),S&&S.d(),b&&b.d()}}}function Ge(r){let e,l,t="Relics",i,o,s,n,p,a,h=O(r[2]),c=[];for(let f=0;f<h.length;f+=1)c[f]=se(ee(r,h,f));return{c(){e=k("div"),l=k("h2"),l.textContent=t,i=A(),o=k("p"),s=P("Drachmas: "),n=P(r[0]),p=A(),a=k("div");for(let f=0;f<c.length;f+=1)c[f].c();this.h()},l(f){e=w(f,"DIV",{class:!0});var u=R(e);l=w(u,"H2",{"data-svelte-h":!0}),ue(l)!=="svelte-2ru1w2"&&(l.textContent=t),i=C(u),o=w(u,"P",{});var g=R(o);s=V(g,"Drachmas: "),n=V(g,r[0]),g.forEach(v),p=C(u),a=w(u,"DIV",{});var d=R(a);for(let m=0;m<c.length;m+=1)c[m].l(d);d.forEach(v),u.forEach(v),this.h()},h(){G(e,"class","menu svelte-7eusns")},m(f,u){N(f,e,u),_(e,l),_(e,i),_(e,o),_(o,s),_(o,n),_(e,p),_(e,a);for(let g=0;g<c.length;g+=1)c[g]&&c[g].m(a,null)},p(f,[u]){if(u&1&&z(n,f[0]),u&14){h=O(f[2]);let g;for(g=0;g<h.length;g+=1){const d=ee(f,h,g);c[g]?c[g].p(d,u):(c[g]=se(d),c[g].c(),c[g].m(a,null))}for(;g<c.length;g+=1)c[g].d(1);c.length=h.length}},i:X,o:X,d(f){f&&v(e),F(c,f)}}}function Re(r,e,l){let{drachmas:t}=e,{chosenRelic:i}=e,{curGridId:o}=e;const s=x.filter(a=>a.stageId===o),n=a=>{if(t>=a.price){l(0,t-=a.price),localStorage.setItem("drachmas",t),l(1,i=a),localStorage.setItem("chosenRelicId",a.id),window.location.reload();return}alert("Not enough drachmas!")},p=a=>n(a);return r.$$set=a=>{"drachmas"in a&&l(0,t=a.drachmas),"chosenRelic"in a&&l(1,i=a.chosenRelic),"curGridId"in a&&l(4,o=a.curGridId)},[t,i,s,n,o,p]}class Ee extends de{constructor(e){super(),he(this,e,Re,Ge,fe,{drachmas:0,chosenRelic:1,curGridId:4})}}function ie(r,e,l){const t=r.slice();return t[12]=e[l],t[14]=l,t}function re(r,e,l){const t=r.slice();return t[12]=e[l],t[16]=l,t}function ne(r){let e,l,t,i,o=O(Array(q)),s=[];for(let n=0;n<o.length;n+=1)s[n]=oe(ie(r,o,n));return{c(){e=k("h2"),l=P(r[2]),t=A(),i=k("div");for(let n=0;n<s.length;n+=1)s[n].c();this.h()},l(n){e=w(n,"H2",{});var p=R(e);l=V(p,r[2]),p.forEach(v),t=C(n),i=w(n,"DIV",{class:!0});var a=R(i);for(let h=0;h<s.length;h+=1)s[h].l(a);a.forEach(v),this.h()},h(){G(i,"class","grid svelte-1abb3l8")},m(n,p){N(n,e,p),_(e,l),N(n,t,p),N(n,i,p);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(i,null)},p(n,p){if(p&4&&z(l,n[2]),p&195){o=O(Array(q));let a;for(a=0;a<o.length;a+=1){const h=ie(n,o,a);s[a]?s[a].p(h,p):(s[a]=oe(h),s[a].c(),s[a].m(i,null))}for(;a<s.length;a+=1)s[a].d(1);s.length=o.length}},d(n){n&&(v(e),v(t),v(i)),F(s,n)}}}function ae(r){let e,l=r[7](r[16],r[14],r[0],r[1])+"",t,i,o;return{c(){e=k("div"),t=P(l),i=A(),this.h()},l(s){e=w(s,"DIV",{class:!0});var n=R(e);t=V(n,l),i=C(n),n.forEach(v),this.h()},h(){G(e,"class",o="cell "+r[6](r[16],r[14],r[0],r[1])+" svelte-1abb3l8")},m(s,n){N(s,e,n),_(e,t),_(e,i)},p(s,n){n&3&&l!==(l=s[7](s[16],s[14],s[0],s[1])+"")&&z(t,l),n&3&&o!==(o="cell "+s[6](s[16],s[14],s[0],s[1])+" svelte-1abb3l8")&&G(e,"class",o)},d(s){s&&v(e)}}}function oe(r){let e,l=O(Array(q)),t=[];for(let i=0;i<l.length;i+=1)t[i]=ae(re(r,l,i));return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=Y()},l(i){for(let o=0;o<t.length;o+=1)t[o].l(i);e=Y()},m(i,o){for(let s=0;s<t.length;s+=1)t[s]&&t[s].m(i,o);N(i,e,o)},p(i,o){if(o&195){l=O(Array(q));let s;for(s=0;s<l.length;s+=1){const n=re(i,l,s);t[s]?t[s].p(n,o):(t[s]=ae(n),t[s].c(),t[s].m(e.parentNode,e))}for(;s<t.length;s+=1)t[s].d(1);t.length=l.length}},d(i){i&&v(e),F(t,i)}}}function ce(r){let e,l;return e=new Ee({props:{drachmas:r[4],chosenRelic:r[5],curGridId:r[1]}}),{c(){ye(e.$$.fragment)},l(t){Ie(e.$$.fragment,t)},m(t,i){be(e,t,i),l=!0},p(t,i){const o={};i&16&&(o.drachmas=t[4]),i&32&&(o.chosenRelic=t[5]),i&2&&(o.curGridId=t[1]),e.$set(o)},i(t){l||(U(e.$$.fragment,t),l=!0)},o(t){K(e.$$.fragment,t),l=!1},d(t){ke(e,t)}}}function Ae(r){let e,l,t,i=r[3]?"Close Relic Store":"Open Relic Store",o,s,n,p,a,h=!r[3]&&ne(r),c=r[3]&&ce(r);return{c(){e=k("div"),h&&h.c(),l=A(),t=k("button"),o=P(i),s=A(),c&&c.c(),this.h()},l(f){e=w(f,"DIV",{class:!0});var u=R(e);h&&h.l(u),l=C(u),t=w(u,"BUTTON",{class:!0});var g=R(t);o=V(g,i),g.forEach(v),s=C(u),c&&c.l(u),u.forEach(v),this.h()},h(){G(t,"class","svelte-1abb3l8"),G(e,"class","world svelte-1abb3l8")},m(f,u){N(f,e,u),h&&h.m(e,null),_(e,l),_(e,t),_(t,o),_(e,s),c&&c.m(e,null),n=!0,p||(a=me(t,"click",r[8]),p=!0)},p(f,[u]){f[3]?h&&(h.d(1),h=null):h?h.p(f,u):(h=ne(f),h.c(),h.m(e,l)),(!n||u&8)&&i!==(i=f[3]?"Close Relic Store":"Open Relic Store")&&z(o,i),f[3]?c?(c.p(f,u),u&8&&U(c,1)):(c=ce(f),c.c(),U(c,1),c.m(e,null)):c&&(we(),K(c,1,1,()=>{c=null}),ve())},i(f){n||(U(c),n=!0)},o(f){K(c),n=!1},d(f){f&&v(e),h&&h.d(),c&&c.d(),p=!1,a()}}}const q=5;function Ce(r,e,l){let t={x:2,y:2},i=1,o=j.find(d=>d.id===i).name,s=!1,n=0,p=x[0];const a=(d,m,y,T)=>{if(y.x===d&&y.y===m)return"player";const B=M.find(D=>D.id===T);return B.rocks.find(D=>D.x===d&&D.y===m)?"rock":B.exits.find(D=>D.x===d&&D.y===m)?"exit":""},h=(d,m,y,T)=>{if(y.x===d&&y.y===m)return"P"},c=d=>{d.key==="ArrowUp"&&u("up"),d.key==="ArrowDown"&&u("down"),d.key==="ArrowLeft"&&u("left"),d.key==="ArrowRight"&&u("right")},f=()=>{const d=M.find(m=>m.id===i).exits.find(m=>m.x===t.x&&m.y===t.y);d&&(l(1,i=d.destGridId),localStorage.setItem("curStageId",i),l(2,o=j.find(m=>m.id===i).name),l(0,t=d.spawn))},u=d=>{let m={...t};d==="up"&&(m.y-=1),d==="down"&&(m.y+=1),d==="left"&&(m.x-=1),d==="right"&&(m.x+=1),!(m.x<0||m.x>=q||m.y<0||m.y>=q)&&(M.find(y=>y.id===i).rocks.find(y=>y.x===m.x&&y.y===m.y)||l(0,t=m),M.find(y=>y.id===i).exits.find(y=>y.x===t.x&&y.y===t.y)&&f())};return ge(()=>{Z.set(!0),$.set(!0),localStorage.getItem("curStageId")&&(l(1,i=parseInt(localStorage.getItem("curStageId"))),l(2,o=j.find(d=>d.id===i).name)),localStorage.getItem("drachmas")&&l(4,n=parseInt(localStorage.getItem("drachmas"))),localStorage.getItem("chosenRelicId")&&l(5,p=x.find(d=>d.id===parseInt(localStorage.getItem("chosenRelicId")))),typeof window<"u"&&window.addEventListener("keydown",c)}),pe(()=>{Z.set(!1),$.set(!1),typeof window<"u"&&window.removeEventListener("keydown",c)}),[t,i,o,s,n,p,a,h,()=>l(3,s=!s)]}class Oe extends de{constructor(e){super(),he(this,e,Ce,Ae,fe,{})}}export{Oe as component};
