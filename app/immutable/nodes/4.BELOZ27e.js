import{s as ue,n as Z,d as me,o as pe,f as ge,r as ve}from"../chunks/scheduler.BoReh3vH.js";import{S as he,i as _e,e as b,s as E,t as N,c as x,a as T,y as O,f as A,b as P,d as w,o as C,g as D,h as p,j as Q,B as W,A as q,n as j,l as F,m as ye,k as $,u as ke,v as Ie,w as we,x as be,q as xe}from"../chunks/index.BklZDJd0.js";import{e as z}from"../chunks/each.D6YF6ztN.js";import{r as J,s as M}from"../chunks/relics.CGlwEWe2.js";import{i as ee,a as te}from"../chunks/store.Cn0GNUQE.js";import{b as Se}from"../chunks/paths.C7Km3_T4.js";const K=[{id:1,rocks:[{x:1,y:1},{x:3,y:3},{x:0,y:3}],exits:[{x:0,y:0,destGridId:2,spawn:{x:4,y:4}},{x:4,y:2,destGridId:2,spawn:{x:0,y:2}},{x:2,y:4,destGridId:2,spawn:{x:2,y:0}}]},{id:2,rocks:[{x:1,y:3},{x:4,y:1}],exits:[{x:0,y:4,destGridId:1,spawn:{x:4,y:0}},{x:4,y:0,destGridId:1,spawn:{x:0,y:4}},{x:2,y:0,destGridId:1,spawn:{x:2,y:4}}]}];function le(r,e,l){const t=r.slice();return t[6]=e[l],t}function se(r){let e;return{c(){e=N("Active")},l(l){e=P(l,"Active")},m(l,t){D(l,e,t)},d(l){l&&w(e)}}}function re(r){let e,l="Buy",t,s;function o(){return r[5](r[6])}return{c(){e=b("button"),e.textContent=l,this.h()},l(n){e=x(n,"BUTTON",{class:!0,"data-svelte-h":!0}),O(e)!=="svelte-yl076z"&&(e.textContent=l),this.h()},h(){C(e,"class","svelte-7eusns")},m(n,_){D(n,e,_),t||(s=q(e,"click",o),t=!0)},p(n,_){r=n},d(n){n&&w(e),t=!1,s()}}}function ne(r){let e,l,t,s,o,n=r[6].name+"",_,S,u,h,a,f=r[6].description+"",c,g,R,G,U=r[6].price+"",B,y,m,I,i=r[6].id===r[1].id&&se(),v=r[6].id!==r[1].id&&re(r);return{c(){e=b("div"),l=b("img"),s=E(),o=b("h3"),_=N(n),S=E(),u=b("p"),i&&i.c(),h=E(),a=b("p"),c=N(f),g=E(),R=b("p"),G=N("Price: "),B=N(U),y=N(" drachmas"),m=E(),v&&v.c(),I=E(),this.h()},l(d){e=x(d,"DIV",{class:!0});var k=T(e);l=x(k,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),s=A(k),o=x(k,"H3",{});var V=T(o);_=P(V,n),V.forEach(w),S=A(k),u=x(k,"P",{class:!0});var X=T(u);i&&i.l(X),X.forEach(w),h=A(k),a=x(k,"P",{});var Y=T(a);c=P(Y,f),Y.forEach(w),g=A(k),R=x(k,"P",{});var H=T(R);G=P(H,"Price: "),B=P(H,U),y=P(H," drachmas"),H.forEach(w),m=A(k),v&&v.l(k),I=A(k),k.forEach(w),this.h()},h(){me(l.src,t=Se+"/"+r[6].img)||C(l,"src",t),C(l,"width","46px"),C(l,"height","46px"),C(l,"alt",r[6].name),C(l,"class","svelte-7eusns"),C(u,"class","active"),C(e,"class","menu-item svelte-7eusns")},m(d,k){D(d,e,k),p(e,l),p(e,s),p(e,o),p(o,_),p(e,S),p(e,u),i&&i.m(u,null),p(e,h),p(e,a),p(a,c),p(e,g),p(e,R),p(R,G),p(R,B),p(R,y),p(e,m),v&&v.m(e,null),p(e,I)},p(d,k){d[6].id===d[1].id?i||(i=se(),i.c(),i.m(u,null)):i&&(i.d(1),i=null),d[6].id!==d[1].id?v?v.p(d,k):(v=re(d),v.c(),v.m(e,I)):v&&(v.d(1),v=null)},d(d){d&&w(e),i&&i.d(),v&&v.d()}}}function Ce(r){let e,l,t="Relic Store",s,o,n,_,S,u,h=z(r[2]),a=[];for(let f=0;f<h.length;f+=1)a[f]=ne(le(r,h,f));return{c(){e=b("div"),l=b("h2"),l.textContent=t,s=E(),o=b("p"),n=N("Drachmas: "),_=N(r[0]),S=E(),u=b("div");for(let f=0;f<a.length;f+=1)a[f].c();this.h()},l(f){e=x(f,"DIV",{class:!0});var c=T(e);l=x(c,"H2",{"data-svelte-h":!0}),O(l)!=="svelte-6gh0hs"&&(l.textContent=t),s=A(c),o=x(c,"P",{});var g=T(o);n=P(g,"Drachmas: "),_=P(g,r[0]),g.forEach(w),S=A(c),u=x(c,"DIV",{});var R=T(u);for(let G=0;G<a.length;G+=1)a[G].l(R);R.forEach(w),c.forEach(w),this.h()},h(){C(e,"class","menu svelte-7eusns")},m(f,c){D(f,e,c),p(e,l),p(e,s),p(e,o),p(o,n),p(o,_),p(e,S),p(e,u);for(let g=0;g<a.length;g+=1)a[g]&&a[g].m(u,null)},p(f,[c]){if(c&1&&Q(_,f[0]),c&14){h=z(f[2]);let g;for(g=0;g<h.length;g+=1){const R=le(f,h,g);a[g]?a[g].p(R,c):(a[g]=ne(R),a[g].c(),a[g].m(u,null))}for(;g<a.length;g+=1)a[g].d(1);a.length=h.length}},i:Z,o:Z,d(f){f&&w(e),W(a,f)}}}function Re(r,e,l){let{drachmas:t}=e,{chosenRelic:s}=e,{curGridId:o}=e;const n=J.filter(u=>u.stageId===o),_=u=>{if(t>=u.price){l(0,t-=u.price),localStorage.setItem("drachmas",t),l(1,s=u),localStorage.setItem("chosenRelicId",u.id),window.location.reload();return}alert("Not enough drachmas to spend!")},S=u=>_(u);return r.$$set=u=>{"drachmas"in u&&l(0,t=u.drachmas),"chosenRelic"in u&&l(1,s=u.chosenRelic),"curGridId"in u&&l(4,o=u.curGridId)},[t,s,n,_,o,S]}class Ge extends he{constructor(e){super(),_e(this,e,Re,Ce,ue,{drachmas:0,chosenRelic:1,curGridId:4})}}function ie(r,e,l){const t=r.slice();return t[16]=e[l],t[18]=l,t}function ae(r,e,l){const t=r.slice();return t[16]=e[l],t[20]=l,t}function ce(r){let e,l,t,s,o,n,_,S="Left",u,h,a="Right",f,c,g="Down",R,G,U="Up",B,y,m=z(Array(L)),I=[];for(let i=0;i<m.length;i+=1)I[i]=fe(ie(r,m,i));return{c(){e=b("h2"),l=N(r[2]),t=E(),s=b("div");for(let i=0;i<I.length;i+=1)I[i].c();o=E(),n=b("div"),_=b("button"),_.textContent=S,u=E(),h=b("button"),h.textContent=a,f=E(),c=b("button"),c.textContent=g,R=E(),G=b("button"),G.textContent=U,this.h()},l(i){e=x(i,"H2",{});var v=T(e);l=P(v,r[2]),v.forEach(w),t=A(i),s=x(i,"DIV",{class:!0});var d=T(s);for(let V=0;V<I.length;V+=1)I[V].l(d);d.forEach(w),o=A(i),n=x(i,"DIV",{class:!0});var k=T(n);_=x(k,"BUTTON",{class:!0,"data-svelte-h":!0}),O(_)!=="svelte-b3x30h"&&(_.textContent=S),u=A(k),h=x(k,"BUTTON",{class:!0,"data-svelte-h":!0}),O(h)!=="svelte-du436l"&&(h.textContent=a),f=A(k),c=x(k,"BUTTON",{class:!0,"data-svelte-h":!0}),O(c)!=="svelte-1x8a6xp"&&(c.textContent=g),R=A(k),G=x(k,"BUTTON",{class:!0,"data-svelte-h":!0}),O(G)!=="svelte-zcznvd"&&(G.textContent=U),k.forEach(w),this.h()},h(){C(s,"class","grid svelte-5urrna"),C(_,"class","svelte-5urrna"),C(h,"class","svelte-5urrna"),C(c,"class","svelte-5urrna"),C(G,"class","svelte-5urrna"),C(n,"class","controls svelte-5urrna")},m(i,v){D(i,e,v),p(e,l),D(i,t,v),D(i,s,v);for(let d=0;d<I.length;d+=1)I[d]&&I[d].m(s,null);D(i,o,v),D(i,n,v),p(n,_),p(n,u),p(n,h),p(n,f),p(n,c),p(n,R),p(n,G),B||(y=[q(_,"click",r[8]),q(h,"click",r[9]),q(c,"click",r[10]),q(G,"click",r[11])],B=!0)},p(i,v){if(v&4&&Q(l,i[2]),v&67){m=z(Array(L));let d;for(d=0;d<m.length;d+=1){const k=ie(i,m,d);I[d]?I[d].p(k,v):(I[d]=fe(k),I[d].c(),I[d].m(s,null))}for(;d<I.length;d+=1)I[d].d(1);I.length=m.length}},d(i){i&&(w(e),w(t),w(s),w(o),w(n)),W(I,i),B=!1,ve(y)}}}function oe(r){let e,l;return{c(){e=b("div"),this.h()},l(t){e=x(t,"DIV",{class:!0}),T(e).forEach(w),this.h()},h(){C(e,"class",l="cell "+r[6](r[20],r[18],r[0],r[1])+" svelte-5urrna")},m(t,s){D(t,e,s)},p(t,s){s&3&&l!==(l="cell "+t[6](t[20],t[18],t[0],t[1])+" svelte-5urrna")&&C(e,"class",l)},d(t){t&&w(e)}}}function fe(r){let e,l=z(Array(L)),t=[];for(let s=0;s<l.length;s+=1)t[s]=oe(ae(r,l,s));return{c(){for(let s=0;s<t.length;s+=1)t[s].c();e=$()},l(s){for(let o=0;o<t.length;o+=1)t[o].l(s);e=$()},m(s,o){for(let n=0;n<t.length;n+=1)t[n]&&t[n].m(s,o);D(s,e,o)},p(s,o){if(o&67){l=z(Array(L));let n;for(n=0;n<l.length;n+=1){const _=ae(s,l,n);t[n]?t[n].p(_,o):(t[n]=oe(_),t[n].c(),t[n].m(e.parentNode,e))}for(;n<t.length;n+=1)t[n].d(1);t.length=l.length}},d(s){s&&w(e),W(t,s)}}}function de(r){let e,l;return e=new Ge({props:{drachmas:r[4],chosenRelic:r[5],curGridId:r[1]}}),{c(){ke(e.$$.fragment)},l(t){Ie(e.$$.fragment,t)},m(t,s){we(e,t,s),l=!0},p(t,s){const o={};s&16&&(o.drachmas=t[4]),s&32&&(o.chosenRelic=t[5]),s&2&&(o.curGridId=t[1]),e.$set(o)},i(t){l||(j(e.$$.fragment,t),l=!0)},o(t){F(e.$$.fragment,t),l=!1},d(t){be(e,t)}}}function Ee(r){let e,l,t,s=r[3]?"Close Relic Store":"Relic Store",o,n,_,S,u,h=!r[3]&&ce(r),a=r[3]&&de(r);return{c(){e=b("div"),h&&h.c(),l=E(),t=b("button"),o=N(s),n=E(),a&&a.c(),this.h()},l(f){e=x(f,"DIV",{class:!0});var c=T(e);h&&h.l(c),l=A(c),t=x(c,"BUTTON",{class:!0});var g=T(t);o=P(g,s),g.forEach(w),n=A(c),a&&a.l(c),c.forEach(w),this.h()},h(){C(t,"class","svelte-5urrna"),C(e,"class","world svelte-5urrna")},m(f,c){D(f,e,c),h&&h.m(e,null),p(e,l),p(e,t),p(t,o),p(e,n),a&&a.m(e,null),_=!0,S||(u=q(t,"click",r[12]),S=!0)},p(f,[c]){f[3]?h&&(h.d(1),h=null):h?h.p(f,c):(h=ce(f),h.c(),h.m(e,l)),(!_||c&8)&&s!==(s=f[3]?"Close Relic Store":"Relic Store")&&Q(o,s),f[3]?a?(a.p(f,c),c&8&&j(a,1)):(a=de(f),a.c(),j(a,1),a.m(e,null)):a&&(xe(),F(a,1,1,()=>{a=null}),ye())},i(f){_||(j(a),_=!0)},o(f){F(a),_=!1},d(f){f&&w(e),h&&h.d(),a&&a.d(),S=!1,u()}}}const L=5;function Ae(r,e,l){let t={x:2,y:2},s=1,o=M.find(y=>y.id===s).name,n=!1,_=0,S=0,u=J[0];const h=y=>{y.key==="ArrowUp"&&c("up"),y.key==="ArrowDown"&&c("down"),y.key==="ArrowLeft"&&c("left"),y.key==="ArrowRight"&&c("right")},a=(y,m,I,i)=>{if(I.x===y&&I.y===m)return"player";const v=K.find(d=>d.id===i);return v.rocks.find(d=>d.x===y&&d.y===m)?"rock":v.exits.find(d=>d.x===y&&d.y===m)?"exit":""},f=()=>{const y=K.find(m=>m.id===s).exits.find(m=>m.x===t.x&&m.y===t.y);if(_<M.find(m=>m.id===y.destGridId).expReq){alert("Not enough experience to enter!");return}y&&(l(1,s=y.destGridId),localStorage.setItem("curStageId",s),l(2,o=M.find(m=>m.id===s).name),l(0,t=y.spawn))},c=y=>{let m={...t};if(y==="up"&&(m.y-=1),y==="down"&&(m.y+=1),y==="left"&&(m.x-=1),y==="right"&&(m.x+=1),m.x<0||m.x>=L||m.y<0||m.y>=L)return;const I=K.find(i=>i.id===s);I.rocks.find(i=>i.x===m.x&&i.y===m.y)||l(0,t=m),I.exits.find(i=>i.x===t.x&&i.y===t.y)&&f()};return pe(()=>{ee.set(!0),te.set(!0),localStorage.getItem("curStageId")&&(l(1,s=parseInt(localStorage.getItem("curStageId"))),l(2,o=M.find(y=>y.id===s).name)),localStorage.getItem("playerExperience")&&(_=parseInt(localStorage.getItem("playerExperience"))),localStorage.getItem("drachmas")&&l(4,S=parseInt(localStorage.getItem("drachmas"))),localStorage.getItem("chosenRelicId")&&l(5,u=J.find(y=>y.id===parseInt(localStorage.getItem("chosenRelicId")))),typeof window<"u"&&window.addEventListener("keydown",h)}),ge(()=>{ee.set(!1),te.set(!1),typeof window<"u"&&window.removeEventListener("keydown",h)}),[t,s,o,n,S,u,a,c,()=>c("left"),()=>c("right"),()=>c("down"),()=>c("up"),()=>l(3,n=!n)]}class Ve extends he{constructor(e){super(),_e(this,e,Ae,Ee,ue,{})}}export{Ve as component};
