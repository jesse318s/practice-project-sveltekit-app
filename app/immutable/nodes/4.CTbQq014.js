import{s as ne,n as M,r as se,o as le,d as oe}from"../chunks/scheduler.DDstejZ8.js";import{S as ie,i as re,e as w,t as Z,s as S,c as x,a as P,b as $,d as C,f as T,y as V,o as b,g as H,h as y,z as L,j as ee,A as te,k as F}from"../chunks/index.5nFuNSSf.js";import{e as R}from"../chunks/each.D6YF6ztN.js";import{i as J,a as K}from"../chunks/store.DpAzdstQ.js";import{s as q}from"../chunks/stages.BYCGj-Zm.js";const h=[{id:1,rocks:[{x:1,y:1},{x:3,y:3},{x:0,y:4}],vendors:[{x:2,y:1},{x:3,y:3}],exits:[{x:0,y:0,toGrid:2,spawn:{x:4,y:4}},{x:4,y:2,toGrid:2,spawn:{x:0,y:2}},{x:2,y:4,toGrid:2,spawn:{x:2,y:0}}]},{id:2,rocks:[{x:2,y:2},{x:1,y:3},{x:4,y:1}],vendors:[{x:1,y:2}],exits:[{x:0,y:4,toGrid:1,spawn:{x:4,y:0}},{x:4,y:0,toGrid:1,spawn:{x:0,y:4}},{x:2,y:0,toGrid:1,spawn:{x:2,y:4}}]}];function Q(e,r,a){const s=e.slice();return s[21]=r[a],s[23]=a,s}function W(e,r,a){const s=e.slice();return s[21]=r[a],s[25]=a,s}function X(e){let r,a=e[0].x===e[25]&&e[0].y===e[23]?"P":h.find(e[4]).rocks.some(o)?"R":h.find(e[6]).vendors.some(d)?"V":h.find(e[8]).exits.some(v)?"E":"",s,l,f;function o(...c){return e[5](e[25],e[23],...c)}function d(...c){return e[7](e[25],e[23],...c)}function v(...c){return e[9](e[25],e[23],...c)}function E(...c){return e[11](e[25],e[23],...c)}function I(...c){return e[13](e[25],e[23],...c)}function p(...c){return e[15](e[25],e[23],...c)}return{c(){r=w("div"),s=Z(a),l=S(),this.h()},l(c){r=x(c,"DIV",{class:!0});var m=P(r);s=$(m,a),l=T(m),m.forEach(C),this.h()},h(){b(r,"class",f="cell "+(e[0].x===e[25]&&e[0].y===e[23]?"player":h.find(e[10]).rocks.some(E)?"rock":h.find(e[12]).vendors.some(I)?"vendor":h.find(e[14]).exits.some(p)?"exit":"")+" svelte-1kba5l3")},m(c,m){H(c,r,m),y(r,s),y(r,l)},p(c,m){e=c,m&3&&a!==(a=e[0].x===e[25]&&e[0].y===e[23]?"P":h.find(e[4]).rocks.some(o)?"R":h.find(e[6]).vendors.some(d)?"V":h.find(e[8]).exits.some(v)?"E":"")&&ee(s,a),m&3&&f!==(f="cell "+(e[0].x===e[25]&&e[0].y===e[23]?"player":h.find(e[10]).rocks.some(E)?"rock":h.find(e[12]).vendors.some(I)?"vendor":h.find(e[14]).exits.some(p)?"exit":"")+" svelte-1kba5l3")&&b(r,"class",f)},d(c){c&&C(r)}}}function Y(e){let r,a=R(Array(D)),s=[];for(let l=0;l<a.length;l+=1)s[l]=X(W(e,a,l));return{c(){for(let l=0;l<s.length;l+=1)s[l].c();r=F()},l(l){for(let f=0;f<s.length;f+=1)s[f].l(l);r=F()},m(l,f){for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(l,f);H(l,r,f)},p(l,f){if(f&3){a=R(Array(D));let o;for(o=0;o<a.length;o+=1){const d=W(l,a,o);s[o]?s[o].p(d,f):(s[o]=X(d),s[o].c(),s[o].m(r.parentNode,r))}for(;o<s.length;o+=1)s[o].d(1);s.length=a.length}},d(l){l&&C(r),te(s,l)}}}function ae(e){let r,a,s,l,f,o,d,v,E="Up",I,p,c="Left",m,k,z="Down",U,g,B="Right",N,O,G=R(Array(D)),_=[];for(let u=0;u<G.length;u+=1)_[u]=Y(Q(e,G,u));return{c(){r=w("div"),a=w("h2"),s=Z(e[2]),l=S(),f=w("div");for(let u=0;u<_.length;u+=1)_[u].c();o=S(),d=w("div"),v=w("button"),v.textContent=E,I=S(),p=w("button"),p.textContent=c,m=S(),k=w("button"),k.textContent=z,U=S(),g=w("button"),g.textContent=B,this.h()},l(u){r=x(u,"DIV",{class:!0});var t=P(r);a=x(t,"H2",{});var n=P(a);s=$(n,e[2]),n.forEach(C),l=T(t),f=x(t,"DIV",{class:!0});var i=P(f);for(let j=0;j<_.length;j+=1)_[j].l(i);i.forEach(C),o=T(t),d=x(t,"DIV",{class:!0});var A=P(d);v=x(A,"BUTTON",{class:!0,"data-svelte-h":!0}),V(v)!=="svelte-zcznvd"&&(v.textContent=E),I=T(A),p=x(A,"BUTTON",{class:!0,"data-svelte-h":!0}),V(p)!=="svelte-b3x30h"&&(p.textContent=c),m=T(A),k=x(A,"BUTTON",{class:!0,"data-svelte-h":!0}),V(k)!=="svelte-1x8a6xp"&&(k.textContent=z),U=T(A),g=x(A,"BUTTON",{class:!0,"data-svelte-h":!0}),V(g)!=="svelte-du436l"&&(g.textContent=B),A.forEach(C),t.forEach(C),this.h()},h(){b(f,"class","grid svelte-1kba5l3"),b(v,"class","svelte-1kba5l3"),b(p,"class","svelte-1kba5l3"),b(k,"class","svelte-1kba5l3"),b(g,"class","svelte-1kba5l3"),b(d,"class","controls svelte-1kba5l3"),b(r,"class","world svelte-1kba5l3")},m(u,t){H(u,r,t),y(r,a),y(a,s),y(r,l),y(r,f);for(let n=0;n<_.length;n+=1)_[n]&&_[n].m(f,null);y(r,o),y(r,d),y(d,v),y(d,I),y(d,p),y(d,m),y(d,k),y(d,U),y(d,g),N||(O=[L(v,"click",e[16]),L(p,"click",e[17]),L(k,"click",e[18]),L(g,"click",e[19])],N=!0)},p(u,[t]){if(t&4&&ee(s,u[2]),t&3){G=R(Array(D));let n;for(n=0;n<G.length;n+=1){const i=Q(u,G,n);_[n]?_[n].p(i,t):(_[n]=Y(i),_[n].c(),_[n].m(f,null))}for(;n<_.length;n+=1)_[n].d(1);_.length=G.length}},i:M,o:M,d(u){u&&C(r),te(_,u),N=!1,se(O)}}}const D=5;function fe(e,r,a){let s={x:2,y:2},l=1,f=q.find(t=>t.id===l).name;function o(t){let n={...s};t==="up"?n.y-=1:t==="down"?n.y+=1:t==="left"?n.x-=1:t==="right"&&(n.x+=1),!(n.x<0||n.x>=D||n.y<0||n.y>=D)&&(!h.find(i=>i.id===l).rocks.some(i=>i.x===n.x&&i.y===n.y)&&!h.find(i=>i.id===l).vendors.some(i=>i.x===n.x&&i.y===n.y)&&a(0,s=n),h.find(i=>i.id===l).exits.some(i=>i.x===s.x&&i.y===s.y)&&d())}function d(){let t=h.find(n=>n.id===l).exits.find(n=>n.x===s.x&&n.y===s.y);t&&(a(1,l=t.toGrid),localStorage.setItem("curStageId",l),a(2,f=q.find(n=>n.id===l).name),a(0,s=t.spawn))}return le(()=>{J.set(!0),K.set(!0),localStorage.getItem("curStageId")&&(a(1,l=parseInt(localStorage.getItem("curStageId"))),a(2,f=q.find(t=>t.id===l).name)),!(typeof window>"u")&&window.addEventListener("keydown",t=>{t.key==="ArrowUp"?o("up"):t.key==="ArrowDown"?o("down"):t.key==="ArrowLeft"?o("left"):t.key==="ArrowRight"&&o("right")})}),oe(()=>{J.set(!1),K.set(!1),!(typeof window>"u")&&window.removeEventListener("keydown",t=>{t.key==="ArrowUp"?o("up"):t.key==="ArrowDown"?o("down"):t.key==="ArrowLeft"?o("left"):t.key==="ArrowRight"&&o("right")})}),[s,l,f,o,t=>t.id===l,(t,n,i)=>i.x===t&&i.y===n,t=>t.id===l,(t,n,i)=>i.x===t&&i.y===n,t=>t.id===l,(t,n,i)=>i.x===t&&i.y===n,t=>t.id===l,(t,n,i)=>i.x===t&&i.y===n,t=>t.id===l,(t,n,i)=>i.x===t&&i.y===n,t=>t.id===l,(t,n,i)=>i.x===t&&i.y===n,()=>o("up"),()=>o("left"),()=>o("down"),()=>o("right")]}class ye extends ie{constructor(r){super(),re(this,r,fe,ae,ne,{})}}export{ye as component};
