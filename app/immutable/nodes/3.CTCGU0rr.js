import{t as ee,a as te,e as $,s as P}from"../chunks/B_G1IST3.js";import{i as ae}from"../chunks/MmwkNIPH.js";import{ab as ie,ad as Me,ae as se,ah as M,af as f,ag as v,at as Ue,d as e,O as Be,au as S,aq as Ge,av as Ve,aw as je,ax as qe,Y as t,e as fe}from"../chunks/BUi6LC3r.js";import{s as ve,r as ke}from"../chunks/Bej4_qsT.js";import{s as X,a as B,t as C,i as he}from"../chunks/CzMQxofJ.js";import{b as w,g as Oe}from"../chunks/CLVaJ8Lb.js";import{p as A}from"../chunks/NCp_TbZO.js";import{c as ye}from"../chunks/Jce5emvo.js";const Z=[{id:1,stageId:1,name:"Demon",img:"demon_creature.png",hp:60,attack:50,attackName:"Slash",attackType:"Normal",speed:60,defense:20,critical:25,mp:100,mpRegen:25,special:75,specialCost:100,specialName:"Harvest",specialType:"Lifesteal",specialEffect:"special-effect-1"},{id:2,stageId:1,name:"Lizard",img:"lizard_creature.png",hp:110,attack:30,attackName:"Impale",attackType:"Normal",speed:30,defense:15,critical:15,mp:100,mpRegen:25,special:75,specialCost:100,specialName:"Inject",specialType:"Poison",specialEffect:"special-effect-2"},{id:3,stageId:2,name:"Medusa",img:"medusa_creature.png",hp:110,attack:30,attackName:"Gaze",attackType:"Magic",speed:30,defense:15,critical:15,mp:100,mpRegen:25,special:75,specialCost:100,specialName:"Petrify",specialType:"Magic",specialEffect:"special-effect-3"},{id:4,stageId:2,name:"Baby Dragon",img:"small_dragon_creature.png",hp:60,attack:50,attackName:"Exhale",attackType:"Magic",speed:60,defense:20,critical:25,mp:100,mpRegen:25,special:75,specialCost:100,specialName:"Fireball",specialType:"Magic",specialEffect:"special-effect-4"},{id:5,stageId:3,name:"Skeleton",img:"skeleton_creature.png",hp:125,attack:50,attackName:"Strike",attackType:"Normal",speed:30,defense:30,critical:10,mp:100,mpRegen:25,special:75,specialCost:100,specialName:"Scorch",specialType:"Magic",specialEffect:"special-effect-4"},{id:6,stageId:3,name:"Skeleton",img:"skeleton_creature_spear.png",hp:100,attack:50,attackName:"Stab",attackType:"Normal",speed:40,defense:20,critical:50,mp:100,mpRegen:25,special:75,specialCost:100,specialName:"Ruin",specialType:"Magic",specialEffect:"special-effect-2"}],_e=[{id:1,stageId:1,name:"Demon",img:"demon_creature.png",reward:3,hp:60,attack:50,attackType:"Normal",speed:60,defense:20,critical:25},{id:2,stageId:1,name:"Lizard",img:"lizard_creature.png",reward:3,hp:110,attack:30,attackType:"Normal",speed:30,defense:15,critical:15},{id:3,stageId:2,name:"Medusa",img:"medusa_creature.png",reward:5,hp:110,attack:30,attackType:"Magic",speed:30,defense:15,critical:15},{id:4,stageId:2,name:"Baby Dragon",img:"small_dragon_creature.png",reward:5,hp:60,attack:50,attackType:"Magic",speed:60,defense:20,critical:25},{id:5,stageId:3,name:"Skeleton",img:"skeleton_creature.png",reward:12,hp:125,attack:50,attackType:"Normal",speed:30,defense:30,critical:10},{id:6,stageId:3,name:"Skeleton",img:"skeleton_creature_spear.png",reward:12,hp:100,attack:50,attackType:"Normal",speed:40,defense:20,critical:50}];var Ye=ee('<section><div class="battlefield svelte-5kiki6"><div class="creatures-container svelte-5kiki6"><div class="creature player-creature svelte-5kiki6"><img width="128px" height="128px" class="svelte-5kiki6"> <div class="shadow svelte-5kiki6"></div> <div></div></div> <div class="creature enemy-creature svelte-5kiki6"><img width="128px" height="128px" class="svelte-5kiki6"> <div class="shadow svelte-5kiki6"></div> <div class="enemy-spawn-container svelte-5kiki6"><div></div></div></div></div> <div class="floor svelte-5kiki6"></div></div></section>');function Fe(m,o){ie(o,!1);let k=A(o,"stageId",8),l=A(o,"playerState",8),u=A(o,"enemyState",8);ae();var x=Ye(),a=f(x),i=f(a),E=f(i),c=f(E),h=M(c,4);v(E);var I=M(E,2),r=f(I),d=M(r,4),y=f(d);v(d),v(I),v(i),Ue(2),v(a),v(x),Me(()=>{X(x,`battle-container ${`battle-bg-${k()}`??""} svelte-5kiki6`),B(c,"src",w+"/game/"+l().creature.img),B(c,"alt",l().creature.name),C(c,"attack",l().isAttacking),C(c,"hurt",u().isAttacking),C(c,"aura",!l().isUsingSpecial),C(c,"player-using-special",l().isUsingSpecial),X(h,ye(l().isUsingSpecial?l().creature.specialEffect:""),"svelte-5kiki6"),B(r,"src",w+"/game/"+u().creature.img),B(r,"alt",u().creature.name),C(r,"enemy-attack",u().isAttacking),C(r,"enemy-hurt",l().isAttacking),C(r,"enemy-spawning",u().isSpawning),X(y,ye(u().isSpawning?"enemy-spawn":""),"svelte-5kiki6")}),te(m,x),se()}const Je=(m,o)=>{try{const l=[{label:"Name",value:m.name},{label:"HP",value:m.hp+o.hpMod},{label:"Speed",value:m.speed+o.speedMod},{label:"Defense",value:m.defense+o.defenseMod},{label:"Critical",value:m.critical+o.criticalMod},{label:"MP",value:m.mp+o.mpMod},{label:"MP Regen",value:m.mpRegen+o.mpRegenMod},{label:`
Attack Name`,value:m.attackName},{label:"Attack",value:m.attack+o.attackMod},{label:"Attack Type",value:m.attackType},{label:`
Special Name`,value:m.specialName},{label:"Special",value:m.special+o.specialMod},{label:"Special Cost",value:m.specialCost},{label:"Special Type",value:m.specialType}].map(u=>`${u.label}: ${u.value}`).join(`
`);alert(l)}catch(k){console.error(k)}};var Ke=ee("<section><button>Attack</button> <button>Special</button> <button>Mimic Summon</button> <button>View Stats</button> <button>Travel</button></section>");function Qe(m,o){ie(o,!1);let k=A(o,"battleEnemy",8),l=A(o,"playerCreature",8),u=A(o,"swapCreature",8),x=A(o,"chosenRelic",8);ae();var a=Ke(),i=f(a),E=M(i,2),c=M(E,2),h=M(c,2),I=Be(()=>Je(l(),x())),r=M(h,2);v(a),$("click",i,()=>k()(l().attackName,l().attackType)),$("contextmenu",i,d=>{d.preventDefault(),k()(l().specialName,l().specialType)}),$("click",E,()=>k()(l().specialName,l().specialType)),$("click",c,function(...d){var y;(y=u())==null||y.apply(this,d)}),$("click",h,function(...d){var y;(y=e(I))==null||y.apply(this,d)}),$("click",r,()=>{Oe(w+"/game/world")}),te(m,a),se()}var We=ee('<main class="game-container svelte-ku2xkl"><section><h2> </h2> <div class="info svelte-ku2xkl"><div class="info-item svelte-ku2xkl"><div class="experience"> </div> <div class="drachmas"> </div></div> <div class="info-item svelte-ku2xkl"><div> </div> <div> </div> <div> </div></div> <div> </div></div></section> <!> <!></main>');function ct(m,o){ie(o,!1);let k=S(0),l=S(0),u=S(ve[0]),x=Z.filter(s=>s.stageId===e(u).id),a=S(x[0]),i=S(ke[0]),E=!1,c=S(e(a).hp+e(i).hpMod),h=S(e(a).mp+e(i).mpMod),I=_e.filter(s=>s.stageId===e(u).id),r=S(I[Math.floor(Math.random()*I.length)]),d=S(e(r).hp),y=S(""),re=0,N=S(!1),L=S(!1),G=S(!1),U=S(!1),z=null,V=null,ce=null,le=null;const be=()=>{if(e(h)!==e(a).mp+e(i).mpMod&&e(h)+e(a).mpRegen+e(i).mpRegenMod<=e(a).mp+e(i).mpMod){t(h,e(h)+e(a).mpRegen+e(i).mpRegenMod);return}t(h,e(a).mp+e(i).mpMod)},Se=(s,n)=>{if(e(c)-(e(r).attack-e(r).attack*s)*n<=0){t(y,"Defeat!"),t(c,0);return}t(c,e(c)-(e(r).attack-e(r).attack*s)*n)},j=(s,n,g)=>{try{const _=e(a).speed+e(i).speedMod;let p=(e(a).defense+e(i).defenseMod)/100,R=e(r).critical/100,T=1,b=!1;if(e(r).attackType==="Magic"&&(p=0),e(r).speed<_?b=Math.random()>=.5:b=Math.random()>=.8,re>1&&!b&&!s&&(b=!0),!b&&s&&t(y,"Enemy was too slow!"),!b&&!s){t(h,e(a).mp+e(i).mpMod),re+=1,oe(n,g);return}n===e(a).attackName&&be(),b&&s&&t(y,"Both abilities succeeded."),b&&!s&&t(y,"Your summon was too slow!"),b&&(Math.random()<=R&&(T=1.5),e(r).attackType==="Poison"&&T===1&&(T=1.5),Se(p,T),t(G,!0),ce=setTimeout(()=>t(G,!1),500))}catch(_){console.error(_)}},Ie=(s,n,g,_,p)=>{p==="Lifesteal"&&g&&(e(c)+s*n*.2>e(a).hp+e(i).hpMod?t(c,e(a).hp+e(i).hpMod):t(c,e(c)+s*n*.2)),j(g,_,p)},Te=(s,n,g,_,p)=>{s&&(e(c)+n*g>e(a).hp+e(i).hpMod?t(c,e(a).hp+e(i).hpMod):t(c,e(c)+n*g)),j(s,_,p)},we=(s,n,g,_,p,R,T)=>{if(t(h,e(h)-g),T!=="Heal"){if(e(d)-(n-n*p)*_<=0&&s){t(d,0),t(y,"Victory!"),t(k,e(k)+e(r).reward*2),t(l,e(l)+e(r).reward),t(N,!0),z=setTimeout(()=>t(N,!1),500),t(L,!0),V=setTimeout(()=>t(L,!1),500);return}s&&(t(d,e(d)-(n-n*p)*_),t(N,!0),z=setTimeout(()=>t(N,!1),500),t(L,!0),V=setTimeout(()=>t(L,!1),500)),Ie(n,_,s,R,T);return}Te(s,n,_,R,T)},ne=()=>{(e(c)<=0||e(d)<=0)&&(t(c,e(a).hp+e(i).hpMod),t(h,e(a).mp+e(i).mpMod),t(U,!0),le=setTimeout(()=>t(U,!1),500),t(r,I[Math.floor(Math.random()*I.length)]),document.documentElement.style.setProperty("--enemy-creature-img-hurt",`url(${w+"/game/"+e(r).img.slice(0,-4)+"_hurt.png"})`),document.documentElement.style.setProperty("--enemy-creature-img-attack",`url(${w+"/game/"+e(r).img.slice(0,-4)+"_attack.png"})`),t(d,e(r).hp),t(y,""))},oe=(s,n)=>{try{const g=e(a).attack+e(i).attackMod,_=e(a).speed+e(i).speedMod,p=(e(a).critical+e(i).criticalMod)/100;let R=e(a).special+e(i).specialMod,T=e(a).specialCost,b=e(r).defense/100,D=!1,H=1;if(e(U))return;if(ne(),n==="Magic"&&(b=0),_<e(r).speed?D=Math.random()>=.5:D=Math.random()>=.8,Math.random()<=p&&(H=1.5),n==="Poison"&&H===1&&(H=1.5),s===e(a).attackName){if(e(d)-(g-g*b)*H<=0&&D){t(d,0),t(y,"Victory!"),t(k,e(k)+e(r).reward*2),t(l,e(l)+e(r).reward),t(N,!0),z=setTimeout(()=>t(N,!1),500);return}D&&(t(d,e(d)-(g-g*b)*H),t(N,!0),z=setTimeout(()=>t(N,!1),500)),j(D,s,n);return}e(h)>=T?we(D,R,T,H,b,s,n):t(y,"Not enough MP!")}catch(g){console.error(g)}},xe=()=>{try{const s=e(r);t(c,0),ne(),t(a,Z.find(n=>n.id===s.id)),t(c,e(a).hp+e(i).hpMod),t(h,e(a).mp+e(i).mpMod),document.documentElement.style.setProperty("--player-creature-img-attack",`url(${w+"/game/"+e(a).img.slice(0,-4)+"_attack.png"})`),document.documentElement.style.setProperty("--player-creature-img-hurt",`url(${w+"/game/"+e(a).img.slice(0,-4)+"_hurt.png"})`)}catch(s){console.error(s)}},Ee=()=>{E&&(localStorage.setItem("drachmas",e(l)),localStorage.setItem("playerExperience",e(k)),localStorage.setItem("chosenRelicId",e(i).id))};Ge(()=>{try{const s=localStorage.getItem("drachmas"),n=localStorage.getItem("playerExperience"),g=localStorage.getItem("chosenRelicId"),_=localStorage.getItem("curStageId");he.set(!0),s&&t(l,parseInt(s)),n&&t(k,parseInt(n)),g&&t(i,ke.find(p=>p.id===parseInt(g))),_&&t(u,ve.find(p=>p.id===parseInt(_))),x=Z.filter(p=>p.stageId===e(u).id),t(a,x[0]),t(c,e(a).hp+e(i).hpMod),t(h,e(a).mp+e(i).mpMod),document.documentElement.style.setProperty("--player-creature-img-attack",`url(${w+"/game/"+e(a).img.slice(0,-4)+"_attack.png"})`),document.documentElement.style.setProperty("--player-creature-img-hurt",`url(${w+"/game/"+e(a).img.slice(0,-4)+"_hurt.png"})`),I=_e.filter(p=>p.stageId===e(u).id),t(r,I[Math.floor(Math.random()*I.length)]),t(d,e(r).hp),document.documentElement.style.setProperty("--enemy-creature-img-hurt",`url(${w+"/game/"+e(r).img.slice(0,-4)+"_hurt.png"})`),document.documentElement.style.setProperty("--enemy-creature-img-attack",`url(${w+"/game/"+e(r).img.slice(0,-4)+"_attack.png"})`),E=!0}catch(s){console.error(s)}}),Ve(()=>{he.set(!1),clearTimeout(z),clearTimeout(V),clearTimeout(ce),clearTimeout(le)}),je(()=>(e(l),e(k),e(i)),()=>{e(l),e(k),e(i),Ee()}),qe(),ae();var q=We(),O=f(q),Y=f(O),Ne=f(Y,!0);v(Y);var de=M(Y,2),F=f(de),J=f(F),Pe=f(J);v(J);var me=M(J,2),Ce=f(me);v(me),v(F);var K=M(F,2),Q=f(K),Ae=f(Q);v(Q);var W=M(Q,2),Re=f(W);v(W);var pe=M(W,2),De=f(pe);v(pe),v(K);var ue=M(K,2),He=f(ue,!0);v(ue),v(de),v(O);var ge=M(O,2);const $e=fe(()=>({creature:e(a),isAttacking:e(N),isUsingSpecial:e(L)})),Le=fe(()=>({creature:e(r),isAttacking:e(G),isSpawning:e(U)}));Fe(ge,{get stageId(){return e(u).id},get playerState(){return e($e)},get enemyState(){return e(Le)}});var ze=M(ge,2);Qe(ze,{battleEnemy:oe,get playerCreature(){return e(a)},swapCreature:xe,get chosenRelic(){return e(i)}}),v(q),Me(()=>{P(Ne,e(u).name),P(Pe,`Experience: ${e(k)??""}`),P(Ce,`Drachmas: ${e(l)??""}`),P(Ae,`Player HP: ${e(c)??""}/${e(a).hp??""}`),P(Re,`Player MP: ${e(h)??""}/${e(a).mp??""}`),P(De,`Enemy HP: ${e(d)??""}/${e(r).hp??""}`),P(He,e(y)||"The battle begins...")}),te(m,q),se()}export{ct as component};
