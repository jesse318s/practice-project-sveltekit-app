import{s as he,n as Z,d as ge,o as pe,f as ve,r as ye}from"../chunks/scheduler.BoReh3vH.js";import{S as _e,i as me,e as C,s as E,t as V,c as S,a as T,y as L,f as D,b as U,d as I,o as R,g as N,h as g,j as X,B as Y,A as j,n as F,l as Q,m as ke,k as $,u as Ie,v as be,w as we,x as xe,q as Ce}from"../chunks/index.BklZDJd0.js";import{e as M}from"../chunks/each.D6YF6ztN.js";import{s as J,r as W}from"../chunks/relics.OEzqcUPp.js";import{i as ee,a as te}from"../chunks/store.Cn0GNUQE.js";import{b as Se,g as Ge}from"../chunks/entry.D0HFvg6b.js";const z=[{id:1,stageId:1,rocks:[{x:1,y:1},{x:0,y:3}],exits:[{x:0,y:0,destGridId:2,spawn:{x:4,y:4}},{x:4,y:2,destGridId:2,spawn:{x:0,y:2}},{x:2,y:4,destGridId:2,spawn:{x:2,y:0}}]},{id:2,stageId:1,rocks:[{x:3,y:1}],exits:[{x:1,y:0,destGridId:1,spawn:{x:3,y:4}},{x:4,y:3,destGridId:3,spawn:{x:0,y:1}}]},{id:3,stageId:2,rocks:[{x:1,y:3},{x:4,y:1}],exits:[{x:0,y:4,destGridId:2,spawn:{x:4,y:0}},{x:4,y:0,destGridId:4,spawn:{x:0,y:4}},{x:2,y:0,destGridId:4,spawn:{x:2,y:4}}]},{id:4,stageId:2,rocks:[{x:0,y:2},{x:2,y:3}],exits:[{x:1,y:4,destGridId:3,spawn:{x:3,y:0}},{x:3,y:0,destGridId:3,spawn:{x:1,y:4}}]}];function le(s,e,l){const t=s.slice();return t[7]=e[l],t}function ie(s){let e;return{c(){e=V("Active")},l(l){e=U(l,"Active")},m(l,t){N(l,e,t)},d(l){l&&I(e)}}}function se(s){let e,l="Buy",t,i;function n(){return s[5](s[7])}return{c(){e=C("button"),e.textContent=l},l(a){e=S(a,"BUTTON",{"data-svelte-h":!0}),L(e)!=="svelte-yl076z"&&(e.textContent=l)},m(a,p){N(a,e,p),t||(i=j(e,"click",n),t=!0)},p(a,p){s=a},d(a){a&&I(e),t=!1,i()}}}function ne(s){let e,l,t,i,n,a=s[7].name+"",p,w,b,_,u,o=s[7].description+"",d,r,h,x,B=s[7].price+"",A,q,v,k,y=s[7].id===s[1].id&&ie(),c=s[7].id!==s[1].id&&se(s);return{c(){e=C("div"),l=C("img"),i=E(),n=C("h3"),p=V(a),w=E(),b=C("p"),y&&y.c(),_=E(),u=C("p"),d=V(o),r=E(),h=C("p"),x=V("Price: "),A=V(B),q=V(" drachmas"),v=E(),c&&c.c(),k=E(),this.h()},l(f){e=S(f,"DIV",{class:!0});var m=T(e);l=S(m,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),i=D(m),n=S(m,"H3",{});var G=T(n);p=U(G,a),G.forEach(I),w=D(m),b=S(m,"P",{class:!0});var P=T(b);y&&y.l(P),P.forEach(I),_=D(m),u=S(m,"P",{});var H=T(u);d=U(H,o),H.forEach(I),r=D(m),h=S(m,"P",{});var O=T(h);x=U(O,"Price: "),A=U(O,B),q=U(O," drachmas"),O.forEach(I),v=D(m),c&&c.l(m),k=D(m),m.forEach(I),this.h()},h(){ge(l.src,t=Se+"/game/"+s[7].img)||R(l,"src",t),R(l,"width","46px"),R(l,"height","46px"),R(l,"alt",s[7].name),R(l,"class","svelte-10kmyxf"),R(b,"class","active"),R(e,"class","menu-item svelte-10kmyxf")},m(f,m){N(f,e,m),g(e,l),g(e,i),g(e,n),g(n,p),g(e,w),g(e,b),y&&y.m(b,null),g(e,_),g(e,u),g(u,d),g(e,r),g(e,h),g(h,x),g(h,A),g(h,q),g(e,v),c&&c.m(e,null),g(e,k)},p(f,m){f[7].id===f[1].id?y||(y=ie(),y.c(),y.m(b,null)):y&&(y.d(1),y=null),f[7].id!==f[1].id?c?c.p(f,m):(c=se(f),c.c(),c.m(e,k)):c&&(c.d(1),c=null)},d(f){f&&I(e),y&&y.d(),c&&c.d()}}}function Re(s){let e,l,t="Relic Store",i,n,a,p,w,b,_=M(s[2]),u=[];for(let o=0;o<_.length;o+=1)u[o]=ne(le(s,_,o));return{c(){e=C("div"),l=C("h2"),l.textContent=t,i=E(),n=C("p"),a=V("Drachmas: "),p=V(s[0]),w=E(),b=C("div");for(let o=0;o<u.length;o+=1)u[o].c();this.h()},l(o){e=S(o,"DIV",{class:!0});var d=T(e);l=S(d,"H2",{"data-svelte-h":!0}),L(l)!=="svelte-6gh0hs"&&(l.textContent=t),i=D(d),n=S(d,"P",{});var r=T(n);a=U(r,"Drachmas: "),p=U(r,s[0]),r.forEach(I),w=D(d),b=S(d,"DIV",{});var h=T(b);for(let x=0;x<u.length;x+=1)u[x].l(h);h.forEach(I),d.forEach(I),this.h()},h(){R(e,"class","menu svelte-10kmyxf")},m(o,d){N(o,e,d),g(e,l),g(e,i),g(e,n),g(n,a),g(n,p),g(e,w),g(e,b);for(let r=0;r<u.length;r+=1)u[r]&&u[r].m(b,null)},p(o,[d]){if(d&1&&X(p,o[0]),d&14){_=M(o[2]);let r;for(r=0;r<_.length;r+=1){const h=le(o,_,r);u[r]?u[r].p(h,d):(u[r]=ne(h),u[r].c(),u[r].m(b,null))}for(;r<u.length;r+=1)u[r].d(1);u.length=_.length}},i:Z,o:Z,d(o){o&&I(e),Y(u,o)}}}function Ee(s,e,l){let{drachmas:t}=e,{chosenRelic:i}=e,{curGridId:n}=e;const a=J.find(_=>_.id===z.find(u=>u.id===n).stageId),p=W.filter(_=>_.stageId===a.id),w=_=>{try{if(t>=_.price){l(0,t-=_.price),localStorage.setItem("drachmas",t),l(1,i=_),localStorage.setItem("chosenRelicId",_.id),window.location.reload();return}alert("Not enough drachmas to spend!")}catch(u){console.error(u)}},b=_=>w(_);return s.$$set=_=>{"drachmas"in _&&l(0,t=_.drachmas),"chosenRelic"in _&&l(1,i=_.chosenRelic),"curGridId"in _&&l(4,n=_.curGridId)},[t,i,p,w,n,b]}class De extends _e{constructor(e){super(),me(this,e,Ee,Re,he,{drachmas:0,chosenRelic:1,curGridId:4})}}function re(s,e,l){const t=s.slice();return t[17]=e[l],t[19]=l,t}function ae(s,e,l){const t=s.slice();return t[17]=e[l],t[21]=l,t}function oe(s){let e,l,t,i,n,a,p,w,b="←",_,u,o,d="↑",r,h,x="↓",B,A,q="→",v,k,y=M(Array(K)),c=[];for(let f=0;f<y.length;f+=1)c[f]=de(re(s,y,f));return{c(){e=C("h2"),l=V(s[2]),t=E(),i=C("div");for(let f=0;f<c.length;f+=1)c[f].c();a=E(),p=C("div"),w=C("button"),w.textContent=b,_=E(),u=C("div"),o=C("button"),o.textContent=d,r=E(),h=C("button"),h.textContent=x,B=E(),A=C("button"),A.textContent=q,this.h()},l(f){e=S(f,"H2",{});var m=T(e);l=U(m,s[2]),m.forEach(I),t=D(f),i=S(f,"DIV",{class:!0});var G=T(i);for(let O=0;O<c.length;O+=1)c[O].l(G);G.forEach(I),a=D(f),p=S(f,"DIV",{class:!0});var P=T(p);w=S(P,"BUTTON",{"data-svelte-h":!0}),L(w)!=="svelte-1h6m8u8"&&(w.textContent=b),_=D(P),u=S(P,"DIV",{class:!0});var H=T(u);o=S(H,"BUTTON",{"data-svelte-h":!0}),L(o)!=="svelte-1un4tkd"&&(o.textContent=d),r=D(H),h=S(H,"BUTTON",{"data-svelte-h":!0}),L(h)!=="svelte-16pn8vi"&&(h.textContent=x),H.forEach(I),B=D(P),A=S(P,"BUTTON",{"data-svelte-h":!0}),L(A)!=="svelte-87vidd"&&(A.textContent=q),P.forEach(I),this.h()},h(){R(i,"class",n="grid grid-bg-"+s[1]+" svelte-lcty9u"),R(u,"class","svelte-lcty9u"),R(p,"class","button-row svelte-lcty9u")},m(f,m){N(f,e,m),g(e,l),N(f,t,m),N(f,i,m);for(let G=0;G<c.length;G+=1)c[G]&&c[G].m(i,null);N(f,a,m),N(f,p,m),g(p,w),g(p,_),g(p,u),g(u,o),g(u,r),g(u,h),g(p,B),g(p,A),v||(k=[j(w,"click",s[8]),j(o,"click",s[9]),j(h,"click",s[10]),j(A,"click",s[11])],v=!0)},p(f,m){if(m&4&&X(l,f[2]),m&67){y=M(Array(K));let G;for(G=0;G<y.length;G+=1){const P=re(f,y,G);c[G]?c[G].p(P,m):(c[G]=de(P),c[G].c(),c[G].m(i,null))}for(;G<c.length;G+=1)c[G].d(1);c.length=y.length}m&2&&n!==(n="grid grid-bg-"+f[1]+" svelte-lcty9u")&&R(i,"class",n)},d(f){f&&(I(e),I(t),I(i),I(a),I(p)),Y(c,f),v=!1,ye(k)}}}function ce(s){let e,l;return{c(){e=C("div"),this.h()},l(t){e=S(t,"DIV",{class:!0}),T(e).forEach(I),this.h()},h(){R(e,"class",l="cell "+s[6](s[21],s[19],s[0],s[1])+" svelte-lcty9u")},m(t,i){N(t,e,i)},p(t,i){i&3&&l!==(l="cell "+t[6](t[21],t[19],t[0],t[1])+" svelte-lcty9u")&&R(e,"class",l)},d(t){t&&I(e)}}}function de(s){let e,l=M(Array(K)),t=[];for(let i=0;i<l.length;i+=1)t[i]=ce(ae(s,l,i));return{c(){for(let i=0;i<t.length;i+=1)t[i].c();e=$()},l(i){for(let n=0;n<t.length;n+=1)t[n].l(i);e=$()},m(i,n){for(let a=0;a<t.length;a+=1)t[a]&&t[a].m(i,n);N(i,e,n)},p(i,n){if(n&67){l=M(Array(K));let a;for(a=0;a<l.length;a+=1){const p=ae(i,l,a);t[a]?t[a].p(p,n):(t[a]=ce(p),t[a].c(),t[a].m(e.parentNode,e))}for(;a<t.length;a+=1)t[a].d(1);t.length=l.length}},d(i){i&&I(e),Y(t,i)}}}function fe(s){let e,l="Battle",t,i;return{c(){e=C("button"),e.textContent=l},l(n){e=S(n,"BUTTON",{"data-svelte-h":!0}),L(e)!=="svelte-17w86ff"&&(e.textContent=l)},m(n,a){N(n,e,a),t||(i=j(e,"click",s[13]),t=!0)},d(n){n&&I(e),t=!1,i()}}}function ue(s){let e,l;return e=new De({props:{drachmas:s[4],chosenRelic:s[5],curGridId:s[1]}}),{c(){Ie(e.$$.fragment)},l(t){be(e.$$.fragment,t)},m(t,i){we(e,t,i),l=!0},p(t,i){const n={};i&16&&(n.drachmas=t[4]),i&32&&(n.chosenRelic=t[5]),i&2&&(n.curGridId=t[1]),e.$set(n)},i(t){l||(F(e.$$.fragment,t),l=!0)},o(t){Q(e.$$.fragment,t),l=!1},d(t){xe(e,t)}}}function Te(s){let e,l,t,i,n=s[3]?"Close Relic Store":"Relic Store",a,p,w,b,_,u,o=!s[3]&&oe(s),d=!s[3]&&fe(s),r=s[3]&&ue(s);return{c(){e=C("div"),o&&o.c(),l=E(),t=C("div"),i=C("button"),a=V(n),p=E(),d&&d.c(),w=E(),r&&r.c(),this.h()},l(h){e=S(h,"DIV",{class:!0});var x=T(e);o&&o.l(x),l=D(x),t=S(x,"DIV",{class:!0});var B=T(t);i=S(B,"BUTTON",{});var A=T(i);a=U(A,n),A.forEach(I),p=D(B),d&&d.l(B),B.forEach(I),w=D(x),r&&r.l(x),x.forEach(I),this.h()},h(){R(t,"class","button-row svelte-lcty9u"),R(e,"class","game-container svelte-lcty9u")},m(h,x){N(h,e,x),o&&o.m(e,null),g(e,l),g(e,t),g(t,i),g(i,a),g(t,p),d&&d.m(t,null),g(e,w),r&&r.m(e,null),b=!0,_||(u=j(i,"click",s[12]),_=!0)},p(h,[x]){h[3]?o&&(o.d(1),o=null):o?o.p(h,x):(o=oe(h),o.c(),o.m(e,l)),(!b||x&8)&&n!==(n=h[3]?"Close Relic Store":"Relic Store")&&X(a,n),h[3]?d&&(d.d(1),d=null):d||(d=fe(h),d.c(),d.m(t,null)),h[3]?r?(r.p(h,x),x&8&&F(r,1)):(r=ue(h),r.c(),F(r,1),r.m(e,null)):r&&(Ce(),Q(r,1,1,()=>{r=null}),ke())},i(h){b||(F(r),b=!0)},o(h){Q(r),b=!1},d(h){h&&I(e),o&&o.d(),d&&d.d(),r&&r.d(),_=!1,u()}}}const K=5;function Ae(s,e,l){let t={x:2,y:2},i=1,n=J[0].name,a=!1,p=0,w=0,b=W[0];const _=v=>{v.key==="ArrowUp"&&(v.preventDefault(),d("up")),v.key==="ArrowDown"&&(v.preventDefault(),d("down")),v.key==="ArrowLeft"&&(v.preventDefault(),d("left")),v.key==="ArrowRight"&&(v.preventDefault(),d("right"))},u=(v,k,y,c)=>{try{if(y.x===v&&y.y===k)return"player";const f=z.find(m=>m.id===c);return f.rocks.find(m=>m.x===v&&m.y===k)?"rock":f.exits.find(m=>m.x===v&&m.y===k)?"exit":""}catch(f){console.error(f)}},o=()=>{const v=z.find(y=>y.id===i).exits.find(y=>y.x===t.x&&y.y===t.y),k=J.find(y=>y.id===z.find(c=>c.id===v.destGridId).stageId);if(p<k.expReq){alert("Not enough experience to use portal! (Requires "+k.expReq+" experience)");return}v&&(l(1,i=v.destGridId),localStorage.setItem("curStageId",k.id),l(2,n=k.name),l(0,t=v.spawn))},d=v=>{try{let k={...t};if(v==="up"&&(k.y-=1),v==="down"&&(k.y+=1),v==="left"&&(k.x-=1),v==="right"&&(k.x+=1),k.x<0||k.x>=K||k.y<0||k.y>=K)return;const y=z.find(c=>c.id===i);y.rocks.find(c=>c.x===k.x&&c.y===k.y)||l(0,t=k),y.exits.find(c=>c.x===t.x&&c.y===t.y)&&o()}catch(k){console.error(k)}};return pe(()=>{if(ee.set(!0),te.set(!0),localStorage.getItem("curStageId")){const v=J.find(k=>k.id===parseInt(localStorage.getItem("curStageId")));l(1,i=parseInt(z.find(k=>k.stageId===v.id).id)),l(2,n=v.name)}localStorage.getItem("playerExperience")&&(p=parseInt(localStorage.getItem("playerExperience"))),localStorage.getItem("drachmas")&&l(4,w=parseInt(localStorage.getItem("drachmas"))),localStorage.getItem("chosenRelicId")&&l(5,b=W.find(v=>v.id===parseInt(localStorage.getItem("chosenRelicId")))),typeof window<"u"&&window.addEventListener("keydown",_)}),ve(()=>{ee.set(!1),te.set(!1),typeof window<"u"&&window.removeEventListener("keydown",_)}),[t,i,n,a,w,b,u,d,()=>d("left"),()=>d("up"),()=>d("down"),()=>d("right"),()=>l(3,a=!a),()=>Ge("/practice-project-sveltekit-app/game")]}class qe extends _e{constructor(e){super(),me(this,e,Ae,Te,he,{})}}export{qe as component};
