import{s as fe,n as X,d as _e,o as ge,f as pe}from"../chunks/scheduler.BoReh3vH.js";import{S as de,i as he,e as w,s as A,t as D,c as k,a as R,y as ue,f as C,b as P,d as v,o as b,g as N,h as g,j as K,B as F,A as me,n as z,l as O,m as ve,k as Y,u as ye,v as Ie,w as we,x as ke,q as Se}from"../chunks/index.BklZDJd0.js";import{e as q}from"../chunks/each.D6YF6ztN.js";import{r as j,s as U}from"../chunks/relics.CGlwEWe2.js";import{i as Z,a as $}from"../chunks/store.Cn0GNUQE.js";import{b as be}from"../chunks/paths.B06qZzQj.js";const M=[{id:1,rocks:[{x:1,y:1},{x:3,y:3},{x:0,y:3}],exits:[{x:0,y:0,destGridId:2,spawn:{x:4,y:4}},{x:4,y:2,destGridId:2,spawn:{x:0,y:2}},{x:2,y:4,destGridId:2,spawn:{x:2,y:0}}]},{id:2,rocks:[{x:1,y:3},{x:4,y:1}],exits:[{x:0,y:4,destGridId:1,spawn:{x:4,y:0}},{x:4,y:0,destGridId:1,spawn:{x:0,y:4}},{x:2,y:0,destGridId:1,spawn:{x:2,y:4}}]}];function ee(n,e,l){const t=n.slice();return t[6]=e[l],t}function te(n){let e;return{c(){e=D("Active")},l(l){e=P(l,"Active")},m(l,t){N(l,e,t)},d(l){l&&v(e)}}}function le(n){let e,l="Buy",t,s;function a(){return n[5](n[6])}return{c(){e=w("button"),e.textContent=l,this.h()},l(i){e=k(i,"BUTTON",{class:!0,"data-svelte-h":!0}),ue(e)!=="svelte-yl076z"&&(e.textContent=l),this.h()},h(){b(e,"class","svelte-7eusns")},m(i,o){N(i,e,o),t||(s=me(e,"click",a),t=!0)},p(i,o){n=i},d(i){i&&v(e),t=!1,s()}}}function se(n){let e,l,t,s,a,i=n[6].name+"",o,p,r,h,c,f=n[6].description+"",u,_,d,m,V=n[6].price+"",G,T,E,H,S=n[6].id===n[1].id&&te(),I=n[6].id!==n[1].id&&le(n);return{c(){e=w("div"),l=w("img"),s=A(),a=w("h3"),o=D(i),p=A(),r=w("p"),S&&S.c(),h=A(),c=w("p"),u=D(f),_=A(),d=w("p"),m=D("Price: "),G=D(V),T=D(" drachmas"),E=A(),I&&I.c(),H=A(),this.h()},l(x){e=k(x,"DIV",{class:!0});var y=R(e);l=k(y,"IMG",{src:!0,width:!0,height:!0,alt:!0,class:!0}),s=C(y),a=k(y,"H3",{});var J=R(a);o=P(J,i),J.forEach(v),p=C(y),r=k(y,"P",{class:!0});var Q=R(r);S&&S.l(Q),Q.forEach(v),h=C(y),c=k(y,"P",{});var W=R(c);u=P(W,f),W.forEach(v),_=C(y),d=k(y,"P",{});var L=R(d);m=P(L,"Price: "),G=P(L,V),T=P(L," drachmas"),L.forEach(v),E=C(y),I&&I.l(y),H=C(y),y.forEach(v),this.h()},h(){_e(l.src,t=be+"/"+n[6].img)||b(l,"src",t),b(l,"width","46px"),b(l,"height","46px"),b(l,"alt",n[6].name),b(l,"class","svelte-7eusns"),b(r,"class","active"),b(e,"class","menu-item svelte-7eusns")},m(x,y){N(x,e,y),g(e,l),g(e,s),g(e,a),g(a,o),g(e,p),g(e,r),S&&S.m(r,null),g(e,h),g(e,c),g(c,u),g(e,_),g(e,d),g(d,m),g(d,G),g(d,T),g(e,E),I&&I.m(e,null),g(e,H)},p(x,y){x[6].id===x[1].id?S||(S=te(),S.c(),S.m(r,null)):S&&(S.d(1),S=null),x[6].id!==x[1].id?I?I.p(x,y):(I=le(x),I.c(),I.m(e,H)):I&&(I.d(1),I=null)},d(x){x&&v(e),S&&S.d(),I&&I.d()}}}function Ge(n){let e,l,t="Relic Store",s,a,i,o,p,r,h=q(n[2]),c=[];for(let f=0;f<h.length;f+=1)c[f]=se(ee(n,h,f));return{c(){e=w("div"),l=w("h2"),l.textContent=t,s=A(),a=w("p"),i=D("Drachmas: "),o=D(n[0]),p=A(),r=w("div");for(let f=0;f<c.length;f+=1)c[f].c();this.h()},l(f){e=k(f,"DIV",{class:!0});var u=R(e);l=k(u,"H2",{"data-svelte-h":!0}),ue(l)!=="svelte-6gh0hs"&&(l.textContent=t),s=C(u),a=k(u,"P",{});var _=R(a);i=P(_,"Drachmas: "),o=P(_,n[0]),_.forEach(v),p=C(u),r=k(u,"DIV",{});var d=R(r);for(let m=0;m<c.length;m+=1)c[m].l(d);d.forEach(v),u.forEach(v),this.h()},h(){b(e,"class","menu svelte-7eusns")},m(f,u){N(f,e,u),g(e,l),g(e,s),g(e,a),g(a,i),g(a,o),g(e,p),g(e,r);for(let _=0;_<c.length;_+=1)c[_]&&c[_].m(r,null)},p(f,[u]){if(u&1&&K(o,f[0]),u&14){h=q(f[2]);let _;for(_=0;_<h.length;_+=1){const d=ee(f,h,_);c[_]?c[_].p(d,u):(c[_]=se(d),c[_].c(),c[_].m(r,null))}for(;_<c.length;_+=1)c[_].d(1);c.length=h.length}},i:X,o:X,d(f){f&&v(e),F(c,f)}}}function Re(n,e,l){let{drachmas:t}=e,{chosenRelic:s}=e,{curGridId:a}=e;const i=j.filter(r=>r.stageId===a),o=r=>{if(t>=r.price){l(0,t-=r.price),localStorage.setItem("drachmas",t),l(1,s=r),localStorage.setItem("chosenRelicId",r.id),window.location.reload();return}alert("Not enough drachmas to spend!")},p=r=>o(r);return n.$$set=r=>{"drachmas"in r&&l(0,t=r.drachmas),"chosenRelic"in r&&l(1,s=r.chosenRelic),"curGridId"in r&&l(4,a=r.curGridId)},[t,s,i,o,a,p]}class xe extends de{constructor(e){super(),he(this,e,Re,Ge,fe,{drachmas:0,chosenRelic:1,curGridId:4})}}function ie(n,e,l){const t=n.slice();return t[12]=e[l],t[14]=l,t}function re(n,e,l){const t=n.slice();return t[12]=e[l],t[16]=l,t}function ne(n){let e,l,t,s,a=q(Array(B)),i=[];for(let o=0;o<a.length;o+=1)i[o]=oe(ie(n,a,o));return{c(){e=w("h2"),l=D(n[2]),t=A(),s=w("div");for(let o=0;o<i.length;o+=1)i[o].c();this.h()},l(o){e=k(o,"H2",{});var p=R(e);l=P(p,n[2]),p.forEach(v),t=C(o),s=k(o,"DIV",{class:!0});var r=R(s);for(let h=0;h<i.length;h+=1)i[h].l(r);r.forEach(v),this.h()},h(){b(s,"class","grid svelte-d1xwe6")},m(o,p){N(o,e,p),g(e,l),N(o,t,p),N(o,s,p);for(let r=0;r<i.length;r+=1)i[r]&&i[r].m(s,null)},p(o,p){if(p&4&&K(l,o[2]),p&67){a=q(Array(B));let r;for(r=0;r<a.length;r+=1){const h=ie(o,a,r);i[r]?i[r].p(h,p):(i[r]=oe(h),i[r].c(),i[r].m(s,null))}for(;r<i.length;r+=1)i[r].d(1);i.length=a.length}},d(o){o&&(v(e),v(t),v(s)),F(i,o)}}}function ae(n){let e,l;return{c(){e=w("div"),this.h()},l(t){e=k(t,"DIV",{class:!0}),R(e).forEach(v),this.h()},h(){b(e,"class",l="cell "+n[6](n[16],n[14],n[0],n[1])+" svelte-d1xwe6")},m(t,s){N(t,e,s)},p(t,s){s&3&&l!==(l="cell "+t[6](t[16],t[14],t[0],t[1])+" svelte-d1xwe6")&&b(e,"class",l)},d(t){t&&v(e)}}}function oe(n){let e,l=q(Array(B)),t=[];for(let s=0;s<l.length;s+=1)t[s]=ae(re(n,l,s));return{c(){for(let s=0;s<t.length;s+=1)t[s].c();e=Y()},l(s){for(let a=0;a<t.length;a+=1)t[a].l(s);e=Y()},m(s,a){for(let i=0;i<t.length;i+=1)t[i]&&t[i].m(s,a);N(s,e,a)},p(s,a){if(a&67){l=q(Array(B));let i;for(i=0;i<l.length;i+=1){const o=re(s,l,i);t[i]?t[i].p(o,a):(t[i]=ae(o),t[i].c(),t[i].m(e.parentNode,e))}for(;i<t.length;i+=1)t[i].d(1);t.length=l.length}},d(s){s&&v(e),F(t,s)}}}function ce(n){let e,l;return e=new xe({props:{drachmas:n[4],chosenRelic:n[5],curGridId:n[1]}}),{c(){ye(e.$$.fragment)},l(t){Ie(e.$$.fragment,t)},m(t,s){we(e,t,s),l=!0},p(t,s){const a={};s&16&&(a.drachmas=t[4]),s&32&&(a.chosenRelic=t[5]),s&2&&(a.curGridId=t[1]),e.$set(a)},i(t){l||(z(e.$$.fragment,t),l=!0)},o(t){O(e.$$.fragment,t),l=!1},d(t){ke(e,t)}}}function Ee(n){let e,l,t,s=n[3]?"Close Relic Store":"Relic Store",a,i,o,p,r,h=!n[3]&&ne(n),c=n[3]&&ce(n);return{c(){e=w("div"),h&&h.c(),l=A(),t=w("button"),a=D(s),i=A(),c&&c.c(),this.h()},l(f){e=k(f,"DIV",{class:!0});var u=R(e);h&&h.l(u),l=C(u),t=k(u,"BUTTON",{class:!0});var _=R(t);a=P(_,s),_.forEach(v),i=C(u),c&&c.l(u),u.forEach(v),this.h()},h(){b(t,"class","svelte-d1xwe6"),b(e,"class","world svelte-d1xwe6")},m(f,u){N(f,e,u),h&&h.m(e,null),g(e,l),g(e,t),g(t,a),g(e,i),c&&c.m(e,null),o=!0,p||(r=me(t,"click",n[7]),p=!0)},p(f,[u]){f[3]?h&&(h.d(1),h=null):h?h.p(f,u):(h=ne(f),h.c(),h.m(e,l)),(!o||u&8)&&s!==(s=f[3]?"Close Relic Store":"Relic Store")&&K(a,s),f[3]?c?(c.p(f,u),u&8&&z(c,1)):(c=ce(f),c.c(),z(c,1),c.m(e,null)):c&&(Se(),O(c,1,1,()=>{c=null}),ve())},i(f){o||(z(c),o=!0)},o(f){O(c),o=!1},d(f){f&&v(e),h&&h.d(),c&&c.d(),p=!1,r()}}}const B=5;function Ae(n,e,l){let t={x:2,y:2},s=1,a=U.find(d=>d.id===s).name,i=!1,o=0,p=0,r=j[0];const h=d=>{d.key==="ArrowUp"&&u("up"),d.key==="ArrowDown"&&u("down"),d.key==="ArrowLeft"&&u("left"),d.key==="ArrowRight"&&u("right")},c=(d,m,V,G)=>{if(V.x===d&&V.y===m)return"player";const T=M.find(E=>E.id===G);return T.rocks.find(E=>E.x===d&&E.y===m)?"rock":T.exits.find(E=>E.x===d&&E.y===m)?"exit":""},f=()=>{const d=M.find(m=>m.id===s).exits.find(m=>m.x===t.x&&m.y===t.y);if(o<U.find(m=>m.id===d.destGridId).expReq){alert("Not enough experience to enter!");return}d&&(l(1,s=d.destGridId),localStorage.setItem("curStageId",s),l(2,a=U.find(m=>m.id===s).name),l(0,t=d.spawn))},u=d=>{let m={...t};if(d==="up"&&(m.y-=1),d==="down"&&(m.y+=1),d==="left"&&(m.x-=1),d==="right"&&(m.x+=1),m.x<0||m.x>=B||m.y<0||m.y>=B)return;const V=M.find(G=>G.id===s);V.rocks.find(G=>G.x===m.x&&G.y===m.y)||l(0,t=m),V.exits.find(G=>G.x===t.x&&G.y===t.y)&&f()};return ge(()=>{Z.set(!0),$.set(!0),localStorage.getItem("curStageId")&&(l(1,s=parseInt(localStorage.getItem("curStageId"))),l(2,a=U.find(d=>d.id===s).name)),localStorage.getItem("playerExperience")&&(o=parseInt(localStorage.getItem("playerExperience"))),localStorage.getItem("drachmas")&&l(4,p=parseInt(localStorage.getItem("drachmas"))),localStorage.getItem("chosenRelicId")&&l(5,r=j.find(d=>d.id===parseInt(localStorage.getItem("chosenRelicId")))),typeof window<"u"&&window.addEventListener("keydown",h)}),pe(()=>{Z.set(!1),$.set(!1),typeof window<"u"&&window.removeEventListener("keydown",h)}),[t,s,a,i,p,r,c,()=>l(3,i=!i)]}class qe extends de{constructor(e){super(),he(this,e,Ae,Ee,fe,{})}}export{qe as component};
